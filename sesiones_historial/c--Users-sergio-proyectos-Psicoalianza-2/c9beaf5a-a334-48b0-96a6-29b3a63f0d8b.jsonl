{"type":"file-history-snapshot","messageId":"7989fad6-3d50-42c5-8980-4e3a38f98f13","snapshot":{"messageId":"7989fad6-3d50-42c5-8980-4e3a38f98f13","trackedFileBackups":{},"timestamp":"2026-01-29T14:14:31.441Z"},"isSnapshotUpdate":false}
{"parentUuid":null,"isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","type":"user","message":{"role":"user","content":"<local-command-caveat>Caveat: The messages below were generated by the user while running local commands. DO NOT respond to these messages or otherwise consider them in your response unless the user explicitly asks you to.</local-command-caveat>"},"isMeta":true,"uuid":"af21c507-ac9f-41a5-bc4f-9dc3c8484a31","timestamp":"2026-01-29T14:14:31.441Z"}
{"parentUuid":"af21c507-ac9f-41a5-bc4f-9dc3c8484a31","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","type":"user","message":{"role":"user","content":"<command-name>/clear</command-name>\n            <command-message>clear</command-message>\n            <command-args></command-args>"},"uuid":"7989fad6-3d50-42c5-8980-4e3a38f98f13","timestamp":"2026-01-29T14:14:31.437Z"}
{"parentUuid":"7989fad6-3d50-42c5-8980-4e3a38f98f13","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","type":"user","message":{"role":"user","content":"<local-command-stdout></local-command-stdout>"},"uuid":"cc2bbef9-0108-4786-9b4b-29fb0fa753dc","timestamp":"2026-01-29T14:14:31.441Z"}
{"type":"file-history-snapshot","messageId":"d1c4ba7f-c2b1-4a58-b901-00389eec87dc","snapshot":{"messageId":"d1c4ba7f-c2b1-4a58-b901-00389eec87dc","trackedFileBackups":{},"timestamp":"2026-01-29T14:18:27.512Z"},"isSnapshotUpdate":false}
{"parentUuid":"cc2bbef9-0108-4786-9b4b-29fb0fa753dc","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":"en el cliente, se tiene una funcion para modificar un tag que dice cuantos creditos tengo disponibles. pero adicional cuando se llega al 20 debe mostrarse un modal indicando lo mismo, que ya queda menos del 20. la condicion exacta es Al momento de ingresar a la sección de “Producto selección” (ruta: /procesos)si se evidencia que los créditos alcanzan el 20%, 10%, 5% y 0% para acabarse debe aparecer este modal. el modal se ve como este figma https://www.figma.com/design/jk5t7DC8ZphIyKJyuqg8Xz/%F0%9F%9F%A9Cliente-usuario---Versi%C3%B3n-Lite?node-id=5171-28745&m=dev  "},"uuid":"d1c4ba7f-c2b1-4a58-b901-00389eec87dc","timestamp":"2026-01-29T14:18:27.511Z","thinkingMetadata":{"maxThinkingTokens":31999},"permissionMode":"plan"}
{"parentUuid":"d1c4ba7f-c2b1-4a58-b901-00389eec87dc","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_0117wZdk2iFdTuFkGmA2LoDH","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"El usuario quiere implementar una funcionalidad donde se muestre un modal de advertencia cuando los créditos disponibles de una empresa lleguen a ciertos umbrales (20%, 10%, 5% y 0%). Esto debe ocurrir al ingresar a la sección de \"Producto selección\" (ruta: /procesos).\n\nNecesito:\n1. Entender la función existente `obtenerCreditosDisponiblesEmpresa` en `globales.js`\n2. Ver el diseño en Figma para entender cómo debe verse el modal\n3. Entender cómo se maneja la ruta /procesos\n4. Planificar la implementación\n\nVoy a comenzar explorando el código existente y obteniendo información del Figma.","signature":"EoAGCkYICxgCKkASvtX0YVhCnIQ2FiqtRv/5QscYs+Qw9/3ygxf4xHFxcLF8oidWT09R2UJh8Ni60aTxBv0y/RroByIGAqI/1riDEgwnpck4vEDQyVSlq0AaDGxp4t5bN01GNvUuYSIw7YQWjOq6+Kv6KgVxW3iQjIm2ZPGTlVawKCfx+Amri25fHVpt5HS3cWjFPDIikbTrKucENspKFgDefXweyIaarzfN9WpROIX+aE+MwrzR1DIyuiespcfBOnuJvdyrOO40D7vC0JRpw+NB8sgOYpcXkUJh9gXRgWf1HTRAxzh0EYIEmyB1Y7yr40rpDE0WwZiMU29fbHxFy4yOGtLVEEaniuQAiex4ugjYBOFyN2vYiPDYPdLyqDAp1X7y5EBfHo3JyL+nFnaU5buJ41L1/wTtZ3wR/9Ib21pyYlv9id+kM2TNsVwow7smFHudmNdN8TDT++Q6YGj8i8KTtozaU4m1xJjSxukj3mt9SuUFLHldbHp530+k2/HSj9FZJ7cod4+c5iMwBIDfDKGUFXObXvJ4AtRE9iHqA6kAOpmPQ55MqDTbomvVSWVh+nc91KoWZ0ese3ptvXSFrH12l4VICafTZ3lsJsNxxohSRXNf4IXcI4BLrpNEJ2ybf8x5l+UdN9LRa65FQN4bgsHBL1PTG0ao0WS5WZlkVRquVn4eKVAW4Dc/cqRwSWCON0PRGWXJj09cYfQicf+WNC7WPSJB3dGnahmC9c5OlAnB+rGFN7ndrAaqv2OjJyggyU87UooKkcNtEMW+debYUaGWAHVw/wDDMT1WpgPya/RmHdRy1SEe4pvnvYus7k7oGO8KXYQXvuF+MFn53/xCFLvp/JinkmWd5hcYmPrDwlJlE3p0N4a7xmzHffa+GRPREKFchk7XM6kH5L2oowph362S83LCWUadaR3NsNvW+oLxvoHGaGxIZTMq12A2Sap+Og8USdatZnsvZ70YpGspk16b7i9GDLFf5MMSyvv9n8kp9hpnLLVmyTtktt1cWQjFdKMhGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":8883,"cache_read_input_tokens":17022,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":8883},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpAbugBABsKWLWbmJqn","type":"assistant","uuid":"cfbfd9a8-77d1-4c5c-b23b-b0418f4fc30f","timestamp":"2026-01-29T14:18:33.981Z"}
{"parentUuid":"cfbfd9a8-77d1-4c5c-b23b-b0418f4fc30f","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_0117wZdk2iFdTuFkGmA2LoDH","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a explorar el código existente y obtener información del diseño en Figma para planificar esta implementación."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":8883,"cache_read_input_tokens":17022,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":8883},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpAbugBABsKWLWbmJqn","type":"assistant","uuid":"d4faf1df-5fbf-42db-be94-508dd0fd9382","timestamp":"2026-01-29T14:18:34.395Z"}
{"parentUuid":"d4faf1df-5fbf-42db-be94-508dd0fd9382","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_0117wZdk2iFdTuFkGmA2LoDH","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_014o7b6XYHSGXxTiv6Z5JhZg","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","offset":1400,"limit":100}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":8883,"cache_read_input_tokens":17022,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":8883},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpAbugBABsKWLWbmJqn","type":"assistant","uuid":"407d46ed-59b6-44dc-ba0a-168b896b4816","timestamp":"2026-01-29T14:18:35.979Z"}
{"parentUuid":"407d46ed-59b6-44dc-ba0a-168b896b4816","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_0117wZdk2iFdTuFkGmA2LoDH","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01NunUYAWk5gtkjWnbqzkeeA","name":"WebFetch","input":{"url":"https://www.figma.com/design/jk5t7DC8ZphIyKJyuqg8Xz/%F0%9F%9F%A9Cliente-usuario---Versi%C3%B3n-Lite?node-id=5171-28745&m=dev","prompt":"Describe el diseño del modal de advertencia de créditos. Incluye: colores, textos, iconos, botones, estructura visual y cualquier detalle relevante para implementarlo."}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":8883,"cache_read_input_tokens":17022,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":8883},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpAbugBABsKWLWbmJqn","type":"assistant","uuid":"cc1948c6-9e10-4ca8-92c7-925021dca3bb","timestamp":"2026-01-29T14:18:37.831Z"}
{"parentUuid":"cc1948c6-9e10-4ca8-92c7-925021dca3bb","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_0117wZdk2iFdTuFkGmA2LoDH","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01VYcu4mvLji6ARmPLZhAv8k","name":"Grep","input":{"pattern":"procesos","path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes","output_mode":"content","-n":true}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":8883,"cache_read_input_tokens":17022,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":8883},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpAbugBABsKWLWbmJqn","type":"assistant","uuid":"70bd5edd-c1ee-4759-8261-3b387b70ce4f","timestamp":"2026-01-29T14:18:38.855Z"}
{"parentUuid":"407d46ed-59b6-44dc-ba0a-168b896b4816","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_014o7b6XYHSGXxTiv6Z5JhZg","type":"tool_result","content":"  1400→        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n  1401→    });\n  1402→\n  1403→    return experiencias_ordenadas;\n  1404→}\n  1405→\n  1406→/**\n  1407→ * Obtener créditos disponibles de la empresa y actualizar el tag.\n  1408→ * - Si tiene créditos >= 20% del plan: tag azul\n  1409→ * - Si tiene créditos < 20% del plan: tag amarillo\n  1410→ * - Si no tiene créditos: tag gris \"Sin créditos\"\n  1411→ *\n  1412→ * @param {number} empresa_id ID de la empresa\n  1413→ * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n  1414→ * @returns {void}\n  1415→ * @author Andres Gonzalez\n  1416→ * @author Daniel Beltrán\n  1417→ */\n  1418→function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n  1419→    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n  1420→        return;\n  1421→    }\n  1422→\n  1423→    $.ajax({\n  1424→        url: `/empresas/${empresa_id}/creditos`,\n  1425→        method: 'GET',\n  1426→        dataType: 'json',\n  1427→        success: function (respuesta) {\n  1428→            if (respuesta?.data) {\n  1429→                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1430→                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1431→                let plan_credito = respuesta?.data?.plan_credito;\n  1432→                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1433→\n  1434→                let texto_tag = '';\n  1435→                let clase_tag = '';\n  1436→                let icono_final = '';\n  1437→\n  1438→                if (creditos_disponibles <= 0 || plan_credito === null) {\n  1439→                    texto_tag = 'Sin créditos';\n  1440→                    clase_tag = 'tag-tonal-gray';\n  1441→                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1442→                } else if (porcentaje_disponible < 20) {\n  1443→                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1444→                    clase_tag = 'tag-filled-yellow';\n  1445→                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1446→                } else {\n  1447→                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1448→                    clase_tag = 'tag-tonal-blue';\n  1449→                }\n  1450→\n  1451→                $(`#${contenedor_id}`).html(crearTag({\n  1452→                    texto: texto_tag,\n  1453→                    class: clase_tag,\n  1454→                    icono_final: icono_final,\n  1455→                }));\n  1456→            } else {\n  1457→                $(`#${contenedor_id}`).html(crearTag({\n  1458→                    texto: 'No tienes plan de créditos',\n  1459→                    class: 'tag-tonal-gray'\n  1460→                }));\n  1461→            }\n  1462→\n  1463→            inicializarTooltips();\n  1464→        },\n  1465→        error: function () {\n  1466→            $(`#${contenedor_id}`).html(crearTag({\n  1467→                texto: 'Error al cargar créditos',\n  1468→                class: 'tag-tonal-gray'\n  1469→            }));\n  1470→        }\n  1471→    });\n  1472→}\n  1473→\n  1474→/**\n  1475→ * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n  1476→ *\n  1477→ * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n  1478→ * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n  1479→ * @author Andres Gonzalez\n  1480→ */\n  1481→function obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n  1482→    let parametros = {};\n  1483→\n  1484→    if (tipo_prueba_id !== null) {\n  1485→        parametros.tipo_prueba_id = tipo_prueba_id;\n  1486→    }\n  1487→\n  1488→    return $.ajax({\n  1489→        url: '/funcionalidades-activas-plan',\n  1490→        method: 'GET',\n  1491→        dataType: 'json',\n  1492→        data: parametros,\n  1493→        success: function(respuesta) {\n  1494→            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n  1495→        }\n  1496→    });\n  1497→}\n  1498→\n  1499→/**\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"becdcd52-d77d-4bae-880a-62157bee081a","timestamp":"2026-01-29T14:18:40.706Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","content":"        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**","numLines":100,"startLine":1400,"totalLines":1554}},"sourceToolAssistantUUID":"407d46ed-59b6-44dc-ba0a-168b896b4816"}
{"parentUuid":"becdcd52-d77d-4bae-880a-62157bee081a","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_014o7b6XYHSGXxTiv6Z5JhZg","toolUseID":"toolu_014o7b6XYHSGXxTiv6Z5JhZg","timestamp":"2026-01-29T14:18:40.709Z","uuid":"68938a4b-25b1-4569-930a-ab32e836716a"}
{"parentUuid":"70bd5edd-c1ee-4759-8261-3b387b70ce4f","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01VYcu4mvLji6ARmPLZhAv8k","type":"tool_result","content":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:616:        $ruta->resource('procesos', 'Procesos\\ProcesoController');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:617:        $ruta->get('procesos-listado', 'Procesos\\ProcesoController@listado');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:618:        $ruta->get('procesos-listado-tabla', 'Procesos\\ProcesoController@datosTabla');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:619:        $ruta->patch('procesos-actualizar/{id}', 'Procesos\\ProcesoController@actualizarInformacion');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:620:        $ruta->post('procesos-duplicar/{id}', 'Procesos\\ProcesoController@duplicar');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:621:        $ruta->post('procesos-suspender/{id}', 'Procesos\\ProcesoController@suspender');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:622:        $ruta->post('procesos-activar/{id}', 'Procesos\\ProcesoController@activar');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:623:        $ruta->put('procesos-archivar', 'Procesos\\ProcesoController@archivarProceso');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:624:        $ruta->post('procesos-exportar', 'Procesos\\ProcesoController@exportarExcel');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:625:        $ruta->post('procesos-compartir/{id}', 'Procesos\\ProcesoController@compartir');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:626:        $ruta->post('procesos-compartir-resultados-aplicante', 'Procesos\\ProcesoController@compartirResultadosAplicante');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:628:        $ruta->post('procesos-exportar-participantes', 'Usuarios\\UserController@exportarParticipantesProcesoExcel');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:633:        $ruta->post('procesos-participantes/{id}', 'Procesos\\ProcesoController@agregarParticipantes');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:636:        $ruta->get('procesos-detalles-participante', 'Usuarios\\UserController@detallesParticipanteProceso');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:640:        $ruta->post('procesos-reporte-resultados-excel', 'Procesos\\ProcesoController@exportarReporteResultadosExcel');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:641:        $ruta->get('procesos-indice-talento/{proceso_id}/{aplicante_id}', 'Procesos\\ProcesoController@obtenerIndiceTalento');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:643:        $ruta->post('procesos-mejores-candidatos', 'Procesos\\ProcesoController@mejoresCandidatosIA');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:644:        $ruta->post('procesos-validar-agendas-expiradas/{id}', 'Procesos\\ProcesoController@validarAgendasExpiradas');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:646:        $ruta->get('procesos-descargar-guia-agendamiento-masivo', 'Procesos\\ProcesoController@descargarGuiaAgendamientoMasivo');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:647:        $ruta->post('procesos-extraer-datos-participantes', 'Procesos\\ProcesoController@extraerDatosParticipantes');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:920:    $ruta->get('procesos/{id}', 'Procesos\\ProcesoController@showFirmada');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:921:    $ruta->get('procesos-resultados-aplicante/{proceso_id}/{participante_id}', 'Procesos\\ProcesoController@showResultadosAplicanteFirmada');"}]},"uuid":"cbe39e0c-2cd0-43f7-8536-d78b2ad9b14b","timestamp":"2026-01-29T14:18:42.441Z","toolUseResult":{"mode":"content","numFiles":0,"filenames":[],"content":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:616:        $ruta->resource('procesos', 'Procesos\\ProcesoController');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:617:        $ruta->get('procesos-listado', 'Procesos\\ProcesoController@listado');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:618:        $ruta->get('procesos-listado-tabla', 'Procesos\\ProcesoController@datosTabla');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:619:        $ruta->patch('procesos-actualizar/{id}', 'Procesos\\ProcesoController@actualizarInformacion');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:620:        $ruta->post('procesos-duplicar/{id}', 'Procesos\\ProcesoController@duplicar');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:621:        $ruta->post('procesos-suspender/{id}', 'Procesos\\ProcesoController@suspender');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:622:        $ruta->post('procesos-activar/{id}', 'Procesos\\ProcesoController@activar');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:623:        $ruta->put('procesos-archivar', 'Procesos\\ProcesoController@archivarProceso');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:624:        $ruta->post('procesos-exportar', 'Procesos\\ProcesoController@exportarExcel');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:625:        $ruta->post('procesos-compartir/{id}', 'Procesos\\ProcesoController@compartir');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:626:        $ruta->post('procesos-compartir-resultados-aplicante', 'Procesos\\ProcesoController@compartirResultadosAplicante');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:628:        $ruta->post('procesos-exportar-participantes', 'Usuarios\\UserController@exportarParticipantesProcesoExcel');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:633:        $ruta->post('procesos-participantes/{id}', 'Procesos\\ProcesoController@agregarParticipantes');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:636:        $ruta->get('procesos-detalles-participante', 'Usuarios\\UserController@detallesParticipanteProceso');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:640:        $ruta->post('procesos-reporte-resultados-excel', 'Procesos\\ProcesoController@exportarReporteResultadosExcel');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:641:        $ruta->get('procesos-indice-talento/{proceso_id}/{aplicante_id}', 'Procesos\\ProcesoController@obtenerIndiceTalento');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:643:        $ruta->post('procesos-mejores-candidatos', 'Procesos\\ProcesoController@mejoresCandidatosIA');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:644:        $ruta->post('procesos-validar-agendas-expiradas/{id}', 'Procesos\\ProcesoController@validarAgendasExpiradas');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:646:        $ruta->get('procesos-descargar-guia-agendamiento-masivo', 'Procesos\\ProcesoController@descargarGuiaAgendamientoMasivo');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:647:        $ruta->post('procesos-extraer-datos-participantes', 'Procesos\\ProcesoController@extraerDatosParticipantes');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:920:    $ruta->get('procesos/{id}', 'Procesos\\ProcesoController@showFirmada');\nC:\\Users\\sergio\\proyectos\\Psicoalianza-2\\routes\\web.php:921:    $ruta->get('procesos-resultados-aplicante/{proceso_id}/{participante_id}', 'Procesos\\ProcesoController@showResultadosAplicanteFirmada');","numLines":22},"sourceToolAssistantUUID":"70bd5edd-c1ee-4759-8261-3b387b70ce4f"}
{"parentUuid":"cbe39e0c-2cd0-43f7-8536-d78b2ad9b14b","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Grep","command":"callback"},"parentToolUseID":"toolu_01VYcu4mvLji6ARmPLZhAv8k","toolUseID":"toolu_01VYcu4mvLji6ARmPLZhAv8k","timestamp":"2026-01-29T14:18:42.442Z","uuid":"0ad63bd6-0f5c-43fe-a159-29128462a2b1"}
{"parentUuid":"cc1948c6-9e10-4ca8-92c7-925021dca3bb","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"Request failed with status code 403","is_error":true,"tool_use_id":"toolu_01NunUYAWk5gtkjWnbqzkeeA"}]},"uuid":"0ded52ee-2a16-4924-b98f-1aca53c46b0a","timestamp":"2026-01-29T14:21:33.444Z","toolUseResult":"Error: Request failed with status code 403","sourceToolAssistantUUID":"cc1948c6-9e10-4ca8-92c7-925021dca3bb"}
{"parentUuid":"0ded52ee-2a16-4924-b98f-1aca53c46b0a","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01JdemJX2cDivBxr5mVhRkH1","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Necesito más información:\n1. La función `obtenerCreditosDisponiblesEmpresa` ya existe y maneja la lógica de mostrar el tag con los créditos\n2. Necesito ver la vista de procesos para entender dónde se llama esta función\n3. No pude acceder al Figma (403), necesito preguntarle al usuario por los detalles del diseño\n4. Necesito ver si ya existe algún modal similar en el proyecto\n\nVoy a explorar más el código para entender:\n- La vista de procesos\n- Si ya existen modales similares\n- Cómo se manejan los modales en el proyecto","signature":"ErwFCkYICxgCKkCjn3XJsagDcoQB91uVNA8elDRpWgcn1x04lUHr1lE0GRnDX4/6zgqRO+xb0CaL0YSDtCSKbJxczvhC4uJOf22nEgzgokFURucZTY0wTqsaDFhgt97tFS1MicDV/iIwphfaz+/R5fudKCejj/1iDEcYcJSFexWAlBvpTkicFT8RrfZJFzqnMHv0nfzj8lu6KqMEPNVtVhcf7ylBTy5ijctO0n3qNBAY7+WVn2ng8CwPuej9Jr79nqkMa7cOT/hEIzE368XDAKvAb9YYmPAR3eDNE5LrRce5cI4eFk79uDt5Q+T3xP5IJJNs0aLhB9Ik3GTozxwAP8vp+ABiR6R53LsRrGet36zHfn6uRMQt89XMl0mFqJY6Flu/EObu5MSuS+/eEIq9sx5OJjc4k0XypqeugQBmGD28u+izZvwdGcjaprgoFrMeLGLzKwf/5dCB7DrF2SEHcYGtUZhnEKHSO5oHu8wZFG56h+9O9oX8ZwNR2M49VKsIe2dLs6mto/RbaIuqsBc8xqFszOiw5qIn4U+iHex70MDimX6dCZn/YLwXCbIJ6qkuL4irTo4gOkEpbla6LUQ0swbaVm3I7WLvL+aQKLMLJJ1nIF+xXqAhFmVNZFM4Xhv4ncm77wBYh70URX3vCk3F9N1vvefeUTQrPT1FeFeeW+LJNqVhvcN5l6wQpT2Rjng1FRgtXufD2APvnIhAS6a/CerO2OXeFDiWcUacWatmVBYEEwxQKt3lrgHSM+wMH0N7DpJpKx7X4weBGL0ODKmlF+SWEBFMhfDfXp+J/5eo+jHx9orBALnrkAYP8aiFdOIwFUjhUPZAq2BVWT6RVQlfvE6eq/oceoqM0MHkeFcsUlE12gU2WHzC3Uvubamcy0bAfYZR1kpNV6rb2IfXDjBla4E/lDBuXKtuNYiVU4jmSBgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1422,"cache_creation_input_tokens":2392,"cache_read_input_tokens":25905,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2392},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpQJpAVsbafH69baSDB","type":"assistant","uuid":"1ab1c8b8-b43e-4cbc-b5c3-7065dd53ca29","timestamp":"2026-01-29T14:21:38.889Z"}
{"parentUuid":"1ab1c8b8-b43e-4cbc-b5c3-7065dd53ca29","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01JdemJX2cDivBxr5mVhRkH1","type":"message","role":"assistant","content":[{"type":"text","text":"No pude acceder al Figma (error 403). Necesito explorar más el código existente y obtener detalles del diseño del modal."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1422,"cache_creation_input_tokens":2392,"cache_read_input_tokens":25905,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2392},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpQJpAVsbafH69baSDB","type":"assistant","uuid":"a54c1b12-6f1f-474b-89ab-d144c72fb2c4","timestamp":"2026-01-29T14:21:39.784Z"}
{"parentUuid":"a54c1b12-6f1f-474b-89ab-d144c72fb2c4","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01JdemJX2cDivBxr5mVhRkH1","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01PAte7Xw6c3GVMiabJ3kUdd","name":"Task","input":{"description":"Explorar vistas y modales procesos","prompt":"Necesito explorar el código relacionado con la sección de procesos y modales existentes en el proyecto. Busca:\n\n1. La vista principal de procesos (index) - busca en resources/views relacionado con procesos\n2. Modales existentes en el proyecto que sirvan de referencia - especialmente modales de advertencia o alerta\n3. Cómo se implementan modales en este proyecto (sistema de componentes)\n4. Si existe algún modal relacionado con créditos o similar\n\nProporciona los archivos relevantes encontrados con sus rutas completas.","subagent_type":"Explore"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":1422,"cache_creation_input_tokens":2392,"cache_read_input_tokens":25905,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2392},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpQJpAVsbafH69baSDB","type":"assistant","uuid":"9b7cb893-00be-4d1a-a524-8751c3a7fd94","timestamp":"2026-01-29T14:21:43.814Z"}
{"parentUuid":"9b7cb893-00be-4d1a-a524-8751c3a7fd94","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"message":{"type":"user","message":{"role":"user","content":[{"type":"text","text":"Necesito explorar el código relacionado con la sección de procesos y modales existentes en el proyecto. Busca:\n\n1. La vista principal de procesos (index) - busca en resources/views relacionado con procesos\n2. Modales existentes en el proyecto que sirvan de referencia - especialmente modales de advertencia o alerta\n3. Cómo se implementan modales en este proyecto (sistema de componentes)\n4. Si existe algún modal relacionado con créditos o similar\n\nProporciona los archivos relevantes encontrados con sus rutas completas."}]},"uuid":"e45a042b-6dd3-4300-9c54-44a8f289141d","timestamp":"2026-01-29T14:21:43.893Z"},"normalizedMessages":[],"type":"agent_progress","prompt":"Necesito explorar el código relacionado con la sección de procesos y modales existentes en el proyecto. Busca:\n\n1. La vista principal de procesos (index) - busca en resources/views relacionado con procesos\n2. Modales existentes en el proyecto que sirvan de referencia - especialmente modales de advertencia o alerta\n3. Cómo se implementan modales en este proyecto (sistema de componentes)\n4. Si existe algún modal relacionado con créditos o similar\n\nProporciona los archivos relevantes encontrados con sus rutas completas.","agentId":"a04b5c4"},"toolUseID":"agent_msg_01JdemJX2cDivBxr5mVhRkH1","parentToolUseID":"toolu_01PAte7Xw6c3GVMiabJ3kUdd","uuid":"5ad43298-97a2-43c8-86ec-bfdf3ce012e0","timestamp":"2026-01-29T14:21:43.895Z"}
{"parentUuid":"9b7cb893-00be-4d1a-a524-8751c3a7fd94","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"type":"tool_result","content":"[Request interrupted by user for tool use]","is_error":true,"tool_use_id":"toolu_01PAte7Xw6c3GVMiabJ3kUdd"}]},"uuid":"3f4672d8-526c-40fe-8809-15db3702ae30","timestamp":"2026-01-29T14:21:46.582Z","toolUseResult":"Error: [Request interrupted by user for tool use]","sourceToolAssistantUUID":"9b7cb893-00be-4d1a-a524-8751c3a7fd94"}
{"parentUuid":"3f4672d8-526c-40fe-8809-15db3702ae30","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"type":"text","text":"[Request interrupted by user for tool use]"}]},"uuid":"65c65d98-0ae5-4ea1-801c-6e4cabe25cbf","timestamp":"2026-01-29T14:21:46.582Z"}
{"type":"summary","summary":"Implement credit warning modal on product selection","leafUuid":"65c65d98-0ae5-4ea1-801c-6e4cabe25cbf"}
{"parentUuid":"65c65d98-0ae5-4ea1-801c-6e4cabe25cbf","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"assistant","uuid":"53c144c8-802d-48e8-b450-ef61dfd77b1a","timestamp":"2026-01-29T14:24:06.027Z","message":{"id":"8f481ccf-abeb-4db9-9961-56bb2ea3e167","container":null,"model":"<synthetic>","role":"assistant","stop_reason":"stop_sequence","stop_sequence":"","type":"message","usage":{"input_tokens":0,"output_tokens":0,"cache_creation_input_tokens":0,"cache_read_input_tokens":0,"server_tool_use":{"web_search_requests":0,"web_fetch_requests":0},"service_tier":null,"cache_creation":{"ephemeral_1h_input_tokens":0,"ephemeral_5m_input_tokens":0}},"content":[{"type":"text","text":"No response requested."}],"context_management":null},"isApiErrorMessage":false}
{"type":"file-history-snapshot","messageId":"68f30d83-8a1a-4144-aa3d-97912336f558","snapshot":{"messageId":"68f30d83-8a1a-4144-aa3d-97912336f558","trackedFileBackups":{},"timestamp":"2026-01-29T14:24:19.250Z"},"isSnapshotUpdate":false}
{"parentUuid":"53c144c8-802d-48e8-b450-ef61dfd77b1a","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":"continua, ya arregle el mcp de figma https://www.figma.com/design/jk5t7DC8ZphIyKJyuqg8Xz/%F0%9F%9F%A9Cliente-usuario---Versi%C3%B3n-Lite?node-id=5171-28745&m=dev"},"uuid":"68f30d83-8a1a-4144-aa3d-97912336f558","timestamp":"2026-01-29T14:24:19.248Z","thinkingMetadata":{"maxThinkingTokens":31999},"permissionMode":"default"}
{"parentUuid":"68f30d83-8a1a-4144-aa3d-97912336f558","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012uxAVyzJ2sYDp5KQgR597Q","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"El usuario arregló el MCP de Figma, así que puedo usar las herramientas de Figma para obtener el diseño del modal. Voy a usar la herramienta get_design_context para obtener los detalles del diseño.\n\nLa URL es: https://www.figma.com/design/jk5t7DC8ZphIyKJyuqg8Xz/%F0%9F%9F%A9Cliente-usuario---Versi%C3%B3n-Lite?node-id=5171-28745&m=dev\n\nDel URL extraigo:\n- fileKey: jk5t7DC8ZphIyKJyuqg8Xz\n- nodeId: 5171-28745 (o 5171:28745)","signature":"EtIECkYICxgCKkDI/ZXFJE1fBo/GOsOq2q8sJn858e/5U7243wJwXK/k5UjqKRuiYzXq5c5g+MBdJuhhSmoESKr7m3cbHJ5iVKcwEgwv71WEe1uQVBq9R3caDCey+wlvUjTFc8o3MCIwKBVPLXWE90cH8pTx7tMj4wL49BqiUQPHNjjveqnP7d0TQL9soUY1pks6kpoCQEVoKrkDQ4bGQQiMDxxijUoO9RwyLHhCv7DGTMhJ5E0ZxqjloD2jgRL+kpa/ZtfmVetTvOioOkSbGASaK73EAgFyx8LknJVpoI9s+BeDrJ8A1hggg87MWqgasMf33Oa1UXQRa7Nnp2K4Dkb6+dd/1S1TNrJYeXQWje5eiww8IuJUN7uowz4ABg93eKgD2T9vxW5MkTxwiDjeQ3ApG9G5RZ+NlyHb3ewCoFe4p/oFa5lqR8r91ImH0RK5a8VUm1wVJtgrReI0TkvKNe3iQUhEKDPMbRG8752l65TpsudPoaB4H2l5GTPubRw3MrgQWbXKYqJ5zo4ukGS3PLMUMPJw1IFQhw5JkcyeKle9AI0LSHroRXHb2hwsh3D/CNsGDB9BdmMuhfMQD1+y09KoAJarzcogmPz1qZQGS+t1okij3zU+YkRSUr157/WluwLqnTr4EB1WaQ1bkjdH1bPJl5cLLkBu8igHEF58xcjGgfGWOnF3W6vZuupIMCJa0ISfZzAbzxtN5byQ7uKmJLMpdVi7flDeX6AW4woiGq7DS/ULZ7p6bNHhnsATxlabLowmnYyocGwKBXZXEbMIJKZaJ+YCGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":19688,"cache_read_input_tokens":11724,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":19688},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpcYKrF9TrYfHAFhaKd","type":"assistant","uuid":"38691da0-1b24-4956-97ed-62ba0d0cd579","timestamp":"2026-01-29T14:24:24.215Z"}
{"parentUuid":"38691da0-1b24-4956-97ed-62ba0d0cd579","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012uxAVyzJ2sYDp5KQgR597Q","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a obtener el diseño del modal desde Figma."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":19688,"cache_read_input_tokens":11724,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":19688},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpcYKrF9TrYfHAFhaKd","type":"assistant","uuid":"aa90d88a-e2e8-4755-b1d0-a94f16b2082c","timestamp":"2026-01-29T14:24:24.727Z"}
{"parentUuid":"aa90d88a-e2e8-4755-b1d0-a94f16b2082c","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012uxAVyzJ2sYDp5KQgR597Q","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01AUtgXXHFqfte1injNEEBCP","name":"mcp__figma__get_design_context","input":{"nodeId":"5171:28745","fileKey":"jk5t7DC8ZphIyKJyuqg8Xz","clientLanguages":"javascript,html,css,php","clientFrameworks":"laravel,bootstrap,jquery"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":19688,"cache_read_input_tokens":11724,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":19688},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpcYKrF9TrYfHAFhaKd","type":"assistant","uuid":"7de98705-02a2-4407-a9f3-4b2feeb3c8c5","timestamp":"2026-01-29T14:24:26.157Z"}
{"parentUuid":"7de98705-02a2-4407-a9f3-4b2feeb3c8c5","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012uxAVyzJ2sYDp5KQgR597Q","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018GLDAJTqKorXMC9D7zCdff","name":"mcp__figma__get_screenshot","input":{"nodeId":"5171:28745","fileKey":"jk5t7DC8ZphIyKJyuqg8Xz","clientLanguages":"javascript,html,css,php","clientFrameworks":"laravel,bootstrap,jquery"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":10,"cache_creation_input_tokens":19688,"cache_read_input_tokens":11724,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":19688},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpcYKrF9TrYfHAFhaKd","type":"assistant","uuid":"7fc72e9f-6b28-4395-89e2-3d0140351106","timestamp":"2026-01-29T14:24:27.001Z"}
{"parentUuid":"7fc72e9f-6b28-4395-89e2-3d0140351106","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"figma","toolName":"get_design_context"},"toolUseID":"toolu_01AUtgXXHFqfte1injNEEBCP","parentToolUseID":"toolu_01AUtgXXHFqfte1injNEEBCP","uuid":"274bcfb8-3437-4771-8cf1-cca82e755b3d","timestamp":"2026-01-29T14:25:21.172Z"}
{"parentUuid":"274bcfb8-3437-4771-8cf1-cca82e755b3d","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"mcp_progress","status":"started","serverName":"figma","toolName":"get_screenshot"},"toolUseID":"toolu_018GLDAJTqKorXMC9D7zCdff","parentToolUseID":"toolu_018GLDAJTqKorXMC9D7zCdff","uuid":"a41c9b11-ad42-4c67-b5c2-265fe3257ce9","timestamp":"2026-01-29T14:25:23.104Z"}
{"parentUuid":"a41c9b11-ad42-4c67-b5c2-265fe3257ce9","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"figma","toolName":"get_screenshot","elapsedTimeMs":3784},"toolUseID":"toolu_018GLDAJTqKorXMC9D7zCdff","parentToolUseID":"toolu_018GLDAJTqKorXMC9D7zCdff","uuid":"d6840762-a385-4898-ad54-3c404a7116ca","timestamp":"2026-01-29T14:25:26.888Z"}
{"parentUuid":"7fc72e9f-6b28-4395-89e2-3d0140351106","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018GLDAJTqKorXMC9D7zCdff","type":"tool_result","content":[{"type":"image","source":{"data":"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","media_type":"image/png","type":"base64"}}]}]},"uuid":"ed662c5c-1d26-4eb5-8d5e-5b32deae2ab1","timestamp":"2026-01-29T14:25:26.892Z","toolUseResult":[{"type":"image","source":{"data":"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","media_type":"image/png","type":"base64"}}],"sourceToolAssistantUUID":"7fc72e9f-6b28-4395-89e2-3d0140351106"}
{"parentUuid":"ed662c5c-1d26-4eb5-8d5e-5b32deae2ab1","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"mcp_progress","status":"completed","serverName":"figma","toolName":"get_design_context","elapsedTimeMs":5742},"toolUseID":"toolu_01AUtgXXHFqfte1injNEEBCP","parentToolUseID":"toolu_01AUtgXXHFqfte1injNEEBCP","uuid":"4c21e8aa-d922-42c5-b984-10222e91162f","timestamp":"2026-01-29T14:25:26.914Z"}
{"parentUuid":"7de98705-02a2-4407-a9f3-4b2feeb3c8c5","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01AUtgXXHFqfte1injNEEBCP","type":"tool_result","content":[{"type":"text","text":"const img = \"https://www.figma.com/api/mcp/asset/08ef8749-b895-48a1-9f46-5882ce4ed123\";\nconst img1 = \"https://www.figma.com/api/mcp/asset/d528dd0d-c462-4a12-8c67-ce97e21d18d7\";\ntype ButtonOnlyIconProps = {\n  className?: string;\n  badge?: boolean;\n  tooltip?: boolean;\n  type?: \"Icon\";\n  state?: \"Enabled\" | \"Hovered\" | \"Pressed\";\n};\n\nfunction ButtonOnlyIcon({ className, badge = false, tooltip = true, type = \"Icon\", state = \"Enabled\" }: ButtonOnlyIconProps) {\n  return (\n    <div data-node-id=\"32:3970\" className={className || \"content-stretch cursor-pointer flex items-center justify-center relative rounded-[100px] size-[44px]\"}>\n      <div data-node-id=\"32:4028\" className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[100px]\" data-name=\"state-layer\">\n        <div data-node-id=\"32:4029\" className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\">\n          <div data-node-id=\"I32:4029;324:4075\" className=\"absolute inset-[12.5%]\" data-name=\"Vector\">\n            <img className=\"block max-w-none size-full\" alt=\"\" src={img} />\n          </div>\n        </div>\n        {tooltip && (\n          <div className=\"-translate-x-1/2 absolute content-stretch flex flex-col items-center justify-center left-1/2 opacity-0 pt-[8px] top-[44px]\" data-name=\"space + Tooltip\" data-node-id=\"32:4030\">\n            <div className=\"bg-[#4d4d4f] content-stretch flex items-center px-[8px] py-[4px] relative rounded-[4px] shrink-0\" data-name=\"Tooltip\" data-node-id=\"32:4031\">\n              <p className=\"font-['Lato:SemiBold',sans-serif] leading-[16px] not-italic relative shrink-0 text-[#f2f2f7] text-[12px] tracking-[0.06px]\" data-node-id=\"I32:4031;1394:240\">\n                Tooltip single line\n              </p>\n            </div>\n          </div>\n        )}\n      </div>\n      {badge && (\n        <div className=\"absolute bg-[#f73b3b] border border-solid border-white content-stretch flex flex-col items-center justify-center px-[5.5px] py-px right-0 rounded-[16px] top-0\" data-name=\"Badge\" data-node-id=\"32:4032\">\n          <p className=\"font-['Lato:SemiBold',sans-serif] leading-[16px] not-italic relative shrink-0 text-[12px] text-white tracking-[0.06px]\" data-node-id=\"I32:4032;2193:6453\">\n            1\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function Modal() {\n  return (\n    <div className=\"bg-white content-stretch flex flex-col items-start relative rounded-[12px] shadow-[0px_4px_8px_0px_rgba(0,0,0,0.25)] size-full\" data-name=\"Modal\" data-node-id=\"5171:28745\">\n      <div className=\"content-stretch flex flex-col gap-[16px] items-center pt-[24px] px-[24px] relative shrink-0 w-full\" data-name=\"Icon title and description\" data-node-id=\"I5171:28745;636:1950\">\n        <p className=\"font-['Lato:Regular',sans-serif] leading-[32px] min-w-full not-italic relative shrink-0 text-[#1c1c1d] text-[24px] w-[min-content] whitespace-pre-wrap\" data-node-id=\"I5171:28745;638:1954\">\n          Modal example\n        </p>\n        <div className=\"absolute content-stretch flex items-center justify-center right-[18px] size-[44px] top-[18px]\" data-name=\"Close\" data-node-id=\"I5171:28745;1024:5687\">\n          <ButtonOnlyIcon className=\"content-stretch cursor-pointer flex items-center justify-center relative rounded-[100px] shrink-0 size-[44px]\" tooltip={false} />\n        </div>\n        <div className=\"content-stretch flex flex-col gap-[16px] items-center pb-[24px] relative shrink-0 w-full\" data-name=\"Modal content variables\" data-node-id=\"I5171:28745;7431:3738\">\n          <div className=\"border-[#c8c8cc] border-b border-solid content-stretch flex flex-col items-center justify-center py-[8px] relative shrink-0 w-full\" data-name=\"Link\" data-node-id=\"I5171:28745;7431:3738;7431:2719\">\n            <div className=\"content-stretch flex flex-col items-start justify-center relative shrink-0 w-full\" data-node-id=\"I5171:28745;7431:3738;7431:2720\">\n              <button className=\"content-stretch cursor-pointer flex items-center justify-center relative shrink-0 w-full\" data-name=\"Link button\" data-node-id=\"I5171:28745;7431:3738;7431:2721\">\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-left tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2721;625:1710\">\n                  Sample text\n                </p>\n              </button>\n            </div>\n          </div>\n          <p className=\"font-['Lato:Medium',sans-serif] leading-[24px] not-italic relative shrink-0 text-[#4d4d4f] text-[16px] tracking-[0.08px] w-full whitespace-pre-wrap\" data-node-id=\"I5171:28745;7431:3738;7431:2718\">\n            Comparte este enlace, has uso de las diferentes redes sociales o copia el vinculo.\n          </p>\n          <div className=\"content-center cursor-pointer flex flex-wrap gap-[20px] items-center relative shrink-0 w-full\" data-name=\"Share options\" data-node-id=\"I5171:28745;7431:3738;7431:2722\">\n            <div className=\"bg-[#006cb3] content-stretch flex h-[44px] items-center justify-center relative rounded-[8px] shrink-0 w-[127px]\" data-name=\"Button\" data-node-id=\"I5171:28745;7431:3738;7431:2723\">\n              <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;7431:3738;7431:2723;206:1118\">\n                <div className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\" data-node-id=\"I5171:28745;7431:3738;7431:2723;325:4314\">\n                  <div className=\"absolute inset-[12.5%]\" data-name=\"Vector\" data-node-id=\"I5171:28745;7431:3738;7431:2723;325:4314;324:4075\">\n                    <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n                  </div>\n                </div>\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[14px] text-center text-white tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2723;204:1111\">\n                  Button\n                </p>\n              </div>\n            </div>\n            <div className=\"content-stretch flex h-[44px] items-center justify-center relative rounded-[8px] shrink-0 w-[127px]\" data-name=\"Button\" data-node-id=\"I5171:28745;7431:3738;7431:2724\">\n              <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;7431:3738;7431:2724;206:1451\">\n                <div className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\" data-node-id=\"I5171:28745;7431:3738;7431:2724;325:4520\">\n                  <div className=\"absolute inset-[12.5%]\" data-name=\"Vector\" data-node-id=\"I5171:28745;7431:3738;7431:2724;325:4520;324:4075\">\n                    <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n                  </div>\n                </div>\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-center tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2724;206:1453\">\n                  Button\n                </p>\n              </div>\n            </div>\n            <div className=\"content-stretch flex h-[44px] items-center justify-center relative rounded-[8px] shrink-0 w-[127px]\" data-name=\"Button\" data-node-id=\"I5171:28745;7431:3738;7431:2725\">\n              <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;7431:3738;7431:2725;206:1451\">\n                <div className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\" data-node-id=\"I5171:28745;7431:3738;7431:2725;325:4520\">\n                  <div className=\"absolute inset-[12.5%]\" data-name=\"Vector\" data-node-id=\"I5171:28745;7431:3738;7431:2725;325:4520;324:4075\">\n                    <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n                  </div>\n                </div>\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-center tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2725;206:1453\">\n                  Button\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"content-stretch flex gap-[16px] items-start relative shrink-0 w-full\" data-name=\"Info space\" data-node-id=\"I5171:28745;7431:3738;7431:2734\">\n            <div className=\"relative shrink-0 size-[24px]\" data-name=\"info-circle\" data-node-id=\"I5171:28745;7431:3738;7431:2735\">\n              <img alt=\"\" className=\"block max-w-none size-full\" src={img1} />\n            </div>\n            <p className=\"flex-[1_0_0] font-['Lato:Medium',sans-serif] leading-[24px] min-h-px min-w-px not-italic relative text-[#4d4d4f] text-[16px] tracking-[0.08px] whitespace-pre-wrap\" data-node-id=\"I5171:28745;7431:3738;7431:2736\">\n              Este enlace caducará en 15 días, infórmale a tu cliente.\n            </p>\n          </div>\n        </div>\n      </div>\n      <div className=\"content-stretch cursor-pointer flex gap-[20px] items-center justify-center p-[24px] relative shrink-0 w-full\" data-name=\"Actions\" data-node-id=\"I5171:28745;638:1967\">\n        <div className=\"border border-[#006cb3] border-solid content-stretch flex flex-[1_0_0] h-[44px] items-center justify-center min-h-px min-w-px relative rounded-[8px]\" data-name=\"Button\" data-node-id=\"I5171:28745;638:1969\">\n          <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;638:1969;206:1408\">\n            <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-center tracking-[0.07px]\" data-node-id=\"I5171:28745;638:1969;206:1410\">\n              Button\n            </p>\n          </div>\n        </div>\n        <div className=\"bg-[#006cb3] content-stretch flex flex-[1_0_0] h-[44px] items-center justify-center min-h-px min-w-px relative rounded-[8px]\" data-name=\"Button\" data-node-id=\"I5171:28745;638:1962\">\n          <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;638:1962;206:1118\">\n            <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[14px] text-center text-white tracking-[0.07px]\" data-node-id=\"I5171:28745;638:1962;204:1111\">\n              Button\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"},{"type":"text","text":"SUPER CRITICAL: The generated React+Tailwind code MUST be converted to match the target project's technology stack and styling system.\n1. Analyze the target codebase to identify: technology stack, styling approach, component patterns, and design tokens\n2. Convert React syntax to the target framework/library\n3. Transform all Tailwind classes to the target styling system while preserving exact visual design\n4. Follow the project's existing patterns and conventions\nDO NOT install any Tailwind as a dependency unless the user instructs you to do so.\n"},{"type":"text","text":"Node ids have been added to the code as data attributes, e.g. `data-node-id=\"1:2\"`."},{"type":"text","text":"These styles are contained in the design: Gray/10: #1C1C1D, Headline/Headline 4 Regular: Font(family: \"Lato\", style: Regular, size: 24, weight: 400, lineHeight: 32, letterSpacing: 0), Gray/30: #4D4D4F, Body/Body 2: Font(family: \"Lato\", style: Medium, size: 16, weight: 500, lineHeight: 24, letterSpacing: 0.5), Blue/B-40: #006CB3, Label/Label 1: Font(family: \"Lato\", style: SemiBold, size: 14, weight: 600, lineHeight: 20, letterSpacing: 0.5), Black and white/White: #FFFFFF, Black/Small: Effect(type: DROP_SHADOW, color: #00000040, offset: (0, 4), radius: 8, spread: 1)."},{"type":"text","text":"Images and SVGs will be stored as constants, e.g. const image = 'https://www.figma.com/api/mcp/asset/550e8400-e29b-41d4-a716-446655440000'. These constants will be used in the code as the source for the image, ex: <img src={image} />. Image assets are stored on a remote server for 7 days and can be fetched using the provided URLs until they expire."},{"type":"text","text":"IMPORTANT: After you call this tool, you MUST call get_screenshot to get a screenshot of the node for context."}]}]},"uuid":"abc17737-d81a-49c8-b119-3543406a1c9f","timestamp":"2026-01-29T14:25:26.917Z","toolUseResult":[{"type":"text","text":"const img = \"https://www.figma.com/api/mcp/asset/08ef8749-b895-48a1-9f46-5882ce4ed123\";\nconst img1 = \"https://www.figma.com/api/mcp/asset/d528dd0d-c462-4a12-8c67-ce97e21d18d7\";\ntype ButtonOnlyIconProps = {\n  className?: string;\n  badge?: boolean;\n  tooltip?: boolean;\n  type?: \"Icon\";\n  state?: \"Enabled\" | \"Hovered\" | \"Pressed\";\n};\n\nfunction ButtonOnlyIcon({ className, badge = false, tooltip = true, type = \"Icon\", state = \"Enabled\" }: ButtonOnlyIconProps) {\n  return (\n    <div data-node-id=\"32:3970\" className={className || \"content-stretch cursor-pointer flex items-center justify-center relative rounded-[100px] size-[44px]\"}>\n      <div data-node-id=\"32:4028\" className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[100px]\" data-name=\"state-layer\">\n        <div data-node-id=\"32:4029\" className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\">\n          <div data-node-id=\"I32:4029;324:4075\" className=\"absolute inset-[12.5%]\" data-name=\"Vector\">\n            <img className=\"block max-w-none size-full\" alt=\"\" src={img} />\n          </div>\n        </div>\n        {tooltip && (\n          <div className=\"-translate-x-1/2 absolute content-stretch flex flex-col items-center justify-center left-1/2 opacity-0 pt-[8px] top-[44px]\" data-name=\"space + Tooltip\" data-node-id=\"32:4030\">\n            <div className=\"bg-[#4d4d4f] content-stretch flex items-center px-[8px] py-[4px] relative rounded-[4px] shrink-0\" data-name=\"Tooltip\" data-node-id=\"32:4031\">\n              <p className=\"font-['Lato:SemiBold',sans-serif] leading-[16px] not-italic relative shrink-0 text-[#f2f2f7] text-[12px] tracking-[0.06px]\" data-node-id=\"I32:4031;1394:240\">\n                Tooltip single line\n              </p>\n            </div>\n          </div>\n        )}\n      </div>\n      {badge && (\n        <div className=\"absolute bg-[#f73b3b] border border-solid border-white content-stretch flex flex-col items-center justify-center px-[5.5px] py-px right-0 rounded-[16px] top-0\" data-name=\"Badge\" data-node-id=\"32:4032\">\n          <p className=\"font-['Lato:SemiBold',sans-serif] leading-[16px] not-italic relative shrink-0 text-[12px] text-white tracking-[0.06px]\" data-node-id=\"I32:4032;2193:6453\">\n            1\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function Modal() {\n  return (\n    <div className=\"bg-white content-stretch flex flex-col items-start relative rounded-[12px] shadow-[0px_4px_8px_0px_rgba(0,0,0,0.25)] size-full\" data-name=\"Modal\" data-node-id=\"5171:28745\">\n      <div className=\"content-stretch flex flex-col gap-[16px] items-center pt-[24px] px-[24px] relative shrink-0 w-full\" data-name=\"Icon title and description\" data-node-id=\"I5171:28745;636:1950\">\n        <p className=\"font-['Lato:Regular',sans-serif] leading-[32px] min-w-full not-italic relative shrink-0 text-[#1c1c1d] text-[24px] w-[min-content] whitespace-pre-wrap\" data-node-id=\"I5171:28745;638:1954\">\n          Modal example\n        </p>\n        <div className=\"absolute content-stretch flex items-center justify-center right-[18px] size-[44px] top-[18px]\" data-name=\"Close\" data-node-id=\"I5171:28745;1024:5687\">\n          <ButtonOnlyIcon className=\"content-stretch cursor-pointer flex items-center justify-center relative rounded-[100px] shrink-0 size-[44px]\" tooltip={false} />\n        </div>\n        <div className=\"content-stretch flex flex-col gap-[16px] items-center pb-[24px] relative shrink-0 w-full\" data-name=\"Modal content variables\" data-node-id=\"I5171:28745;7431:3738\">\n          <div className=\"border-[#c8c8cc] border-b border-solid content-stretch flex flex-col items-center justify-center py-[8px] relative shrink-0 w-full\" data-name=\"Link\" data-node-id=\"I5171:28745;7431:3738;7431:2719\">\n            <div className=\"content-stretch flex flex-col items-start justify-center relative shrink-0 w-full\" data-node-id=\"I5171:28745;7431:3738;7431:2720\">\n              <button className=\"content-stretch cursor-pointer flex items-center justify-center relative shrink-0 w-full\" data-name=\"Link button\" data-node-id=\"I5171:28745;7431:3738;7431:2721\">\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-left tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2721;625:1710\">\n                  Sample text\n                </p>\n              </button>\n            </div>\n          </div>\n          <p className=\"font-['Lato:Medium',sans-serif] leading-[24px] not-italic relative shrink-0 text-[#4d4d4f] text-[16px] tracking-[0.08px] w-full whitespace-pre-wrap\" data-node-id=\"I5171:28745;7431:3738;7431:2718\">\n            Comparte este enlace, has uso de las diferentes redes sociales o copia el vinculo.\n          </p>\n          <div className=\"content-center cursor-pointer flex flex-wrap gap-[20px] items-center relative shrink-0 w-full\" data-name=\"Share options\" data-node-id=\"I5171:28745;7431:3738;7431:2722\">\n            <div className=\"bg-[#006cb3] content-stretch flex h-[44px] items-center justify-center relative rounded-[8px] shrink-0 w-[127px]\" data-name=\"Button\" data-node-id=\"I5171:28745;7431:3738;7431:2723\">\n              <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;7431:3738;7431:2723;206:1118\">\n                <div className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\" data-node-id=\"I5171:28745;7431:3738;7431:2723;325:4314\">\n                  <div className=\"absolute inset-[12.5%]\" data-name=\"Vector\" data-node-id=\"I5171:28745;7431:3738;7431:2723;325:4314;324:4075\">\n                    <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n                  </div>\n                </div>\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[14px] text-center text-white tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2723;204:1111\">\n                  Button\n                </p>\n              </div>\n            </div>\n            <div className=\"content-stretch flex h-[44px] items-center justify-center relative rounded-[8px] shrink-0 w-[127px]\" data-name=\"Button\" data-node-id=\"I5171:28745;7431:3738;7431:2724\">\n              <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;7431:3738;7431:2724;206:1451\">\n                <div className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\" data-node-id=\"I5171:28745;7431:3738;7431:2724;325:4520\">\n                  <div className=\"absolute inset-[12.5%]\" data-name=\"Vector\" data-node-id=\"I5171:28745;7431:3738;7431:2724;325:4520;324:4075\">\n                    <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n                  </div>\n                </div>\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-center tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2724;206:1453\">\n                  Button\n                </p>\n              </div>\n            </div>\n            <div className=\"content-stretch flex h-[44px] items-center justify-center relative rounded-[8px] shrink-0 w-[127px]\" data-name=\"Button\" data-node-id=\"I5171:28745;7431:3738;7431:2725\">\n              <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;7431:3738;7431:2725;206:1451\">\n                <div className=\"relative shrink-0 size-[24px]\" data-name=\"plus-lg\" data-node-id=\"I5171:28745;7431:3738;7431:2725;325:4520\">\n                  <div className=\"absolute inset-[12.5%]\" data-name=\"Vector\" data-node-id=\"I5171:28745;7431:3738;7431:2725;325:4520;324:4075\">\n                    <img alt=\"\" className=\"block max-w-none size-full\" src={img} />\n                  </div>\n                </div>\n                <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-center tracking-[0.07px]\" data-node-id=\"I5171:28745;7431:3738;7431:2725;206:1453\">\n                  Button\n                </p>\n              </div>\n            </div>\n          </div>\n          <div className=\"content-stretch flex gap-[16px] items-start relative shrink-0 w-full\" data-name=\"Info space\" data-node-id=\"I5171:28745;7431:3738;7431:2734\">\n            <div className=\"relative shrink-0 size-[24px]\" data-name=\"info-circle\" data-node-id=\"I5171:28745;7431:3738;7431:2735\">\n              <img alt=\"\" className=\"block max-w-none size-full\" src={img1} />\n            </div>\n            <p className=\"flex-[1_0_0] font-['Lato:Medium',sans-serif] leading-[24px] min-h-px min-w-px not-italic relative text-[#4d4d4f] text-[16px] tracking-[0.08px] whitespace-pre-wrap\" data-node-id=\"I5171:28745;7431:3738;7431:2736\">\n              Este enlace caducará en 15 días, infórmale a tu cliente.\n            </p>\n          </div>\n        </div>\n      </div>\n      <div className=\"content-stretch cursor-pointer flex gap-[20px] items-center justify-center p-[24px] relative shrink-0 w-full\" data-name=\"Actions\" data-node-id=\"I5171:28745;638:1967\">\n        <div className=\"border border-[#006cb3] border-solid content-stretch flex flex-[1_0_0] h-[44px] items-center justify-center min-h-px min-w-px relative rounded-[8px]\" data-name=\"Button\" data-node-id=\"I5171:28745;638:1969\">\n          <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;638:1969;206:1408\">\n            <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[#006cb3] text-[14px] text-center tracking-[0.07px]\" data-node-id=\"I5171:28745;638:1969;206:1410\">\n              Button\n            </p>\n          </div>\n        </div>\n        <div className=\"bg-[#006cb3] content-stretch flex flex-[1_0_0] h-[44px] items-center justify-center min-h-px min-w-px relative rounded-[8px]\" data-name=\"Button\" data-node-id=\"I5171:28745;638:1962\">\n          <div className=\"content-stretch flex flex-[1_0_0] gap-[8px] h-full items-center justify-center min-h-px min-w-px px-[16px] py-[10px] relative rounded-[8px]\" data-name=\"state-layer\" data-node-id=\"I5171:28745;638:1962;206:1118\">\n            <p className=\"font-['Lato:SemiBold',sans-serif] leading-[20px] not-italic relative shrink-0 text-[14px] text-center text-white tracking-[0.07px]\" data-node-id=\"I5171:28745;638:1962;204:1111\">\n              Button\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}"},{"type":"text","text":"SUPER CRITICAL: The generated React+Tailwind code MUST be converted to match the target project's technology stack and styling system.\n1. Analyze the target codebase to identify: technology stack, styling approach, component patterns, and design tokens\n2. Convert React syntax to the target framework/library\n3. Transform all Tailwind classes to the target styling system while preserving exact visual design\n4. Follow the project's existing patterns and conventions\nDO NOT install any Tailwind as a dependency unless the user instructs you to do so.\n"},{"type":"text","text":"Node ids have been added to the code as data attributes, e.g. `data-node-id=\"1:2\"`."},{"type":"text","text":"These styles are contained in the design: Gray/10: #1C1C1D, Headline/Headline 4 Regular: Font(family: \"Lato\", style: Regular, size: 24, weight: 400, lineHeight: 32, letterSpacing: 0), Gray/30: #4D4D4F, Body/Body 2: Font(family: \"Lato\", style: Medium, size: 16, weight: 500, lineHeight: 24, letterSpacing: 0.5), Blue/B-40: #006CB3, Label/Label 1: Font(family: \"Lato\", style: SemiBold, size: 14, weight: 600, lineHeight: 20, letterSpacing: 0.5), Black and white/White: #FFFFFF, Black/Small: Effect(type: DROP_SHADOW, color: #00000040, offset: (0, 4), radius: 8, spread: 1)."},{"type":"text","text":"Images and SVGs will be stored as constants, e.g. const image = 'https://www.figma.com/api/mcp/asset/550e8400-e29b-41d4-a716-446655440000'. These constants will be used in the code as the source for the image, ex: <img src={image} />. Image assets are stored on a remote server for 7 days and can be fetched using the provided URLs until they expire."},{"type":"text","text":"IMPORTANT: After you call this tool, you MUST call get_screenshot to get a screenshot of the node for context."}],"sourceToolAssistantUUID":"7de98705-02a2-4407-a9f3-4b2feeb3c8c5"}
{"parentUuid":"abc17737-d81a-49c8-b119-3543406a1c9f","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017R67kxLfgE1RZBX5XtXeFQ","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Ahora tengo el diseño del modal. Es un modal simple con:\n- Título: \"Solicita más créditos\"\n- Descripción: \"Tu saldo está por debajo del 20% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.\"\n- Botón de cerrar (X)\n- Dos botones: \"Cancelar\" (outline) y \"Solicitar más créditos\" (filled azul)\n- Fondo blanco con bordes redondeados y sombra\n- Estilos: Lato font, colores azul #006CB3, gris #4D4D4F, etc.\n\nAhora necesito:\n1. Ver cómo se implementan los modales en el proyecto\n2. Ver la función actual `obtenerCreditosDisponiblesEmpresa` que maneja el tag de créditos\n3. Entender la ruta /procesos y dónde se carga esta lógica\n\nVoy a explorar el código existente.","signature":"EvUGCkYICxgCKkC79X5Bleu/+Vll11Hi55w2OY5vBsWKn69OOE0Bun2crhfbT3I2P1FZ//JIzQ1+RXCSmqVF2Y6pSBQNJ3UljYMQEgzshdhP5v6vWGHrPK0aDBiaybR56iRAtNHpsSIw/5jzQd1xgRU5PNhFkF/ZTfh4D3JLeBbBHyobZWFpObl8VulN8O08r8lwlyGom2dxKtwF7H5QXlVGFFglVJcLhXNLtG12kTONgyzibjw4xeJ4KWRhW8pfbrfJ4c+Z3b4Ww7ZDlOclFjfSrHkeyQ1eSmiWEDoP6r21wYb3EQdVypzqa2hYR5JmH8kxXFK+et0IEgZdjZR66UCHeFnmb/8FeSjMxJRZ44Ip+iMX055eeayP/RngY6jxj6IRz3e9st1/E02mYXZ2nFPhGJZ3pAsDdvE1+qBliv1edGmN1dyesJNY/mvaYWoHLqcnagUP8rCdKtTBFHrmaJEQ1I/+wgVBy8pYJDWOIZOStN3HBlJMszNI3oJjyt+0BZjgCvd3reRKkwRNAlF6SrI1UV7zxemU9ULIRENUtQMBNlmgpScGPVvH1u5Utm5oUgl4xc/rFU922VyZlH2yb4eYHnBDSOWTsQ9MAsKwgIo7XprZ3UXTcy/OaWwEDccDsCUXKLUq5i7tNOci0KFHGcbngW2FYEz6Ob8YKYAGVEy/+JT1qUKyMu5WGu7QDQ2XGH/xEYVt65OYXG5dgx4zY4Ao8edUmgpUIKmbZ1gImROwME29ecK6gTTwl4AIGVkonNp0WkuNA16mEZLglsqPQpqE08gZlmROwl3LV8F8DpKLAR40v2ZaxQwyHHjTZ3QFJBdA764bC9UMn6uunmuwXg9Na+oHDgEtPJfeIrDvE9pAFqF4aMWTzhnqCq5nN7DDuQmyBohN5yN0lyvVijF5LqmeSKsQawQkJCpSxXmEWV+KRxYMdMEr0+0239TiMhlQa7ngzKWjnFq0Of3AoFdMaQzDwepAY7n4PZqGWBemLLYNFrVpY+S7+HBBBT16ufJxj2xnDaL2GIK53ACy2mCOucXTamlKKJ7sVuLgAaWTTS5iyorI+HWFtTwEzUSGb4AkCE+VijR0FbSm8rgmb27UgsUh9uuBqkUMi1zO0YX0RbtHj6Bs8tf0zU9X4yM0dydJfzA3wALKvP+W/G5v+PzhRxWPGD1E3wLkGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":251,"cache_creation_input_tokens":5145,"cache_read_input_tokens":31412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":5145},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbphWufBBBk8K4C51uMf","type":"assistant","uuid":"021b0357-1b56-416a-a645-afee1d9d37fe","timestamp":"2026-01-29T14:25:35.523Z"}
{"parentUuid":"021b0357-1b56-416a-a645-afee1d9d37fe","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017R67kxLfgE1RZBX5XtXeFQ","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora tengo el diseño del modal. Voy a explorar el código existente para entender cómo implementar esta funcionalidad."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":251,"cache_creation_input_tokens":5145,"cache_read_input_tokens":31412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":5145},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbphWufBBBk8K4C51uMf","type":"assistant","uuid":"dd6ff78a-027b-4f97-8030-8eca1e2ceb9e","timestamp":"2026-01-29T14:25:36.207Z"}
{"parentUuid":"dd6ff78a-027b-4f97-8030-8eca1e2ceb9e","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017R67kxLfgE1RZBX5XtXeFQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01J1jH9ZUqg8tSQN1LB6VMdS","name":"Grep","input":{"pattern":"obtenerCreditosDisponiblesEmpresa","output_mode":"files_with_matches"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":251,"cache_creation_input_tokens":5145,"cache_read_input_tokens":31412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":5145},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbphWufBBBk8K4C51uMf","type":"assistant","uuid":"684ab40c-b53b-4d24-98f3-ba93d900c291","timestamp":"2026-01-29T14:25:37.009Z"}
{"parentUuid":"684ab40c-b53b-4d24-98f3-ba93d900c291","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017R67kxLfgE1RZBX5XtXeFQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_0179mr4PykZtECuEeuySf6fj","name":"Glob","input":{"pattern":"**/views/**/procesos/**/index.blade.php"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":251,"cache_creation_input_tokens":5145,"cache_read_input_tokens":31412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":5145},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbphWufBBBk8K4C51uMf","type":"assistant","uuid":"dff3be68-0613-4db3-be69-8143fdc3f529","timestamp":"2026-01-29T14:25:37.697Z"}
{"parentUuid":"dff3be68-0613-4db3-be69-8143fdc3f529","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017R67kxLfgE1RZBX5XtXeFQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01FVJL4YwLPvaabiUGZrKWWw","name":"Grep","input":{"pattern":"crearModal","glob":"*.js","output_mode":"files_with_matches"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":251,"cache_creation_input_tokens":5145,"cache_read_input_tokens":31412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":5145},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbphWufBBBk8K4C51uMf","type":"assistant","uuid":"8a78284e-75bd-48ee-98c1-1ec2ba96efe5","timestamp":"2026-01-29T14:25:38.428Z"}
{"parentUuid":"684ab40c-b53b-4d24-98f3-ba93d900c291","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01J1jH9ZUqg8tSQN1LB6VMdS","type":"tool_result","content":"Found 1 file\npublic\\js\\globales.js"}]},"uuid":"f3f14118-3ed3-4632-a88f-80d7b1187391","timestamp":"2026-01-29T14:25:43.027Z","toolUseResult":{"mode":"files_with_matches","filenames":["public\\js\\globales.js"],"numFiles":1},"sourceToolAssistantUUID":"684ab40c-b53b-4d24-98f3-ba93d900c291"}
{"parentUuid":"f3f14118-3ed3-4632-a88f-80d7b1187391","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Grep","command":"callback"},"parentToolUseID":"toolu_01J1jH9ZUqg8tSQN1LB6VMdS","toolUseID":"toolu_01J1jH9ZUqg8tSQN1LB6VMdS","timestamp":"2026-01-29T14:25:43.030Z","uuid":"0dd447e1-5d10-41ea-905f-91c525336a06"}
{"parentUuid":"8a78284e-75bd-48ee-98c1-1ec2ba96efe5","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01FVJL4YwLPvaabiUGZrKWWw","type":"tool_result","content":"Found 3 files\npublic\\js\\vacantes\\detalles\\detalle-etapas.js\npublic\\componentes\\componentes\\modal.js\npublic\\componentes\\componentes\\adicionales.js"}]},"uuid":"05d03d97-f43b-48e9-b216-d5f01d899398","timestamp":"2026-01-29T14:25:43.078Z","toolUseResult":{"mode":"files_with_matches","filenames":["public\\js\\vacantes\\detalles\\detalle-etapas.js","public\\componentes\\componentes\\modal.js","public\\componentes\\componentes\\adicionales.js"],"numFiles":3},"sourceToolAssistantUUID":"8a78284e-75bd-48ee-98c1-1ec2ba96efe5"}
{"parentUuid":"05d03d97-f43b-48e9-b216-d5f01d899398","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Grep","command":"callback"},"parentToolUseID":"toolu_01FVJL4YwLPvaabiUGZrKWWw","toolUseID":"toolu_01FVJL4YwLPvaabiUGZrKWWw","timestamp":"2026-01-29T14:25:43.080Z","uuid":"ab1fe1eb-60be-498a-a8c4-0e18dbac8dd1"}
{"parentUuid":"dff3be68-0613-4db3-be69-8143fdc3f529","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_0179mr4PykZtECuEeuySf6fj","type":"tool_result","content":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\resources\\views\\procesos\\index.blade.php"}]},"uuid":"d6f67791-0f67-408f-892e-396cbc868e31","timestamp":"2026-01-29T14:25:43.461Z","toolUseResult":{"filenames":["C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\resources\\views\\procesos\\index.blade.php"],"durationMs":2072,"numFiles":1,"truncated":false},"sourceToolAssistantUUID":"dff3be68-0613-4db3-be69-8143fdc3f529"}
{"parentUuid":"d6f67791-0f67-408f-892e-396cbc868e31","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Glob","command":"callback"},"parentToolUseID":"toolu_0179mr4PykZtECuEeuySf6fj","toolUseID":"toolu_0179mr4PykZtECuEeuySf6fj","timestamp":"2026-01-29T14:25:43.463Z","uuid":"cda452d6-2901-4ab2-b6ee-0a391e15072c"}
{"parentUuid":"cda452d6-2901-4ab2-b6ee-0a391e15072c","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017e9esfkAGuofGFFHQDR1UY","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Encontré los archivos relevantes:\n1. `public/js/globales.js` - Contiene la función `obtenerCreditosDisponiblesEmpresa`\n2. `resources/views/procesos/index.blade.php` - Vista principal de procesos\n3. `public/componentes/componentes/modal.js` - Sistema de modales del proyecto\n\nVoy a leer estos archivos para entender cómo funcionan.","signature":"EvQDCkYICxgCKkC9lqYnSRr3JfPX00cm2OG6FzQ3RnjrjHHtSO5dx6lyRVVdIMaKUHyjjd5vTQzG/6RR3atg+tHlrDNy5nxD3/A0EgyMXacp8RWrFGIqwSoaDK+RyM09W11iLXDYqiIwH6oq/8HtlM9J/CpIB6q3ufpT5HQP+ufwMAJysUzEFlNO5hBT6Ku/sMAJjuMu2DDaKtsCMpbN6DBs2DwjUEyCamrps1VJffE9J6L3onoRjNfJkEiOkNcMT5MlxgXY6yk30MB/l66yvqnXuQKOW4BVo602MpYsnyIt5Xaz+07m2PpHY/T2WmHfx6BTmuZiq2Ckowz77cvEJJk/n2qvFTKhpQPu7JbN7zLU+i6uTbO8fc5agtZPOtZtoY7SaksH0evHAQYvZVkTu3Ve/7DeOYXUU6VmT2v65drCBZjpJNYsdKdFVLOmHMELDTQEfS0K1EtVvXqn+sLlKHrFgvLSid0va5EAI/4pJZFRT1v+miak6bO+9ZDqkMYcGsGfpaTXYJUiu+9Oq10MIZVqEY9goDhzpjpK3WC4odj9PKWZUzxtQvJsEBE8v62LNMG1k4uznIvNV7TwQK21K/Wz+j8BaITFl2g71zzbR2//WUdr/xMuwQ/fhpV0wa7qeGZMkP1TKSI+Zo2tggSPoKiIU/l3e/8YAQ=="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":88,"cache_creation_input_tokens":967,"cache_read_input_tokens":36557,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":967},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpijuHZvWE1PYupj3yR","type":"assistant","uuid":"181bf4bd-2a91-441f-9c47-30f1b1bab78f","timestamp":"2026-01-29T14:25:48.070Z"}
{"parentUuid":"181bf4bd-2a91-441f-9c47-30f1b1bab78f","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017e9esfkAGuofGFFHQDR1UY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Jf2dW8eGj7LbwxiaF7btV8","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":88,"cache_creation_input_tokens":967,"cache_read_input_tokens":36557,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":967},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpijuHZvWE1PYupj3yR","type":"assistant","uuid":"e9c1cc60-d59f-42ed-902c-6557a89876b5","timestamp":"2026-01-29T14:25:48.609Z"}
{"parentUuid":"e9c1cc60-d59f-42ed-902c-6557a89876b5","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017e9esfkAGuofGFFHQDR1UY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01XJ1SWmmKTo6c14asSg18w4","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\componentes\\componentes\\modal.js"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":88,"cache_creation_input_tokens":967,"cache_read_input_tokens":36557,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":967},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpijuHZvWE1PYupj3yR","type":"assistant","uuid":"a4f0b92d-a670-43fd-b3f3-05f08114afa4","timestamp":"2026-01-29T14:25:49.227Z"}
{"parentUuid":"a4f0b92d-a670-43fd-b3f3-05f08114afa4","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_017e9esfkAGuofGFFHQDR1UY","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Kb9YfjeAZmZp6RYu4ssWwa","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\resources\\views\\procesos\\index.blade.php"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":88,"cache_creation_input_tokens":967,"cache_read_input_tokens":36557,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":967},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpijuHZvWE1PYupj3yR","type":"assistant","uuid":"172df0db-d03a-4fc0-9315-4487c038b4e9","timestamp":"2026-01-29T14:25:49.632Z"}
{"parentUuid":"a4f0b92d-a670-43fd-b3f3-05f08114afa4","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01XJ1SWmmKTo6c14asSg18w4","type":"tool_result","content":"     1→/**\n     2→ * Crear un modal\n     3→ * \n     4→ * @param {object} componente Componente de modal.\n     5→ * @returns {string} Componente de modal.\n     6→ * @author José Manuel Jiménez\n     7→ * @author Andres Morales\n     8→ */\n     9→function crearModal(componente) {\n    10→    return `\n    11→        <div id=\"${componente.id}\" class=\"modal fade ${componente.modals_header_class ? componente.modals_header_class : ''}\" data-bs-focus=\"false\" ${componente.adiconales_modals_header ? `${componente.adiconales_modals_header}` : ''}>\n    12→            <div class=\"modal-dialog ${componente.dialog_class ? componente.dialog_class : ''}\">\n    13→                <div class=\"modal-content shadow-1 rounded-4 px-6 ${componente.content_class ? componente.content_class : ''} pt-4\">\n    14→                    ${crearModalHeader(componente)}\n    15→                    <div class=\"modal-body ${componente.modal_body_class ? componente.modal_body_class : ''}\">\n    16→                        <div class=\"row\">\n    17→                            ${componente.modal_body ? componente.modal_body : ''}\n    18→                        </div>\n    19→                    </div>\n    20→                    ${crearModalFooter(componente)}\n    21→                </div>\n    22→            </div>\n    23→        </div>\n    24→    `;\n    25→}\n    26→\n    27→/**\n    28→ * Crear un modal header\n    29→ * \n    30→ * @param {object} componente Componente de modal.\n    31→ * @returns {string} Header de modal.\n    32→ * @author José Manuel Jiménez\n    33→ * @author Andres Morales\n    34→ */\n    35→function crearModalHeader(componente) {\n    36→    if (!componente.icono_header) {\n    37→        return `\n    38→            <div class=\"modal-header border-0 px-0 ${componente.header_class ? componente.header_class : ''}\">\n    39→                <div class=\"col-12\">\n    40→                    <div class=\"row justify-content-between align-items-center\">\n    41→                        <div class=\"col-auto text-headline-4 text-gray-10 mb-0\" id=\"${componente.id}_label\">${componente.titulo_header}</div>\n    42→                        <div class=\"col-auto text-headline-4 pointer ${componente.header_cerrar ? componente.header_cerrar : '' }\" ${componente.adiconales_cerrar_modal_header ? componente.adiconales_cerrar_modal_header : `data-bs-dismiss=\"modal\" aria-label=\"Close\"`} ${crearTooltip({\n    43→                            placement: `top`,\n    44→                            content: `Cerrar`,\n    45→                            toggle: `popover`,\n    46→                        })}>\n    47→                            <i class=\"bi bi-x text-gray-10\"></i>\n    48→                        </div>\n    49→                        ${componente.subtitulo_header ? `<div id=\"${componente.id}_subtitulo\" class=\"col-12 mt-3 text-body-2 fw-normal\">${componente.subtitulo_header}</div>` : ''}\n    50→                    </div>\n    51→                </div>\n    52→            </div>\n    53→        `;\n    54→    } else {\n    55→        return `\n    56→            <div class=\"modal-header position-relative px-0 border-0\">\n    57→                <div class=\"col-12\">\n    58→                    <div class=\"row justify-content-center\">\n    59→                        <div class=\"col-12 text-center mt-2\">\n    60→                            ${componente.icono_header ? `<i class=\"${componente.icono_header} text-headline-2 text-gray-10\"></i>` : ''}\n    61→                        </div>\n    62→                        <div id=\"${componente.id}_label\" class=\"col-12 ${componente.titulo_header_centrado ? 'text-center' : ''} text-headline-4 text-gray-10 mt-2 mb-0\">\n    63→                            ${componente.titulo_header ? componente.titulo_header : ''}\n    64→                        </div>\n    65→                        ${componente.subtitulo_header ? `<div class=\"col-12 mt-3 text-body-2 fw-normal\" id=\"${componente.id}_subtitulo\">${componente.subtitulo_header}</div>` : ''}\n    66→                    </div>\n    67→                </div>\n    68→                <div class=\"col-auto position-absolute top-0 end-0 text-headline-4 pointer\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\n    69→                    <i class=\"bi bi-x text-gray-10\"></i>\n    70→                </div>\n    71→            </div>\n    72→        `;\n    73→    }\n    74→}\n    75→\n    76→/**\n    77→ * Crear un modal footer\n    78→ * \n    79→ * @param {object} componente Componente de modal.\n    80→ * @returns {string} Footer de modal.\n    81→ * @author José Manuel Jiménez\n    82→ * @author Andres Gonzalez\n    83→ */\n    84→function crearModalFooter(componente) {\n    85→    return `\n    86→        <div class=\"row m-0 w-100 ${componente.clase_footer ? componente.clase_footer : ''}\">\n    87→            ${componente.boton_footer1 ? `\n    88→                <button\n    89→                    ${componente.boton_footer1.type ? `type=\"${componente.boton_footer1.type}\"` : 'button'}\n    90→                    ${componente.boton_footer1.id ? `id=\"${componente.boton_footer1.id}\"` : ''}\n    91→                    ${componente.boton_footer1.adicional ? `${componente.boton_footer1.adicional}` : ''}\n    92→                    ${componente.boton_footer1.tooltip ? `${crearTooltip({placement: `top`, content: componente.boton_footer1.tooltip ,toggle: `popover`,})}` : ''}\n    93→                    class=\"\n    94→                        col btn pt-2 mb-6 text-center d-block\n    95→                        ${componente.boton_footer1.class ? componente.boton_footer1.class : ''}\n    96→                        ${componente.boton_footer2 ? ' me-3' : ''}\"\n    97→                    ${componente.boton_footer1.cerrar_modal ? 'data-bs-dismiss=\"modal\" aria-label=\"Close\"' : '' }\n    98→                    ${componente.boton_footer1.onclick ? `onclick=\"${componente.boton_footer1.onclick}\"` : ''}>\n    99→                    ${componente.boton_footer1.texto}\n   100→                </button>`: ''\n   101→            }\n   102→            ${componente.boton_footer2 ? `\n   103→                <button\n   104→                    ${componente.boton_footer2.type ? `type=\"${componente.boton_footer2.type}\"` : 'button'}\n   105→                    ${componente.boton_footer2.id ? `id=\"${componente.boton_footer2.id}\"` : ''}\n   106→                    ${componente.boton_footer2.adicional ? `${componente.boton_footer2.adicional}` : ''}\n   107→                    ${componente.boton_footer2.tooltip ? `${crearTooltip({placement: `top`, content: componente.boton_footer2.tooltip ,toggle: `popover`,})}` : ''}\n   108→                    ${componente.boton_footer2.form ? `form=\"${componente.boton_footer2.form}\"` : ''}\n   109→                    ${componente.boton_footer2.disabled ? 'disabled' : ''}\n   110→                    class=\"\n   111→                        col btn pt-2 mb-6 text-center d-block\n   112→                        ${componente.boton_footer2.class ? componente.boton_footer2.class : ''}\n   113→                        ${componente.boton_footer1 ? ' ms-3' : ''}\"\n   114→                    ${componente.boton_footer2.cerrar_modal ? 'data-bs-dismiss=\"modal\" aria-label=\"Close\"' : '' }\n   115→                    ${componente.boton_footer2.onclick ? `onclick=\"${componente.boton_footer2.onclick}\"` : ''}>\n   116→                    ${componente.boton_footer2.texto}\n   117→                </button>` : ''\n   118→            }\n   119→        </div>\n   120→    `;\n   121→}\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"a947c069-5efc-49f8-8557-f391d07c25b0","timestamp":"2026-01-29T14:25:52.820Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\componentes\\componentes\\modal.js","content":"/**\n * Crear un modal\n * \n * @param {object} componente Componente de modal.\n * @returns {string} Componente de modal.\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction crearModal(componente) {\n    return `\n        <div id=\"${componente.id}\" class=\"modal fade ${componente.modals_header_class ? componente.modals_header_class : ''}\" data-bs-focus=\"false\" ${componente.adiconales_modals_header ? `${componente.adiconales_modals_header}` : ''}>\n            <div class=\"modal-dialog ${componente.dialog_class ? componente.dialog_class : ''}\">\n                <div class=\"modal-content shadow-1 rounded-4 px-6 ${componente.content_class ? componente.content_class : ''} pt-4\">\n                    ${crearModalHeader(componente)}\n                    <div class=\"modal-body ${componente.modal_body_class ? componente.modal_body_class : ''}\">\n                        <div class=\"row\">\n                            ${componente.modal_body ? componente.modal_body : ''}\n                        </div>\n                    </div>\n                    ${crearModalFooter(componente)}\n                </div>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Crear un modal header\n * \n * @param {object} componente Componente de modal.\n * @returns {string} Header de modal.\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction crearModalHeader(componente) {\n    if (!componente.icono_header) {\n        return `\n            <div class=\"modal-header border-0 px-0 ${componente.header_class ? componente.header_class : ''}\">\n                <div class=\"col-12\">\n                    <div class=\"row justify-content-between align-items-center\">\n                        <div class=\"col-auto text-headline-4 text-gray-10 mb-0\" id=\"${componente.id}_label\">${componente.titulo_header}</div>\n                        <div class=\"col-auto text-headline-4 pointer ${componente.header_cerrar ? componente.header_cerrar : '' }\" ${componente.adiconales_cerrar_modal_header ? componente.adiconales_cerrar_modal_header : `data-bs-dismiss=\"modal\" aria-label=\"Close\"`} ${crearTooltip({\n                            placement: `top`,\n                            content: `Cerrar`,\n                            toggle: `popover`,\n                        })}>\n                            <i class=\"bi bi-x text-gray-10\"></i>\n                        </div>\n                        ${componente.subtitulo_header ? `<div id=\"${componente.id}_subtitulo\" class=\"col-12 mt-3 text-body-2 fw-normal\">${componente.subtitulo_header}</div>` : ''}\n                    </div>\n                </div>\n            </div>\n        `;\n    } else {\n        return `\n            <div class=\"modal-header position-relative px-0 border-0\">\n                <div class=\"col-12\">\n                    <div class=\"row justify-content-center\">\n                        <div class=\"col-12 text-center mt-2\">\n                            ${componente.icono_header ? `<i class=\"${componente.icono_header} text-headline-2 text-gray-10\"></i>` : ''}\n                        </div>\n                        <div id=\"${componente.id}_label\" class=\"col-12 ${componente.titulo_header_centrado ? 'text-center' : ''} text-headline-4 text-gray-10 mt-2 mb-0\">\n                            ${componente.titulo_header ? componente.titulo_header : ''}\n                        </div>\n                        ${componente.subtitulo_header ? `<div class=\"col-12 mt-3 text-body-2 fw-normal\" id=\"${componente.id}_subtitulo\">${componente.subtitulo_header}</div>` : ''}\n                    </div>\n                </div>\n                <div class=\"col-auto position-absolute top-0 end-0 text-headline-4 pointer\" data-bs-dismiss=\"modal\" aria-label=\"Close\">\n                    <i class=\"bi bi-x text-gray-10\"></i>\n                </div>\n            </div>\n        `;\n    }\n}\n\n/**\n * Crear un modal footer\n * \n * @param {object} componente Componente de modal.\n * @returns {string} Footer de modal.\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction crearModalFooter(componente) {\n    return `\n        <div class=\"row m-0 w-100 ${componente.clase_footer ? componente.clase_footer : ''}\">\n            ${componente.boton_footer1 ? `\n                <button\n                    ${componente.boton_footer1.type ? `type=\"${componente.boton_footer1.type}\"` : 'button'}\n                    ${componente.boton_footer1.id ? `id=\"${componente.boton_footer1.id}\"` : ''}\n                    ${componente.boton_footer1.adicional ? `${componente.boton_footer1.adicional}` : ''}\n                    ${componente.boton_footer1.tooltip ? `${crearTooltip({placement: `top`, content: componente.boton_footer1.tooltip ,toggle: `popover`,})}` : ''}\n                    class=\"\n                        col btn pt-2 mb-6 text-center d-block\n                        ${componente.boton_footer1.class ? componente.boton_footer1.class : ''}\n                        ${componente.boton_footer2 ? ' me-3' : ''}\"\n                    ${componente.boton_footer1.cerrar_modal ? 'data-bs-dismiss=\"modal\" aria-label=\"Close\"' : '' }\n                    ${componente.boton_footer1.onclick ? `onclick=\"${componente.boton_footer1.onclick}\"` : ''}>\n                    ${componente.boton_footer1.texto}\n                </button>`: ''\n            }\n            ${componente.boton_footer2 ? `\n                <button\n                    ${componente.boton_footer2.type ? `type=\"${componente.boton_footer2.type}\"` : 'button'}\n                    ${componente.boton_footer2.id ? `id=\"${componente.boton_footer2.id}\"` : ''}\n                    ${componente.boton_footer2.adicional ? `${componente.boton_footer2.adicional}` : ''}\n                    ${componente.boton_footer2.tooltip ? `${crearTooltip({placement: `top`, content: componente.boton_footer2.tooltip ,toggle: `popover`,})}` : ''}\n                    ${componente.boton_footer2.form ? `form=\"${componente.boton_footer2.form}\"` : ''}\n                    ${componente.boton_footer2.disabled ? 'disabled' : ''}\n                    class=\"\n                        col btn pt-2 mb-6 text-center d-block\n                        ${componente.boton_footer2.class ? componente.boton_footer2.class : ''}\n                        ${componente.boton_footer1 ? ' ms-3' : ''}\"\n                    ${componente.boton_footer2.cerrar_modal ? 'data-bs-dismiss=\"modal\" aria-label=\"Close\"' : '' }\n                    ${componente.boton_footer2.onclick ? `onclick=\"${componente.boton_footer2.onclick}\"` : ''}>\n                    ${componente.boton_footer2.texto}\n                </button>` : ''\n            }\n        </div>\n    `;\n}","numLines":121,"startLine":1,"totalLines":121}},"sourceToolAssistantUUID":"a4f0b92d-a670-43fd-b3f3-05f08114afa4"}
{"parentUuid":"172df0db-d03a-4fc0-9315-4487c038b4e9","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Kb9YfjeAZmZp6RYu4ssWwa","type":"tool_result","content":"     1→@extends('layouts.app')\n     2→\n     3→@section('titulo', 'Procesos')\n     4→\n     5→@section('contenido')\n     6→    ${contenedorPrincipal({\n     7→        cabecera: `\n     8→            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n     9→            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n    10→                ${crearTag({\n    11→                    texto: 'Cargando créditos...',\n    12→                    class: 'tag-tonal-blue'\n    13→                })}\n    14→            </div>\n    15→        `,\n    16→        contenido: `\n    17→            <div class=\"card shadow-none\">\n    18→                <div id=\"cabecera-pagina-sin-archivar\">\n    19→                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'procesos'])\n    20→                </div>\n    21→                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n    22→                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Procesos archivados</div>\n    23→                </div>\n    24→                <div class=\"card-body\">\n    25→                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n    26→                        <div class=\"w-100 text-center p-10\">\n    27→                            <p class=\"\"><i class=\"bi bi-clipboard-check text-gray-60\" style=\"font-size: 118px;\"></i></p>\n    28→                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes procesos por ahora, crea el primero para comenzar.</p>\n    29→                            <p class=\"pb-4 \">\n    30→                                ${crearBoton({\n    31→                                    clases: 'btn-primary',\n    32→                                    url: '/procesos/create',\n    33→                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear proceso'\n    34→                                })}\n    35→                            </p>\n    36→                        </div>\n    37→                    </div>\n    38→                    <div id=\"tabla-contenido\">\n    39→                        @include('procesos.secciones.listado-procesos')\n    40→                    </div>\n    41→                </div>\n    42→            </div>\n    43→        `\n    44→    })}\n    45→@endsection\n    46→\n    47→@section('modals')\n    48→    @include('procesos.modales.modal-agregar-participantes')\n    49→\n    50→    @include('procesos.modales.modal-compartir-proceso')\n    51→\n    52→    @include('procesos.modales.modal-duplicar')\n    53→\n    54→    @include('procesos.modales.modal-eliminar')\n    55→\n    56→    @include('procesos.modales.modal-agendamiento-masivo')\n    57→@endsection\n    58→\n    59→@section('scripts')\n    60→    <script type=\"text/javascript\">\n    61→        const PROCESO = @json($proceso ?? []);\n    62→        const EMPRESA_ID = {{ Session::get('empresa_id') ?? 'null' }};\n    63→    </script>\n    64→\n    65→    <script src=\"{{ asset('js/procesos/procesos.js') }}\" type=\"text/javascript\"></script>\n    66→    <script src=\"{{ asset('js/procesos/listado.js') }}\" type=\"text/javascript\"></script>\n    67→@endsection\n    68→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"d9288bd8-f981-41cc-bca1-f663e1740407","timestamp":"2026-01-29T14:25:52.821Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\resources\\views\\procesos\\index.blade.php","content":"@extends('layouts.app')\n\n@section('titulo', 'Procesos')\n\n@section('contenido')\n    ${contenedorPrincipal({\n        cabecera: `\n            <div class=\"col-auto text-headline-2 text-gray-30 fw-bold\">Producto selección</div>\n            <div class=\"col-auto ps-2 pe-0 my-auto\" id=\"contenedor-tag-creditos\">\n                ${crearTag({\n                    texto: 'Cargando créditos...',\n                    class: 'tag-tonal-blue'\n                })}\n            </div>\n        `,\n        contenido: `\n            <div class=\"card shadow-none\">\n                <div id=\"cabecera-pagina-sin-archivar\">\n                    @include('componentes.menu-superior', ['rutas' => $rutas_menu->where('slug', 'productos-servicios')->first()?->rutas, 'activo' => 'procesos'])\n                </div>\n                <div id=\"cabecera-pagina-con-archivar\" class=\"d-none\">\n                    <div class=\"col-auto text-headline-4 text-gray-30 fw-semibold pt-4 px-5\">Procesos archivados</div>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"d-none\" id=\"tabla-sin-contenido\">\n                        <div class=\"w-100 text-center p-10\">\n                            <p class=\"\"><i class=\"bi bi-clipboard-check text-gray-60\" style=\"font-size: 118px;\"></i></p>\n                            <p class=\"pb-4 text-headline-5 fw-bold text-gray-30\">No tienes procesos por ahora, crea el primero para comenzar.</p>\n                            <p class=\"pb-4 \">\n                                ${crearBoton({\n                                    clases: 'btn-primary',\n                                    url: '/procesos/create',\n                                    texto: '<i class=\"bi bi-plus-lg me-2\"></i> Crear proceso'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                    <div id=\"tabla-contenido\">\n                        @include('procesos.secciones.listado-procesos')\n                    </div>\n                </div>\n            </div>\n        `\n    })}\n@endsection\n\n@section('modals')\n    @include('procesos.modales.modal-agregar-participantes')\n\n    @include('procesos.modales.modal-compartir-proceso')\n\n    @include('procesos.modales.modal-duplicar')\n\n    @include('procesos.modales.modal-eliminar')\n\n    @include('procesos.modales.modal-agendamiento-masivo')\n@endsection\n\n@section('scripts')\n    <script type=\"text/javascript\">\n        const PROCESO = @json($proceso ?? []);\n        const EMPRESA_ID = {{ Session::get('empresa_id') ?? 'null' }};\n    </script>\n\n    <script src=\"{{ asset('js/procesos/procesos.js') }}\" type=\"text/javascript\"></script>\n    <script src=\"{{ asset('js/procesos/listado.js') }}\" type=\"text/javascript\"></script>\n@endsection\n","numLines":68,"startLine":1,"totalLines":68}},"sourceToolAssistantUUID":"172df0db-d03a-4fc0-9315-4487c038b4e9"}
{"parentUuid":"d9288bd8-f981-41cc-bca1-f663e1740407","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01XJ1SWmmKTo6c14asSg18w4","toolUseID":"toolu_01XJ1SWmmKTo6c14asSg18w4","timestamp":"2026-01-29T14:25:52.826Z","uuid":"3f5988c9-3179-4bc2-b10a-5623e9c6706a"}
{"parentUuid":"3f5988c9-3179-4bc2-b10a-5623e9c6706a","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01Kb9YfjeAZmZp6RYu4ssWwa","toolUseID":"toolu_01Kb9YfjeAZmZp6RYu4ssWwa","timestamp":"2026-01-29T14:25:52.826Z","uuid":"d689cf53-e855-4e2f-9f8e-b11d80f36f77"}
{"parentUuid":"e9c1cc60-d59f-42ed-902c-6557a89876b5","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Jf2dW8eGj7LbwxiaF7btV8","type":"tool_result","content":"     1→// Mensajes en español para el plugin Select2\n     2→const mensajes_select2 = {\n     3→    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n     4→    'searching'              : () => { return 'Buscando...'; },\n     5→    'Loading'                : () => { return 'Cargando...'; },\n     6→    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n     7→    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n     8→    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n     9→    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    10→    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    11→    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    12→    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    13→    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    14→    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    15→    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    16→    'allowClear'             : () => { return 'Borrar selección'; },\n    17→    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    18→    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    19→    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    20→    'matches'                : (coincidencias, total) => {\n    21→        if (coincidencias === 0) {\n    22→            return 'No hay coincidencias.';\n    23→        } else if (coincidencias === 1) {\n    24→            return 'Se encontró 1 coincidencia.';\n    25→        } else {\n    26→            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n    27→        }\n    28→    }\n    29→};\n    30→\n    31→// audios\n    32→var audio_notificacion = new Audio('/audios/notificacion.mp3');\n    33→\n    34→let mostro_modal_creditos_ia = false;\n    35→let funcion_ejecucion_ia = null;\n    36→let modals_abiertos_ia = null;\n    37→\n    38→let funcionalidades_disponibles_empresa = [];\n    39→\n    40→/**\n    41→ * Mostrar modal de créditos IA\n    42→ *\n    43→ * @return void\n    44→ * @author José Manuel Jiménez\n    45→ */\n    46→function mostrarModalCreditosIA(servicio_ia_id) {\n    47→    $.ajax({\n    48→        url: `/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n    49→        method: 'GET',\n    50→        dataType: 'json',\n    51→        success: function(respuesta_empresa) {\n    52→            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n    53→                $.ajax({\n    54→                    url: `/servicios-ia/${servicio_ia_id}/creditos`,\n    55→                    method: 'GET',\n    56→                    dataType: 'json',\n    57→                    success: function(respuesta) {\n    58→                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n    59→                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n    60→                            $('#modal-consumo-creditos-ia').modal('show');\n    61→                            mostro_modal_creditos_ia = true;\n    62→                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n    63→                            $(modals_abiertos_ia).addClass('d-none');\n    64→                        } else {\n    65→                            mostrarToastSolicitarCreditosIA();\n    66→                        }\n    67→                    }\n    68→                });\n    69→            } else {\n    70→                mostrarToastSolicitarCreditosIA();\n    71→            }\n    72→        }\n    73→    });\n    74→}\n    75→\n    76→/**\n    77→ * Mostrar toast para solicitar créditos IA\n    78→ *\n    79→ * @return void\n    80→ * @author José Manuel Jiménez\n    81→ */\n    82→function mostrarToastSolicitarCreditosIA() {\n    83→    $.ajax({\n    84→        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n    85→        method: 'GET',\n    86→        dataType: 'json',\n    87→        success: function(respuesta) {\n    88→            let adicional_toast = '';\n    89→            if (respuesta?.data?.ejecutivo?.telefono) {\n    90→                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n    91→                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n    92→                </a>`;\n    93→            }\n    94→            setTimeout(() => {\n    95→                $('#modal-generando-ia').modal('hide');\n    96→                $('#modal-cargue-ia').modal('hide');\n    97→                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n    98→            }, 300);\n    99→        }\n   100→    });\n   101→}\n   102→\n   103→/**\n   104→ * Continuar ejecución IA luego del modal de créditos\n   105→ *\n   106→ * @return void\n   107→ * @author José Manuel Jiménez\n   108→ */\n   109→function continuarEjecucionIA() {\n   110→    if (funcion_ejecucion_ia) {\n   111→        funcion_ejecucion_ia();\n   112→        funcion_ejecucion_ia = null;\n   113→    }\n   114→    mostro_modal_creditos_ia = false;\n   115→    $('#modal-consumo-creditos-ia').modal('hide');\n   116→}\n   117→\n   118→/**\n   119→ * Solicitar más créditos IA\n   120→ *\n   121→ * @return void\n   122→ * @author José Manuel Jiménez\n   123→ */\n   124→function solicitarMasCreditosIA() {\n   125→    $.ajax({\n   126→        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n   127→        method: 'GET',\n   128→        dataType: 'json',\n   129→        success: function(respuesta) {\n   130→            if (respuesta?.data?.ejecutivo?.telefono) {\n   131→                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n   132→            } else {\n   133→                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n   134→            }\n   135→            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n   136→        }\n   137→    });\n   138→}\n   139→\n   140→/**\n   141→ * Validar respuesta de créditos IA\n   142→ *\n   143→ * @return void\n   144→ * @author José Manuel Jiménez\n   145→ */\n   146→function validarRespuestaCreditosIA(error_ia) {\n   147→    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n   148→        mostrarToastSolicitarCreditosIA();\n   149→        return true;\n   150→    }\n   151→    return false;\n   152→}\n   153→\n   154→/**\n   155→ * Ajustar el ancho de los elementos select2 asincrono multiple.\n   156→ *\n   157→ * @returns {void}\n   158→ * @author Andres Morales\n   159→ */\n   160→$(document).ready(function () {\n   161→    cargarNotificiacionesHeader();\n   162→    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n   163→        configurarWebSocketNotificaciones();\n   164→    }\n   165→    setTimeout(() => {\n   166→        $(\".input-container\").each(function () {\n   167→            let $container = $(this);\n   168→            let $select = $container.find(\"select[multiple]\");\n   169→            let $icon = $container.find(\".input-icono1\");\n   170→            if ($select.length && $icon.length) {\n   171→                $(this).find('.select2-selection--multiple').addClass('ps-5')\n   172→            }\n   173→        });\n   174→    }, 1000);\n   175→    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n   176→        if (mostro_modal_creditos_ia) {\n   177→            $(modals_abiertos_ia).removeClass('d-none');\n   178→        }\n   179→        mostro_modal_creditos_ia = false;\n   180→    });\n   181→\n   182→    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n   183→    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n   184→        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n   185→    }\n   186→});\n   187→\n   188→/**\n   189→ * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n   190→ *\n   191→ * @param {string} fecha_entrada fecha en formato ISO\n   192→ * @returns {string} fecha y hora formateada\n   193→ * @author Andres Morales\n   194→ */\n   195→function formatearFecha(fecha_entrada) {\n   196→    var fecha = new Date(fecha_entrada);\n   197→    var dia = fecha.getDate();\n   198→    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n   199→    var anio = fecha.getFullYear();\n   200→    let hora = fecha.getHours();\n   201→    let minuto = fecha.getMinutes();\n   202→    let ampm = hora >= 12 ? 'PM' : 'AM';\n   203→    hora = hora % 12 || 12;\n   204→    minuto = minuto.toString().padStart(2, '0');\n   205→    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n   206→}\n   207→\n   208→function formatearFecha2(fecha_entrada) {\n   209→    let partes = fecha_entrada.split(' ');\n   210→    let fecha = partes[0].split('-');\n   211→    let hora = partes[1];\n   212→    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n   213→\n   214→    let date = new Date(fechaISO);\n   215→\n   216→    if (isNaN(date.getTime())) {\n   217→        return 'Fecha inválida';\n   218→    }\n   219→\n   220→    let dia = date.getDate();\n   221→    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n   222→    let anio = date.getFullYear();\n   223→    return `${dia}/${mes}/${anio}`;\n   224→}\n   225→\n   226→/**\n   227→ * Opción para contraer o agrandar el menú principal\n   228→ *\n   229→ * @returns {void}\n   230→ * @author José Manuel Jiménez\n   231→ * @author Andres Morales\n   232→ */\n   233→function contraerMenu() {\n   234→    if ($('.sidebar-menu').hasClass('close')) {\n   235→        $('.sidebar-menu').removeClass('d-none');\n   236→        localStorage.setItem('opcion_menu_storage', 'abierto');\n   237→        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n   238→        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n   239→        $(\".menu-bar\").each(function() {\n   240→            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n   241→        });\n   242→        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n   243→        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n   244→            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n   245→            if (tooltip_instancia) {\n   246→                tooltip_instancia.dispose();\n   247→            }\n   248→        });\n   249→    } else {\n   250→        $('.sidebar-menu').addClass('d-none');\n   251→        localStorage.setItem('opcion_menu_storage', 'cerrado');\n   252→        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n   253→        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n   254→        $(\".menu-bar\").each(function() {\n   255→            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n   256→        });\n   257→        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n   258→    }\n   259→    $('.tooltip.bs-tooltip-auto').remove();\n   260→    $('.sidebar-menu').toggleClass('close');\n   261→    $('.contenedor-vista').toggleClass('close');\n   262→    $('#btn-collapse').toggleClass('close');\n   263→    $('.nombre-usuario-empresa').toggle();\n   264→    $('.menu-bar .text-menu').toggle();\n   265→}\n   266→\n   267→/**\n   268→ * Opción para abrir o cerrar el menu segun la elección guardada\n   269→ *\n   270→ * @returns {void}\n   271→ * @author José Manuel Jiménez\n   272→ * @author Andres Morales\n   273→ */\n   274→function mostrarMenuStorage() {\n   275→    $(document).ready(function() {\n   276→        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n   277→            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n   278→            if (tooltip_instancia) {\n   279→                tooltip_instancia.dispose();\n   280→            }\n   281→        });\n   282→\n   283→        if (window.innerWidth < 768) {\n   284→            localStorage.setItem('opcion_menu_storage', 'cerrado');\n   285→        }\n   286→\n   287→        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n   288→            contraerMenu();\n   289→        }\n   290→        let $active = $('.menu-bar .active');\n   291→\n   292→        if ($active.length) {\n   293→            $('.menu-bar').scrollTop($active.position().top);\n   294→        }\n   295→    });\n   296→}\n   297→mostrarMenuStorage();\n   298→\n   299→/**\n   300→ * Funcion para hacer el slug de un texto desde jquery.\n   301→ *\n   302→ * @returns {void}\n   303→ * @author Andres Morales\n   304→ */\n   305→function slugify(text) {\n   306→    return $.trim(text)\n   307→        .toLowerCase()\n   308→        .normalize(\"NFD\")\n   309→        .replace(/[\\u0300-\\u036f]/g, \"\")\n   310→        .replace(/[^a-z0-9 -]/g, \"\")\n   311→        .replace(/\\s+/g, \"-\")\n   312→        .replace(/-+/g, \"-\");\n   313→}\n   314→\n   315→/**\n   316→ * Función generica para mostrar mensajes de respuesta\n   317→ *\n   318→ * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n   319→ * @param {string} texto_1 Texto que mostrara la alerta.\n   320→ * @param {string} texto_2 Texto secundario en la alerta.\n   321→ * @param {string} accion Acción adicional(por definir).\n   322→ * @returns {void}\n   323→ * @author José Manuel Jiménez\n   324→ * @author Andres Gonzalez\n   325→ */\n   326→function mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n   327→    let icono = '';\n   328→    let texto_color = 'text-white';\n   329→    if (accion != '') {\n   330→        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n   331→    }\n   332→\n   333→    if (tipo_alerta == 'success') {\n   334→        icono = 'bi bi-check-circle';\n   335→    }\n   336→\n   337→    if (tipo_alerta == 'neutral') {\n   338→        icono = 'bi bi-info-circle';\n   339→    }\n   340→\n   341→    if (tipo_alerta == 'warning') {\n   342→        icono = 'bi bi-info-circle';\n   343→        texto_color = \"text-red-letras\";\n   344→    }\n   345→\n   346→    if (tipo_alerta == 'danger') {\n   347→        icono = 'bi bi-x-circle';\n   348→    }\n   349→\n   350→    if (icono2 != '') {\n   351→        icono = icono2;\n   352→    }\n   353→\n   354→    if (texto_2 != '') {\n   355→        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n   356→    }\n   357→\n   358→    let alert_toast = $(`\n   359→        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n   360→            <div class=\"col-auto\">\n   361→                <span class=\"${icono} ${texto_color}\"></span>\n   362→            </div>\n   363→            <div class=\"col px-3\">\n   364→                <div class=\"row m-0 ${texto_color}\">\n   365→                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n   366→                        ${texto_1}\n   367→                    </div>\n   368→                    ${texto_2}\n   369→                </div>\n   370→            </div>\n   371→            ${accion}\n   372→            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n   373→                <span class=\"bi bi-x ${texto_color}\"></span>\n   374→            </div>\n   375→        </div>\n   376→    `);\n   377→    $('#contenedor-alert-toast').append(alert_toast);\n   378→    alert_toast.fadeIn();\n   379→    setTimeout(function() {\n   380→        alert_toast.fadeOut();\n   381→        alert_toast.alert('close');\n   382→    }, 5000);\n   383→}\n   384→\n   385→/**\n   386→ * Formatear número.\n   387→ *\n   388→ * @param {number} numero número a formatear\n   389→ * @author Andres Morales\n   390→ */\n   391→function formatearNumero(numero) {\n   392→    return parseInt(numero).toLocaleString('es-ES');\n   393→}\n   394→\n   395→/**\n   396→ * Formatear fecha.\n   397→ *\n   398→ * @param {*} fecha Fecha a formatear.\n   399→ * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n   400→ * @param {string} formato Formato en el que se retornará la fecha.\n   401→ * @param {string} separador Símbolo que se usará para separar días, meses y años.\n   402→ * @returns {Object} Objeto con la fecha y hora formateada.\n   403→ * @author Daniel Beltrán\n   404→ */\n   405→function formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n   406→    const NUEVA_FECHA = new Date(fecha);\n   407→    const ANO         = NUEVA_FECHA.getFullYear();\n   408→    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n   409→    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n   410→    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n   411→    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n   412→    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n   413→\n   414→    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n   415→\n   416→    if (formato === 'dmY') {\n   417→        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n   418→    }\n   419→\n   420→    return {\n   421→        fecha: fecha_formateada,\n   422→        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n   423→    };\n   424→}\n   425→\n   426→/**\n   427→ * Formatear fecha a May. 2023.\n   428→ *\n   429→ * @param {string} fechaISO Fecha a formatear.\n   430→ * @returns {string} Objeto con la fecha y hora formateada.\n   431→ * @author Andres Morales\n   432→ */\n   433→function formatearFechaAnioMes(fechaISO) {\n   434→    const fecha = new Date(fechaISO);\n   435→    const opciones = { month: 'short', year: 'numeric' };\n   436→    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n   437→\n   438→    fecha_formateada = fecha_formateada.replace(\n   439→        /^([a-zñ]+)(\\s\\d{4})$/,\n   440→        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n   441→    );\n   442→\n   443→    return fecha_formateada;\n   444→}\n   445→\n   446→/**\n   447→ * Formatear un numero a moneda.\n   448→ *\n   449→ * @param {string} valor Numero.\n   450→ * @returns {string} Numero formateado.\n   451→ * @author Andres Morales\n   452→ */\n   453→function formatearMonedaCOP(valor) {\n   454→    return new Intl.NumberFormat('es-CO', {\n   455→        style: 'currency',\n   456→        currency: 'COP',\n   457→        minimumFractionDigits: 0,\n   458→        maximumFractionDigits: 0\n   459→    }).format(valor);\n   460→}\n   461→\n   462→/**\n   463→ * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n   464→ *\n   465→ * @param {*} fecha_inicial Fecha a formatear.\n   466→ * @returns {String} String con la fecha y hora formateada.\n   467→ * @author José Manuel Jiménez\n   468→ */\n   469→function fechaMostrar(fecha_inicial) {\n   470→    if (!fecha_inicial) {\n   471→        return \"\";\n   472→    }\n   473→    const fecha = new Date(fecha_inicial);\n   474→    if (isNaN(fecha.getTime())) {\n   475→        return \"\";\n   476→    }\n   477→    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n   478→    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n   479→    const anio = fecha.getUTCFullYear();\n   480→    // Verificar si el string incluye información de hora (espacio, T, o dos puntos)\n   481→    if (!fecha_inicial.includes(\" \") && !fecha_inicial.includes(\"T\") && !fecha_inicial.includes(\":\")) {\n   482→        return `${dia}/${mes}/${anio}`;\n   483→    }\n   484→    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n   485→    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n   486→    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n   487→    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n   488→}\n   489→\n   490→/**\n   491→ * Descargar Excel.\n   492→ *\n   493→ * @param {string} ruta Ruta desde donde se descarga el archivo.\n   494→ * @param {string} nombre_archivo Nombre del archivo descargado.\n   495→ * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n   496→ * @param {Object} parametros Parámetros a enviar en la petición.\n   497→ * @returns {void}\n   498→ * @author Daniel Beltrán\n   499→ */\n   500→async function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n   501→    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n   502→\n   503→    await $.ajax({\n   504→        type     : 'POST',\n   505→        url      : `/${ruta}`,\n   506→        data     : parametros,\n   507→        xhrFields: {\n   508→            responseType: 'blob'\n   509→        },\n   510→        success: function (respuesta) {\n   511→            // Crear una URL para el Blob\n   512→            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n   513→            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n   514→            a.href  = url;\n   515→            const fecha_actual     = new Date();\n   516→            const dia              = fecha_actual.getDate();\n   517→            const mes              = fecha_actual.getMonth() + 1;\n   518→            const ano              = fecha_actual.getFullYear();\n   519→            const hora             = fecha_actual.getHours();\n   520→            const minutos          = fecha_actual.getMinutes();\n   521→            const segundos         = fecha_actual.getSeconds();\n   522→            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n   523→\n   524→            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n   525→            document.body.appendChild(a);\n   526→            a.click();\n   527→            window.URL.revokeObjectURL(url);\n   528→            document.body.removeChild(a);\n   529→        }\n   530→    }).then(() => {\n   531→        mostrarToast('success', 'Archivo descargado correctamente.');\n   532→    }).catch((error) => {\n   533→        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n   534→    });\n   535→}\n   536→\n   537→/**\n   538→ * Convierte un string a slug.\n   539→ *\n   540→ * @param {string} str\n   541→ * @returns {string}\n   542→ * @author Fahibram Cárcamo\n   543→ */\n   544→function slug(str) {\n   545→\n   546→    // Quita espacios en blanco\n   547→    str = str.replace(/^\\s+|\\s+$/g, \"\")\n   548→\n   549→    // Convierte el string a minusculas\n   550→    str = str.toLowerCase()\n   551→\n   552→    // Quita los caracteres no alfanuméricos\n   553→    str = str.replace(/[^a-z0-9 -]/g, \"\")\n   554→\n   555→    // Reemplaza los espacio con guiones\n   556→    str = str.replace(/\\s+/g, \"-\")\n   557→\n   558→    // Remueve los guiones consecutivos\n   559→    str = str.replace(/-+/g, \"-\")\n   560→\n   561→    return str\n   562→}\n   563→\n   564→/**\n   565→ * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n   566→ * (Este función está pensada para comparar arreglos unidimensionales).\n   567→ *\n   568→ * @param {array} primer_arreglo\n   569→ * @param {array} segundo_arreglo\n   570→ * @param {boolean} comparar_orden\n   571→ * @return {boolean}\n   572→ * @author Fahibram Cárcamo\n   573→ */\n   574→function sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n   575→\n   576→    if (!comparar_orden) {\n   577→        primer_arreglo.sort()\n   578→        segundo_arreglo.sort()\n   579→    }\n   580→\n   581→    if (primer_arreglo.length !== segundo_arreglo.length) return false\n   582→\n   583→    for (let i = 0; i < primer_arreglo.length; i++) {\n   584→        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n   585→    }\n   586→\n   587→    return true\n   588→}\n   589→\n   590→/**\n   591→ * Función para cambiar de empresa.\n   592→ *\n   593→ * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n   594→ * @returns {void}\n   595→ * @author José Manuel Jiménez\n   596→ * @author Daniel Beltrán\n   597→ */\n   598→function cambiarEmpresa(empresa_id) {\n   599→    $.ajax({\n   600→        type: 'POST',\n   601→        url: '/suplantar-rol-admin-general',\n   602→        data: {\n   603→            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n   604→            empresa_id: empresa_id\n   605→        },\n   606→        success: function (respuesta) {\n   607→            localStorage.setItem('notificacionToast', JSON.stringify({\n   608→                tipo_alerta: 'success',\n   609→                texto_1    : 'Cambio de empresa exitoso'\n   610→            }));\n   611→\n   612→            window.location.reload();\n   613→        },\n   614→        error: function (error) {\n   615→            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n   616→        }\n   617→    });\n   618→}\n   619→\n   620→/**\n   621→ * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n   622→ *\n   623→ * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n   624→ * @param {string} url URL de suplantación.\n   625→ * @param {string} _token Token CSRF del formulario.\n   626→ * @param {number} empresa_id Id de la empresa a suplantar.\n   627→ * @param {number|null} rol_id Id del rol a suplantar.\n   628→ * @param {function|null} callback_error Callback ejecutado en caso de error.\n   629→ * @returns {void}\n   630→ * @author Fahibram Cárcamo\n   631→ */\n   632→async function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n   633→\n   634→    let condicion_suplantacion = rol_id === null\n   635→        ? empresa_id === null\n   636→            ? true\n   637→            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n   638→        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n   639→\n   640→    if (condicion_suplantacion) {\n   641→        let data = { _token };\n   642→        if (empresa_id !== null) data.empresa_id = empresa_id;\n   643→        if (rol_id !== null) data.rol_id = rol_id;\n   644→\n   645→        await $.ajax({ type: 'POST', url, data })\n   646→            .then((respuesta, status, xhr) => {\n   647→                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n   648→            })\n   649→            .catch(error => {\n   650→                let swal_titulo, swal_texto;\n   651→\n   652→                if (error.status === 404) {\n   653→                    if (error.responseJSON.mensaje) {\n   654→                        swal_titulo = 'Algo salió mal';\n   655→                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n   656→                            swal_texto = 'El rol no existe.';\n   657→                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n   658→                            swal_texto = 'La empresa no existe.';\n   659→                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n   660→                            swal_texto = 'El usuario no existe.';\n   661→                        } else {\n   662→                            swal_texto = '';\n   663→                        }\n   664→                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n   665→                        swal_titulo = 'No fué posible cambiar de empresa';\n   666→                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n   667→                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n   668→                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n   669→                    } else {\n   670→                        swal_titulo = 'Algo salió mal';\n   671→                        swal_texto = error.responseJSON.errors;\n   672→                    }\n   673→                } else {\n   674→                    swal_titulo = 'Algo salió mal';\n   675→                    swal_texto = '';\n   676→                }\n   677→\n   678→                if (callback_error !== null) callback_error();\n   679→\n   680→                Swal.fire({\n   681→                    title: swal_titulo,\n   682→                    text: swal_texto,\n   683→                    icon: \"error\",\n   684→                    confirmButtonText: \"Aceptar\"\n   685→                });\n   686→            });\n   687→    }\n   688→}\n   689→\n   690→/**\n   691→ * Mostrar tooltip según el div que lo contenga.\n   692→ *\n   693→ * @param {div} div Elemento en donde se va a mostrar el tooltip.\n   694→ * @returns {void}\n   695→ * @author Sol Espitia\n   696→ */\n   697→function mostrarTooltip(div) {\n   698→    const TOOLTIP         = div.querySelector('.tooltip-x');\n   699→    TOOLTIP.style.display = 'block';\n   700→}\n   701→\n   702→/**\n   703→ * Ocultar tooltip según el div que lo contenga.\n   704→ *\n   705→ * @param {div} div Elemento en donde se va a mostrar el tooltip.\n   706→ * @returns {void}\n   707→ * @author Sol Espitia\n   708→ */\n   709→function ocultarTooltip(div) {\n   710→    const TOOLTIP         = div.querySelector('.tooltip-x');\n   711→    TOOLTIP.style.display = 'none';\n   712→}\n   713→\n   714→/**\n   715→ * Retornar la diferencia en días de dos fechas dadas.\n   716→ *\n   717→ * @param {string} fecha_inicial Fecha inicial\n   718→ * @param {string} fecha_final Fecha final\n   719→ * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n   720→ * @returns {number}\n   721→ * @author Fahibram Cárcamo\n   722→ * @author Andres Morales\n   723→ */\n   724→function diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n   725→    let fecha1 = new Date(fecha_inicial);\n   726→    let fecha2 = new Date(fecha_final);\n   727→\n   728→    fecha1.setHours(0, 0, 0, 0);\n   729→    fecha2.setHours(0, 0, 0, 0);\n   730→\n   731→    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n   732→\n   733→    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n   734→    let resultado = diferencia_dias;\n   735→    if (sumar_dia) {\n   736→        resultado = diferencia_dias + 1;\n   737→    }\n   738→\n   739→    return valor_absoluto ? Math.abs(resultado) : resultado;\n   740→}\n   741→\n   742→/**\n   743→ * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n   744→ *\n   745→ * @param {string} fecha Fecha dada\n   746→ * @param {string} fecha_desde Fecha inicial del rango\n   747→ * @param {string} fecha_hasta Fecha final del rango\n   748→ * @returns {boolean}\n   749→ * @author Fahibram Cárcamo\n   750→ */\n   751→function fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n   752→    fecha = new Date(fecha);\n   753→    fecha_desde = new Date(fecha_desde);\n   754→    fecha_hasta = new Date(fecha_hasta);\n   755→\n   756→    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n   757→        throw new Error('Una o más fechas no son válidas.');\n   758→    }\n   759→\n   760→    return fecha >= fecha_desde && fecha <= fecha_hasta;\n   761→}\n   762→\n   763→/**\n   764→ * Descuenta el tiempo para las respuestas.\n   765→ *\n   766→ * @param id - ID del elemento HTML donde mostrar el tiempo\n   767→ * @param tiempo - Tiempo inicial en segundos\n   768→ * @author Jair Carvajal\n   769→ */\n   770→var tiempos_usados = {};\n   771→\n   772→function descuentoTiempo(id, tiempo, callback, onTick) {\n   773→    var $elemento = $('#' + id);\n   774→    if ($elemento.length === 0) {\n   775→        console.error('Elemento con id \"' + id + '\" no encontrado.');\n   776→        return;\n   777→    }\n   778→    if (tiempos_usados[id]) {\n   779→        clearInterval(tiempos_usados[id]);\n   780→    }\n   781→    let tiempoTotal = tiempo;\n   782→    tiempos_usados[id] = setInterval(function() {\n   783→        if (tiempo <= 0) {\n   784→            clearInterval(tiempos_usados[id]);\n   785→            delete tiempos_usados[id];\n   786→            $elemento.text('Tiempo finalizado');\n   787→            if (window.tiempoFinalizado()) {\n   788→                tiempoFinalizado();\n   789→            }\n   790→            if (typeof callback === 'function') {\n   791→                callback();\n   792→            }\n   793→            return;\n   794→        }\n   795→\n   796→        var minutos = Math.floor(tiempo / 60);\n   797→        var segundos = tiempo % 60;\n   798→\n   799→        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n   800→\n   801→        if (tiempo <= 15) {\n   802→            $elemento.addClass('text-state-red');\n   803→            $elemento.removeClass('text-state-green');\n   804→        } else {\n   805→            $elemento.addClass('text-state-green');\n   806→            $elemento.removeClass('text-state-red');\n   807→        }\n   808→\n   809→        $elemento.html(textoTiempo);\n   810→\n   811→        var tiempoUsado = tiempoTotal - tiempo;\n   812→\n   813→        if (typeof onTick === 'function') {\n   814→            onTick((tiempoUsado % 5));\n   815→        }\n   816→        tiempo--;\n   817→    }, 1000);\n   818→}\n   819→\n   820→/**\n   821→ * Detengo el tiempo para las respuestas.\n   822→ *\n   823→ * @param id - ID del elemento HTML donde mostrar el tiempo\n   824→ * @param tiempo - Tiempo inicial en segundos\n   825→ * @author Jair Carvajal\n   826→ */\n   827→function detenerDescuentoTiempo(id) {\n   828→    if (tiempos_usados[id]) {\n   829→        clearInterval(tiempos_usados[id]);\n   830→        delete tiempos_usados[id];\n   831→    }\n   832→}\n   833→\n   834→/**\n   835→ * Genera un SVG de la imagen de usuario.\n   836→ *\n   837→ * @param id ID del usuario.\n   838→ * @param nombres Nombres del usuario.\n   839→ * @param apellidos Apellidos del usuario.\n   840→ * @return image\n   841→ * @author Andres Morales\n   842→ */\n   843→function crearImagenUsuarioLetras(id, nombres, apellidos) {\n   844→    var tamano = 200;\n   845→    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n   846→    var hash = md5(id);\n   847→\n   848→    var r = parseInt(hash.substring(0, 2), 16);\n   849→    var g = parseInt(hash.substring(2, 4), 16);\n   850→    var b = parseInt(hash.substring(4, 6), 16);\n   851→    var colorFondo = `rgb(${r},${g},${b})`;\n   852→\n   853→    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n   854→    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n   855→\n   856→    // SVG como texto\n   857→    var svg = `\n   858→    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n   859→        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n   860→        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n   861→            text-anchor=\"middle\"\n   862→            font-family=\"Lato, sans-serif\"\n   863→            font-size=\"${tamano * 0.4}\"\n   864→            fill=\"${colorTexto}\">\n   865→            ${iniciales}\n   866→        </text>\n   867→    </svg>`;\n   868→    var svgEncoded = encodeURIComponent(svg)\n   869→        .replace(/'/g, \"%27\")\n   870→        .replace(/\"/g, \"%22\");\n   871→\n   872→    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n   873→    return dataUri;\n   874→}\n   875→\n   876→/**\n   877→ * Carga las notificaciones\n   878→ *\n   879→ * @return void\n   880→ * @author Andres Morales\n   881→ * @author Andres Gonzalez\n   882→ * @author Esperanza Olivo\n   883→ * @author Jair Carvajal\n   884→ */\n   885→function cargarNotificiacionesHeader() {\n   886→    $.ajax({\n   887→        url: '/usuario-notificaciones',\n   888→        type: 'GET',\n   889→        dataType: 'json',\n   890→        success: function(respuesta) {\n   891→            let datos = respuesta.data;\n   892→            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n   893→\n   894→            // Siempre remover el badge existente\n   895→            $('#dropdownNotificaciones #badge-notificaciones').remove();\n   896→\n   897→            // Solo agregar el badge si hay notificaciones no leídas\n   898→            if (notificaciones_noleidas > 0) {\n   899→                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n   900→                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n   901→\n   902→                $('#contenedor-boton-marcar-todas').html(`\n   903→                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n   904→                        Marcar todo como leído\n   905→                    </button>\n   906→                `);\n   907→            }\n   908→\n   909→            const NO_LEIDOS_IDS = new Set(Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id) : []);\n   910→\n   911→            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n   912→                $('#notificacion-sinnotificaciones').hide();\n   913→                $('.notificaciones-listado').remove();\n   914→                datos.notifications.forEach(notificacion => {\n   915→                    const { id, data, updated_at } = notificacion;\n   916→\n   917→                    const NO_LEIDO = NO_LEIDOS_IDS.has(id);\n   918→                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n   919→                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n   920→                        hour: '2-digit',\n   921→                        minute: '2-digit',\n   922→                        hour12: false\n   923→                    });\n   924→\n   925→                    const notificaciones = `\n   926→                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n   927→                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n   928→                                <div class=\"d-flex justify-content-between\">\n   929→                                    <div class=\"w-auto flex-grow-1 pe-3\">\n   930→                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n   931→                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n   932→                                    </div>\n   933→                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n   934→                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n   935→                                    </div>\n   936→                                </div>\n   937→                            </a>\n   938→                        </li>\n   939→                    `;\n   940→\n   941→                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n   942→                });\n   943→\n   944→            } else {\n   945→                $('#notificacion-sinnotificaciones').hide();\n   946→                $('.notificaciones-listado').remove();\n   947→            }\n   948→\n   949→        },\n   950→        error: function(xhr, status, error) {\n   951→            console.error('Error al cargar notificaciones:', error);\n   952→        }\n   953→    });\n   954→}\n   955→\n   956→/**\n   957→ * Marcar las notificaciones leídas.\n   958→ *\n   959→ * @param {array} notificaciones_ids ids de las notificaciones\n   960→ * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n   961→ * @returns {void}\n   962→ * @author Andres Gonzalez\n   963→ * @author Esperanza Olivo\n   964→ */\n   965→function marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n   966→\n   967→    let data = {\n   968→        _token: $('meta[name=\"csrf-token\"]').attr('content')\n   969→    };\n   970→\n   971→    if (notificaciones_ids === 'all') {\n   972→        data.marcar_todo = true;\n   973→    } else if (soporte_id) {\n   974→        data.soporte_id = soporte_id;\n   975→    } else if (notificaciones_ids) {\n   976→        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n   977→            ? notificaciones_ids\n   978→            : [notificaciones_ids];\n   979→    }\n   980→\n   981→    $.ajax({\n   982→        url: '/usuario-marcar-notificaciones-leidas',\n   983→        type: 'POST',\n   984→        data: data,\n   985→        success: function(respuesta) {\n   986→            cargarNotificiacionesHeader();\n   987→\n   988→            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n   989→                window.location.href = \"/\" + ruta_destino;\n   990→            }\n   991→\n   992→            if (notificaciones_ids === 'all') {\n   993→                $('#badge-notificaciones').remove();\n   994→                $('#contenedor-boton-marcar-todas').empty();\n   995→                $('.notificaciones-listado').addClass('bg-gray-90');\n   996→                $('.bi-circle-fill').remove();\n   997→            }\n   998→        },\n   999→        error: function(xhr, estatus, error) {\n  1000→            console.error('Error al cargar notificaciones:', error);\n  1001→        }\n  1002→    });\n  1003→}\n  1004→\n  1005→/**\n  1006→ * Configurar WebSocket para notificaciones en tiempo real\n  1007→ *\n  1008→ * @return void\n  1009→ * @author Andres Gonzalez\n  1010→ */\n  1011→function configurarWebSocketNotificaciones() {\n  1012→    try {\n  1013→        if (!window.configuracion_reverbg) {\n  1014→            return;\n  1015→        }\n  1016→\n  1017→        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n  1018→            wsHost: window.configuracion_reverbg.host,\n  1019→            wsPort: window.configuracion_reverbg.port,\n  1020→            wssPort: window.configuracion_reverbg.port,\n  1021→            cluster: 'mt1',\n  1022→            forceTLS: false,\n  1023→            enabledTransports: ['ws', 'wss'],\n  1024→            authEndpoint: '/broadcasting-auth',\n  1025→            auth: {\n  1026→                headers: {\n  1027→                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n  1028→                }\n  1029→            }\n  1030→        });\n  1031→\n  1032→        PUSHER.connection.bind('failed', function() {\n  1033→            console.error('❌ Conexión WebSocket falló');\n  1034→        });\n  1035→\n  1036→        PUSHER.connection.bind('error', function(error) {\n  1037→            console.error('❌ Error de WebSocket:', error);\n  1038→        });\n  1039→\n  1040→        let usuario_id = window.configuracion_reverbg.usuario_id;\n  1041→\n  1042→        if (!usuario_id) {\n  1043→            return;\n  1044→        }\n  1045→\n  1046→        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n  1047→        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n  1048→\n  1049→        CANAL.bind('pusher:subscription_error', function(error) {\n  1050→            console.error('❌ Error al suscribirse al canal:', error);\n  1051→        });\n  1052→\n  1053→        // Escuchar eventos específicos de notificaciones\n  1054→        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n  1055→            if (data.tipo === 'nueva_notificacion') {\n  1056→                audio_notificacion.play();\n  1057→                cargarNotificiacionesHeader();\n  1058→            }\n  1059→\n  1060→            if (data.tipo === 'nuevo_mensaje') {\n  1061→                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n  1062→                    audio_notificacion.play();\n  1063→                    consultarChat(data.soporte_id);\n  1064→                }\n  1065→            }\n  1066→        });\n  1067→    } catch (error) {\n  1068→        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n  1069→        console.error('Stack trace:', error.stack);\n  1070→    }\n  1071→}\n  1072→\n  1073→/**\n  1074→ * Retornar el string entrante en formato title case.\n  1075→ *\n  1076→ * @param {string} texto\n  1077→ * @returns {string}\n  1078→ * @author Fahibram Cárcamo\n  1079→ */\n  1080→function titleCase(texto) {\n  1081→    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n  1082→}\n  1083→\n  1084→/**\n  1085→ * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n  1086→ * almacenamiento local **LocalStorage**.\n  1087→ *\n  1088→ * @var {number}\n  1089→ * @author Fahibram Cárcamo\n  1090→ */\n  1091→const CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n  1092→\n  1093→/**\n  1094→ * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n  1095→ * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n  1096→ * variable.\n  1097→ *\n  1098→ * @returns {void}\n  1099→ * @author Fahibram Cárcamo\n  1100→ */\n  1101→function validarYActualizarUltimasEmpresasLocalStorage() {\n  1102→    let fecha_hora_actuales = moment();\n  1103→    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n  1104→    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n  1105→    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n  1106→\n  1107→    if (\n  1108→        ultimas_empresas != null &&\n  1109→        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n  1110→        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n  1111→    ) {\n  1112→        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n  1113→        return;\n  1114→    }\n  1115→\n  1116→    localStorage.removeItem('vencimiento_ultimas_empresas');\n  1117→    localStorage.removeItem('ultimas_empresas');\n  1118→}\n  1119→\n  1120→/**\n  1121→ * Obtener la edad actual de un usuario según su fecha de nacimiento.\n  1122→ *\n  1123→ * @param {string} fecha_nacimiento\n  1124→ * @returns {string}\n  1125→ * @author José Manuel Jiménez\n  1126→ * @author Fahibram Cárcamo\n  1127→ * @author Andres Morales\n  1128→ */\n  1129→function obtenerEdad(fecha_nacimiento) {\n  1130→    if (!fecha_nacimiento) return \"N/A\";\n  1131→    let hoy = new Date();\n  1132→    let nacimiento = new Date(fecha_nacimiento);\n  1133→    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n  1134→    let mes = hoy.getMonth() - nacimiento.getMonth();\n  1135→    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n  1136→    return edad + \" años\";\n  1137→}\n  1138→\n  1139→/**\n  1140→ * Restablecer un input de tipo file.\n  1141→ *\n  1142→ * @param {html} elemento_input_html Elemento input html.\n  1143→ * @param {html} label_elemento_input_html Label del elemento input html.\n  1144→ * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n  1145→ * @author Fahibram Cárcamo\n  1146→ */\n  1147→function reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n  1148→    elemento_input_html.val('');\n  1149→    elemento_input_html.removeAttr('data-base64');\n  1150→    label_elemento_input_html.text('Ningún archivo seleccionado');\n  1151→    boton_eliminar_elemento_input_html.hide();\n  1152→\n  1153→    if (elemento_input_html.data('imagen')) {\n  1154→        $('#' + elemento_input_html.data('imagen')).val('');\n  1155→        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n  1156→        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n  1157→    }\n  1158→}\n  1159→\n  1160→/**\n  1161→ * Definir un campo destinado a recibir un número de teléfono celular.\n  1162→ *\n  1163→ * Esta función debe llamarse en el evento ready del objeto global document:\n  1164→ * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n  1165→ * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n  1166→ * cuando se envíe el formulario donde se encutra el campo.\n  1167→ *\n  1168→ * ```\n  1169→ * if (\n  1170→ *   $('#input_celular_id').length &&\n  1171→ *   $('#input_celular_id').val() !== '' &&\n  1172→ *   input_celular.getNumber() !== ''\n  1173→ * ) {\n  1174→ *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n  1175→ * }\n  1176→ * ```\n  1177→ *\n  1178→ * Donde `input_celular` es el objeto retornado por esta función.\n  1179→ *\n  1180→ * @param {string} input_celular_id Id del campo.\n  1181→ * @param {string} nombre_input_celular Nombre del campo.\n  1182→ * @param {string} placeholder_input_celular Placeholder del campo.\n  1183→ * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n  1184→ * @returns {object}\n  1185→ * @author Fahibram Cárcamo\n  1186→ */\n  1187→function definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n  1188→    /**\n  1189→     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n  1190→     * Este componente se creó con la librería International Telephone Input\n  1191→     * (https://intl-tel-input.com).\n  1192→     *\n  1193→     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n  1194→     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n  1195→     * formulario cuando se envíe, en este caso 'celular_contacto'.\n  1196→     *\n  1197→     * Las lienas autoPlaceholder: 'aggressive' y\n  1198→     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n  1199→     * del campo.\n  1200→     *\n  1201→     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n  1202→     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n  1203→     * required directamente en el componente html.\n  1204→     *\n  1205→     * @author Fahibram Cárcamo\n  1206→     */\n  1207→    if (document.querySelector(`#${input_celular_id}`)) {\n  1208→        const dropdown_dinamico = document.createElement('div');\n  1209→        document.body.appendChild(dropdown_dinamico);\n  1210→\n  1211→        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n  1212→            nationalMode: true,\n  1213→            initialCountry: 'co',\n  1214→            separateDialCode: true,\n  1215→            autoInsertDialCode: false,\n  1216→            autoPlaceholder: 'aggressive',\n  1217→            dropdownContainer: dropdown_dinamico,\n  1218→            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n  1219→            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n  1220→            onlyCountries: [\n  1221→                'CO', // Colombia\n  1222→                'EC', // Ecuador\n  1223→                'AR', // Argentina\n  1224→                'CL', // Chile\n  1225→                'VE', // Venezuela\n  1226→                'PE', // Perú\n  1227→                'BO', // Bolivia\n  1228→                'UY', // Uruguay\n  1229→                'PY', // Paraguay\n  1230→                'PA', // Panamá\n  1231→                'MX', // México\n  1232→                'CR', // Costa Rica\n  1233→                // 'PR', // Puerto Rico\n  1234→                'CU', // Cuba\n  1235→                // 'DO', // República Dominicana\n  1236→                'SV', // El Salvador\n  1237→                'GT', // Guatemala\n  1238→                'HN', // Honduras\n  1239→                'NI', // Nicaragua\n  1240→                'ES', // España\n  1241→                'US', // Estados Unidos\n  1242→                'GQ'  // Guinea Ecuatorial\n  1243→            ]\n  1244→        });\n  1245→\n  1246→        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n  1247→\n  1248→        return campo_celular;\n  1249→    }\n  1250→\n  1251→    return null;\n  1252→}\n  1253→\n  1254→/**\n  1255→ * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n  1256→ * datos en un formulario.\n  1257→ *\n  1258→ * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n  1259→ * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n  1260→ * @author Fahibram Cárcamo\n  1261→ * @author Jair Carvajal\n  1262→ */\n  1263→function validacionAdicionalInputTipoCelular(input, input_id) {\n  1264→    let numero_completo = input.getNumber();\n  1265→    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n  1266→    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n  1267→    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n  1268→    $(`#indicativo_${input_id}`).val(indicativo);\n  1269→    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n  1270→    $(`#${input_id}`).val(numero_sin_indicativo);\n  1271→}\n  1272→\n  1273→/**\n  1274→ * Rellenar un input de tipo celular.\n  1275→ *\n  1276→ * @param {string} indicativo_celular Código del país del número de celular.\n  1277→ * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n  1278→ * @param {string} numero_celular Número de celular sin código de país.\n  1279→ * @param {string} input_celular_id ID del input de tipo celular.\n  1280→ * @param {HTMLInputElement} input_celular Input de tipo celular.\n  1281→ * @returns {void}\n  1282→ * @author Daniel Beltrán\n  1283→ * @author Fahibram Cárcamo\n  1284→ */\n  1285→function rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n  1286→    $(`#${input_celular_id}`).val(numero_celular);\n  1287→    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n  1288→}\n  1289→\n  1290→/**\n  1291→ * Convierte imágenes de base64 a Blob.\n  1292→ *\n  1293→ * @param {string} cadena_base_64 Base 64 de la imagen.\n  1294→ * @returns {Promise<Array>}\n  1295→ * @author Andres Gonzalez\n  1296→ */\n  1297→function imagenBase64Blob(cadena_base_64) {\n  1298→    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n  1299→    let datos_base_64 = cadena_base_64.split(',')[1];\n  1300→    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n  1301→    let caracteres_binarios = atob(datos_base_64);\n  1302→    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n  1303→    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n  1304→    return new Blob([bytes_uint8], { type: tipo_mime });\n  1305→}\n  1306→\n  1307→\n  1308→/**\n  1309→ * Limpiar estructuras html innecesarias en el check editor.\n  1310→ *\n  1311→ * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n  1312→ * @returns {string} HTML limpio sin elementos específicos de CKEditor\n  1313→ * @author Andres Gonzalez\n  1314→ * @author Jair Carvajal\n  1315→ */\n  1316→function limpiarHTMLCKEditor(html) {\n  1317→    // Remover todos los elementos con clases de CKEditor\n  1318→    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n  1319→    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n  1320→\n  1321→    // Limpiar spans de imagen inline\n  1322→    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n  1323→    html = html.replace(/<\\/span>/g, '');\n  1324→\n  1325→    // Remover elementos de upload y widgets\n  1326→    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n  1327→    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n  1328→\n  1329→    // Remover atributos innecesarios\n  1330→    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n  1331→    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n  1332→\n  1333→    // Limpiar párrafos vacíos con br\n  1334→    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n  1335→    html = html.replace(/<br data-cke[^>]*>/gi, '');\n  1336→\n  1337→    // Limpiar espacios múltiples y saltos de línea\n  1338→    html = html.replace(/\\s+/g, ' ');\n  1339→    html = html.replace(/>\\s+</g, '><');\n  1340→\n  1341→    return html.trim();\n  1342→}\n  1343→\n  1344→/**\n  1345→ * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n  1346→ * Preserva los índices originales para permitir edición y eliminación correcta.\n  1347→ *\n  1348→ * @param {Array} estudios - Array de objetos con estudios\n  1349→ * @returns {Array} Array de estudios ordenados con propiedad indice_original\n  1350→ * @author Jair Carvajal\n  1351→ */\n  1352→function ordenarEstudiosPorFecha(estudios) {\n  1353→    // Mapear con índice original\n  1354→    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n  1355→        ...estudio,\n  1356→        indice_original: indice_original\n  1357→    }));\n  1358→\n  1359→    // Ordenar estudios por fecha_inicio (más reciente primero)\n  1360→    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n  1361→        // Si ambos tienen fecha_inicio, ordenar por más reciente\n  1362→        if (a.fecha_inicio && b.fecha_inicio) {\n  1363→            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n  1364→        }\n  1365→        // Si solo uno tiene fecha_inicio, ese va primero\n  1366→        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n  1367→        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n  1368→        // Si ninguno tiene fecha_inicio, mantener orden original\n  1369→        return 0;\n  1370→    });\n  1371→\n  1372→    return estudios_ordenados;\n  1373→}\n  1374→\n  1375→/**\n  1376→ * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n  1377→ * luego por fecha_fin más reciente.\n  1378→ * Preserva los índices originales para permitir edición y eliminación correcta.\n  1379→ *\n  1380→ * @param {Array} experiencias - Array de objetos con experiencias laborales\n  1381→ * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n  1382→ * @author Jair Carvajal\n  1383→ */\n  1384→function ordenarExperienciasPorFecha(experiencias) {\n  1385→    // Mapear con índice original\n  1386→    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n  1387→        ...experiencia,\n  1388→        indice_original: indice_original\n  1389→    }));\n  1390→\n  1391→    // Ordenar experiencias\n  1392→    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n  1393→        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n  1394→        if (!a.fecha_fin && b.fecha_fin) return -1;\n  1395→        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n  1396→        if (a.fecha_fin && !b.fecha_fin) return 1;\n  1397→        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n  1398→        if (!a.fecha_fin && !b.fecha_fin) return 0;\n  1399→        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n  1400→        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n  1401→    });\n  1402→\n  1403→    return experiencias_ordenadas;\n  1404→}\n  1405→\n  1406→/**\n  1407→ * Obtener créditos disponibles de la empresa y actualizar el tag.\n  1408→ * - Si tiene créditos >= 20% del plan: tag azul\n  1409→ * - Si tiene créditos < 20% del plan: tag amarillo\n  1410→ * - Si no tiene créditos: tag gris \"Sin créditos\"\n  1411→ *\n  1412→ * @param {number} empresa_id ID de la empresa\n  1413→ * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n  1414→ * @returns {void}\n  1415→ * @author Andres Gonzalez\n  1416→ * @author Daniel Beltrán\n  1417→ */\n  1418→function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n  1419→    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n  1420→        return;\n  1421→    }\n  1422→\n  1423→    $.ajax({\n  1424→        url: `/empresas/${empresa_id}/creditos`,\n  1425→        method: 'GET',\n  1426→        dataType: 'json',\n  1427→        success: function (respuesta) {\n  1428→            if (respuesta?.data) {\n  1429→                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n  1430→                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n  1431→                let plan_credito = respuesta?.data?.plan_credito;\n  1432→                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n  1433→\n  1434→                let texto_tag = '';\n  1435→                let clase_tag = '';\n  1436→                let icono_final = '';\n  1437→\n  1438→                if (creditos_disponibles <= 0 || plan_credito === null) {\n  1439→                    texto_tag = 'Sin créditos';\n  1440→                    clase_tag = 'tag-tonal-gray';\n  1441→                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n  1442→                } else if (porcentaje_disponible < 20) {\n  1443→                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1444→                    clase_tag = 'tag-filled-yellow';\n  1445→                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n  1446→                } else {\n  1447→                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n  1448→                    clase_tag = 'tag-tonal-blue';\n  1449→                }\n  1450→\n  1451→                $(`#${contenedor_id}`).html(crearTag({\n  1452→                    texto: texto_tag,\n  1453→                    class: clase_tag,\n  1454→                    icono_final: icono_final,\n  1455→                }));\n  1456→            } else {\n  1457→                $(`#${contenedor_id}`).html(crearTag({\n  1458→                    texto: 'No tienes plan de créditos',\n  1459→                    class: 'tag-tonal-gray'\n  1460→                }));\n  1461→            }\n  1462→\n  1463→            inicializarTooltips();\n  1464→        },\n  1465→        error: function () {\n  1466→            $(`#${contenedor_id}`).html(crearTag({\n  1467→                texto: 'Error al cargar créditos',\n  1468→                class: 'tag-tonal-gray'\n  1469→            }));\n  1470→        }\n  1471→    });\n  1472→}\n  1473→\n  1474→/**\n  1475→ * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n  1476→ *\n  1477→ * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n  1478→ * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n  1479→ * @author Andres Gonzalez\n  1480→ */\n  1481→function obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n  1482→    let parametros = {};\n  1483→\n  1484→    if (tipo_prueba_id !== null) {\n  1485→        parametros.tipo_prueba_id = tipo_prueba_id;\n  1486→    }\n  1487→\n  1488→    return $.ajax({\n  1489→        url: '/funcionalidades-activas-plan',\n  1490→        method: 'GET',\n  1491→        dataType: 'json',\n  1492→        data: parametros,\n  1493→        success: function(respuesta) {\n  1494→            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n  1495→        }\n  1496→    });\n  1497→}\n  1498→\n  1499→/**\n  1500→ * Muestra Modal para informar que no cuenta con la funcionalidad\n  1501→ *.\n  1502→ * @returns {void}\n  1503→ * @author Andres Gonzalez\n  1504→ */\n  1505→function modalFuncionalidadInactiva() {\n  1506→    Swal.fire({\n  1507→        showCloseButton: true,\n  1508→        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n  1509→        showConfirmButton: false,\n  1510→        showDenyButton: false,\n  1511→        showCancelButton: false,\n  1512→        html: `\n  1513→            <div class=\"row w-100 mx-0 mt-2\">\n  1514→                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Adquiere esta funcionalidad</div>\n  1515→                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">No tienes esta funcionalidad activa. Por favor, contacta a tu asesor.</div>\n  1516→                <div class=\"col-6 mt-5 mb-2\">\n  1517→                    ${crearBoton({\n  1518→                        clases: 'btn-outline-primary w-100 justify-content-center',\n  1519→                        texto: 'Cancelar',\n  1520→                        onclick: `Swal.clickDeny();`\n  1521→                    })}\n  1522→                </div>\n  1523→                <div class=\"col-6 mt-5 mb-2\">\n  1524→                    ${crearBoton({\n  1525→                        clases: 'btn-primary w-100 justify-content-center',\n  1526→                        texto: 'Entiendo',\n  1527→                        onclick: `Swal.clickConfirm();`\n  1528→                    })}\n  1529→                </div>\n  1530→            </div>\n  1531→        `,\n  1532→    }).then(async (resultado) => {\n  1533→        //\n  1534→    });\n  1535→}\n  1536→\n  1537→/**\n  1538→ * Busca una funcionalidad por su llave.\n  1539→ *\n  1540→ * @param {string} llave Llave de la funcionalidad a buscar.\n  1541→ * @param {Array|null} funcionalidades funcionalidades.\n  1542→ * @returns {boolean}\n  1543→ * @author Andres Gonzalez\n  1544→ */\n  1545→function buscarFuncionalidad(llave, funcionalidades = null) {\n  1546→    let datos = funcionalidades ?? funcionalidades_disponibles_empresa;\n  1547→\n  1548→    if (!Array.isArray(datos) || datos.length === 0) {\n  1549→        return false;\n  1550→    }\n  1551→\n  1552→    return datos.some(item => item?.funcionalidad?.llave === llave);\n  1553→}\n  1554→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"af19596b-7202-4462-a83f-7c262f1806cf","timestamp":"2026-01-29T14:25:53.035Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","content":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n/**\n * Mostrar modal de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    // Verificar si el string incluye información de hora (espacio, T, o dos puntos)\n    if (!fecha_inicial.includes(\" \") && !fecha_inicial.includes(\"T\") && !fecha_inicial.includes(\":\")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n * @author Jair Carvajal\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            const NO_LEIDOS_IDS = new Set(Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id) : []);\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = NO_LEIDOS_IDS.has(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**\n * Muestra Modal para informar que no cuenta con la funcionalidad\n *.\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction modalFuncionalidadInactiva() {\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Adquiere esta funcionalidad</div>\n                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">No tienes esta funcionalidad activa. Por favor, contacta a tu asesor.</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.clickDeny();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Entiendo',\n                        onclick: `Swal.clickConfirm();`\n                    })}\n                </div>\n            </div>\n        `,\n    }).then(async (resultado) => {\n        //\n    });\n}\n\n/**\n * Busca una funcionalidad por su llave.\n *\n * @param {string} llave Llave de la funcionalidad a buscar.\n * @param {Array|null} funcionalidades funcionalidades.\n * @returns {boolean}\n * @author Andres Gonzalez\n */\nfunction buscarFuncionalidad(llave, funcionalidades = null) {\n    let datos = funcionalidades ?? funcionalidades_disponibles_empresa;\n\n    if (!Array.isArray(datos) || datos.length === 0) {\n        return false;\n    }\n\n    return datos.some(item => item?.funcionalidad?.llave === llave);\n}\n","numLines":1554,"startLine":1,"totalLines":1554}},"sourceToolAssistantUUID":"e9c1cc60-d59f-42ed-902c-6557a89876b5"}
{"parentUuid":"af19596b-7202-4462-a83f-7c262f1806cf","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01Jf2dW8eGj7LbwxiaF7btV8","toolUseID":"toolu_01Jf2dW8eGj7LbwxiaF7btV8","timestamp":"2026-01-29T14:25:53.039Z","uuid":"4932e421-2e98-4763-a3df-37e35aedd163"}
{"parentUuid":"4932e421-2e98-4763-a3df-37e35aedd163","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012fyyLKmDmHHSXScQhEKvTw","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Ahora entiendo la estructura:\n\n1. La función `obtenerCreditosDisponiblesEmpresa()` en `globales.js` ya obtiene los créditos y actualiza el tag, pero no muestra el modal.\n\n2. El componente `crearModal()` permite crear modales fácilmente.\n\n3. La vista de procesos (`index.blade.php`) carga los créditos automáticamente y usa `procesos.js` y `listado.js`.\n\nNecesito:\n1. Modificar `obtenerCreditosDisponiblesEmpresa()` para que también verifique si debe mostrar el modal\n2. Crear la función para mostrar el modal de advertencia de créditos\n3. Agregar lógica para verificar los umbrales (20%, 10%, 5%, 0%)\n4. Solo mostrar el modal una vez por sesión para cada umbral\n\nSegún el diseño de Figma:\n- Título: \"Solicita más créditos\"\n- Descripción: \"Tu saldo está por debajo del 20% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.\"\n- Botón \"Cancelar\" (outline azul)\n- Botón \"Solicitar más créditos\" (azul filled)\n\nLa lógica será:\n- Cuando se carga la página /procesos, verificar el porcentaje de créditos\n- Si el porcentaje está en 20%, 10%, 5% o 0%, mostrar el modal UNA VEZ\n- Usar localStorage para evitar mostrar el modal múltiples veces en la misma sesión\n\nVoy a revisar si existe la función `solicitarMasCreditosIA()` para usarla como referencia y luego voy a implementar la solución.\n\n\nNecesito examinar `procesos.js` para comprender cómo se integra el flujo de carga de créditos y dónde insertar la lógica del modal.","signature":"Er8MCkYICxgCKkD9eurZiWix84Dt7WBisxSW6eftOEIsTBDtrNU1tjqSovwZWhTa/BrilEGMUZ8GEISsJJ8FKSkQ3yoifsEm3YIOEgySDDH9ZjqzPOlQMh0aDF2UixTbt4ukvm3MnyIw7wFB9Igmkdi3ZiBuAiIkdtBcTu3MGYpTAG6WDujUS9yXWqs6ziJ7lEDmEqq+jTg1KqYLr+KQNDW/un4kxTRGNxvLqB67GGG540W2/RiUNrLgOm5gFe1JC2y/prW5+qo/SQqPHXi/IoSahalQ0jefiA3Hw7edoPx1emP/H9GHlIFWHgD4wTp4iiQW4nxpw2RGCozulrDcNlLLHUnaS7I/MPRgZCHQlt+rTmIfselcwYJr40K0K3uGFjxEcWETNNHt745e32WU+bT9OMcl4Kw67vlD3YwDctBGa5VGu1JEzpntCJP8zLklNjp3OHK0MLaaRX25kkLGuSZJbUqG6zSPBbXlgCP6JwljZmoTswYtRVbPxChY/M6Is6KxlNrZvVxAnwc2NS/R1IqsGUFak7ogFjDisaF2tI0wL9PzbmREMv+EWz8oTL0OaaUsiLbHCxAz20P4iCGfHdY9jKhQA9cy77RHLY7YsY5ndPIyE3oWCf4ZB6fUM6rj92Upl2iwUCXIpqc33g0uhGL0eel/Y1TDoWlV9fyvqu/8QfXFLj9yyIQTep3Ty7a2uNkDylcHj7riHWAh+mc9U0VWuorj05OGSlf+u+gRAptU+IHUmfjOF0TuF1fRtS+RhgWkN+WSyr9sVSA7YqBNWPv3t6AwwHofSTNQO4B1BvafEAwEk5h71REHPrli8Xfb14jX27W104305R/rIx/f9sEo1SoiUt13mAhBZkfUXnt2xjDZQcRvfuXqLvw6AVZBTAdnAViU5HimXh7DiraitEC1HAASWAFlKeDM+vDB2a6ginTfKUo6IMR1NJjABEbdfK8HWQI1R+pXWC7z9XTkFtFYPSuFrwMODzxpGIQlPEMiIEbDLFxO6aG1T93CSe9ABOi/gIhR800ns2svdfg6pqTDq520to9SRhh5fhfaGBfZu5xuUbOQ9eG4xRxdmIjtJPlsGszS6XflTnDqRqDXU2CLxGMiMWP2o+L1EJC9C3HiBpt97SmKbFvivJjM3vRHCvI1XnPc76AtyNipsb9ylelvIO4OB51HdAw1uEWLJoLQM1ZiFhQJ6CJKWCebx02SNF86gzKuXxOtOPIL3aUGnnaNFg/Kx4jrWM/ieAlNqVSs/ICqnxzn8ZQL6np4+dTIpDNt6WYAQpNIa+hXOc2WpHcQshE7xIkX6drexgKze0yzOrfopoTTrC+ZszhWL3O7N9VNmk1YbZ4UeN/h9dUfFuDU3WKG4n9JylXYvURQpF2QYl5E9Ml/Flp7UDjyhrD0fTWEkehiIlWlEo1cf/ct8xeWTEIwQsoPINkSPheAUw/mWg4Ln+bhZSClRq1qol9BmDuHJuj9cr5v8hYn9vY7jOcqynQXFwyq2YrDZxhZ+oC3QIKchlACpM1xlBtWfqtACYbaSWA1mn2YWzB9CHUE06QtcQ2YzjmN1oU/6ZbNPPNy+ABUBGoVnYT3Y42eXKJHeHsAm5GdLjSUHL+DULHKer4iJ3gkJmYtl/F8b2lpdKssWY6yDPVn1jbInmn70c5giAwBOL6iL6KlAfs0lYSH05K1qqOCnjmC7yhp7x4/LzlBIDfBeXk7rx9F/GlmFX9Ut6sTmzmrl9iVST86cAwPRo6HRfj8W5/sLsB8QgtD9yULE4EAyB7Fjlkl41LvkFdW9GfqodhjsreFb/YVr6mSqHjlr2cKXEW646B7BXTSyuz0jFnOKsH1QNjrUAnjbrBQKRKbF5TUKa4ypFjwc0fALHc6feD04lndIMQcitHrnQtVPkvUWJF8D5Y32GGpuzDnT477MGPUbi7nyeRYfm5RD55ShK3kOgW1pxzipGvPf1pe5QqnILl3UivYB2grcPtL0qnkKC84HVx3lzYjgXNOic9qbzAgJFZTMnkfpUESJHAC/eodZZFD9hZjJNNxliHGJgOQKLjMZWFrn6piOtWrhgXATGSiz3ru04m0ZqNpccLxEHweOAraYsB4UdNbHmnoIxlzwaFVsMVIG+ad1QMi8RNmGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3640,"cache_creation_input_tokens":24196,"cache_read_input_tokens":37524,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":24196},"output_tokens":6,"service_tier":"standard"}},"requestId":"req_011CXbpjTvNuSQbj2tcXU63M","type":"assistant","uuid":"dee45bca-ec15-4e9a-be94-d1b07f1743de","timestamp":"2026-01-29T14:26:05.339Z"}
{"parentUuid":"dee45bca-ec15-4e9a-be94-d1b07f1743de","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012fyyLKmDmHHSXScQhEKvTw","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora voy a ver el archivo `procesos.js` para entender el flujo y dónde integrar la funcionalidad."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3640,"cache_creation_input_tokens":24196,"cache_read_input_tokens":37524,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":24196},"output_tokens":6,"service_tier":"standard"}},"requestId":"req_011CXbpjTvNuSQbj2tcXU63M","type":"assistant","uuid":"e670da59-832d-46ce-8832-32d0935dc5aa","timestamp":"2026-01-29T14:26:05.355Z"}
{"parentUuid":"e670da59-832d-46ce-8832-32d0935dc5aa","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012fyyLKmDmHHSXScQhEKvTw","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01DkzKp7icXiNfkYg4sw421p","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\procesos\\procesos.js"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":3640,"cache_creation_input_tokens":24196,"cache_read_input_tokens":37524,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":24196},"output_tokens":6,"service_tier":"standard"}},"requestId":"req_011CXbpjTvNuSQbj2tcXU63M","type":"assistant","uuid":"dc4f1c59-8f5e-4732-9470-f33d4969d3ed","timestamp":"2026-01-29T14:26:05.929Z"}
{"parentUuid":"dc4f1c59-8f5e-4732-9470-f33d4969d3ed","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01DkzKp7icXiNfkYg4sw421p","type":"tool_result","content":"     1→const configuracion_tablas = {\n     2→    autoWidth: false,\n     3→    responsive: true,\n     4→    processing: false,\n     5→    serverSide: false,\n     6→    searching: true,\n     7→    deferRender: true,\n     8→    paging: true,\n     9→    aaSorting: [],\n    10→    language: lenguaje_componente_datatables,\n    11→    lengthMenu: [\n    12→        [10, 25, 50, 100, 200],\n    13→        [10, 25, 50, 100, 200]\n    14→    ],\n    15→    pageLength: 10,\n    16→    scrollX: true,\n    17→    scrollY: 'calc(100vh)',\n    18→    scrollCollapse: true\n    19→};\n    20→\n    21→const TIPOS_DOCUMENTO = [\n    22→    {id: '1', nombre: 'Cédula de ciudadanía'},\n    23→    {id: '2', nombre: 'Tarjeta de identidad'},\n    24→    {id: '3', nombre: 'Pasaporte'},\n    25→    {id: '4', nombre: 'Cédula de extranjería'}\n    26→];\n    27→\n    28→const ESTADOS_PROCESOS = {\n    29→    '1': crearTag({ texto: 'Pendiente', class: 'text-label-1 tag-filled-yellow'}),\n    30→    '2': crearTag({ texto: 'Activo', class: 'text-label-1 tag-filled-blue'}),\n    31→    '3': crearTag({ texto: 'Completada', class: 'text-label-1 tag-filled-green'}),\n    32→    '4': crearTag({ texto: 'Cerrado', class: 'text-label-1 tag-filled-gray'}),\n    33→    '5': crearTag({ texto: 'Suspendido', class: 'text-label-1 tag-filled-purple'}),\n    34→};\n    35→\n    36→const PRIORIDAD_PROCESOS = {\n    37→    '1': crearTag({ texto: '<i class=\"bi bi-chevron-down me-2\"></i>Baja <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-blue'}),\n    38→    '2': crearTag({ texto: '<i class=\"bi bi-dash-lg me-2\"></i>Media <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-yellow'}),\n    39→    '3': crearTag({ texto: '<i class=\"bi bi-chevron-up me-2\"></i>Alta <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-orange'}),\n    40→    '4': crearTag({ texto: '<i class=\"bi bi-chevron-double-up me-2\"></i>Urgente <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-red'}),\n    41→    'null': crearTag({ texto: 'Sin prioridad <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-gray'}),\n    42→};\n    43→\n    44→const ESTADO_PARTICIPANTES = {\n    45→    '9': crearTag({ texto: 'En pruebas', class: 'px-4 text-center text-label-1 tag-tonal-orange'}),\n    46→    '10': crearTag({ texto: 'Seleccionado', class: 'px-4 text-center text-label-1 tag-tonal-green'}),\n    47→    '11': crearTag({ texto: 'Descartado', class: 'px-4 text-center text-label-1 tag-tonal-red'}),\n    48→};\n    49→const ESTADO_PRUEBAS = {\n    50→    '1': crearTag({ texto: 'Invalidada', class: 'px-4 text-center text-label-2 tag-tonal-gray'}),\n    51→    '2': crearTag({ texto: 'Recomendado', class: 'px-4 text-center text-label-2 tag-tonal-green'}),\n    52→    '3': crearTag({ texto: 'Sin iniciar', class: 'px-4 text-center text-label-2 tag-tonal-blue'}),\n    53→    '4': crearTag({ texto: 'Sugerido', class: 'px-4 text-center text-label-2 tag-tonal-yellow'}),\n    54→    '5': crearTag({ texto: 'No recomendado', class: 'px-4 text-center text-label-2 tag-tonal-red'}),\n    55→};\n    56→const ESTADO_AGENDAS = {\n    57→    '1': crearTag({ texto: 'Sin iniciar', class: 'px-4 text-center text-label-1 tag-tonal-blue'}),\n    58→    '2': crearTag({ texto: 'Iniciada', class: 'px-4 text-center text-label-1 tag-tonal-yellow'}),\n    59→    '3': crearTag({ texto: 'Finalizada', class: 'px-4 text-center text-label-1 tag-tonal-green'}),\n    60→    '4': crearTag({ texto: 'Expirada', class: 'px-4 text-center text-label-1 tag-tonal-red'}),\n    61→    '5': crearTag({ texto: 'Invalidada', class: 'px-4 text-center text-label-1 tag-tonal-gray'}),\n    62→    '6': crearTag({ texto: 'Sin pago', class: 'px-4 text-center text-label-1 tag-tonal-purple'}),\n    63→};\n    64→\n    65→const convertirFecha = fecha => {\n    66→    if (!fecha) return \"\";\n    67→    fecha = String(fecha).substring(0, 10);\n    68→    return fecha.includes('-') ? fecha.split('-').reverse().join('-') : \"Formato incorrecto\";\n    69→};\n    70→\n    71→/**\n    72→ * Crear tag de estado de agenda con tooltip si el estado requiere fechas.\n    73→ *\n    74→ * @param {object} agenda Objeto agenda con estado_id, fecha_inicio y fecha_cierre.\n    75→ * @returns {string} HTML del tag con o sin tooltip.\n    76→ * @author Sergio Vargas\n    77→ */\n    78→function crearTagEstadoAgenda(agenda) {\n    79→    const estados_config = {\n    80→        '1': { texto: 'Sin iniciar', class: 'px-4 text-center text-label-1 tag-tonal-blue', mostrar_fechas: true },\n    81→        '2': { texto: 'Iniciada', class: 'px-4 text-center text-label-1 tag-tonal-yellow', mostrar_fechas: true },\n    82→        '3': { texto: 'Finalizada', class: 'px-4 text-center text-label-1 tag-tonal-green', mostrar_fechas: false },\n    83→        '4': { texto: 'Expirada', class: 'px-4 text-center text-label-1 tag-tonal-red', mostrar_fechas: true },\n    84→        '5': { texto: 'Invalidada', class: 'px-4 text-center text-label-1 tag-tonal-gray', mostrar_fechas: false },\n    85→        '6': { texto: 'Sin pago', class: 'px-4 text-center text-label-1 tag-tonal-purple', mostrar_fechas: false },\n    86→    };\n    87→\n    88→    const estado_id = String(agenda.estado_id);\n    89→    const config = estados_config[estado_id];\n    90→\n    91→    if (!config) {\n    92→        return crearTag({ texto: 'Desconocido', class: 'px-4 text-center text-label-1 tag-tonal-gray' });\n    93→    }\n    94→\n    95→    let tooltip_content = '';\n    96→    if (config.mostrar_fechas && agenda.fecha_inicio && agenda.fecha_cierre) {\n    97→        const fecha_inicio_formateada = convertirFecha(agenda.fecha_inicio);\n    98→        const fecha_cierre_formateada = convertirFecha(agenda.fecha_cierre);\n    99→        tooltip_content = `Fecha inicio: ${fecha_inicio_formateada}<br>Fecha fin: ${fecha_cierre_formateada}`;\n   100→    }\n   101→\n   102→    if (tooltip_content) {\n   103→        return `\n   104→            <div class=\"tag ${config.class} text-label-1\" data-bs-toggle=\"tooltip\" data-bs-html=\"true\" data-bs-placement=\"top\" title=\"${tooltip_content}\">\n   105→                ${config.texto}\n   106→            </div>\n   107→        `;\n   108→    } else {\n   109→        return crearTag({ texto: config.texto, class: config.class });\n   110→    }\n   111→}\n   112→\n   113→let fila = \"\";\n   114→let titulo_mensaje = '';\n   115→let contenido_mensaje = '';\n   116→let maneja_empresa = '';\n   117→\n   118→$(document).ready(() => {\n   119→    obtenerFuncionalidadesActivasPlan();\n   120→    configurarFormulario(\"formulario-compartir-procesos\");\n   121→\n   122→    $(document).on(\"click\", '#usar-pruebas-btn', function() {\n   123→        mostrarToast('success', 'Pruebas usadas EN DESARROLLO.');\n   124→    });\n   125→    $(document).on(\"click\", '#agregar-participantes-btn', function() {\n   126→        $(\"#mensaje-candidato\").empty();\n   127→        agregarCamposParticipante();\n   128→    });\n   129→    $(document).on(\"click\", '#ignorar-pruebas-btn', function() {\n   130→        pintarFila();\n   131→    });\n   132→\n   133→    $(document).on(\"click\", \".remove-btn\", function() {\n   134→        $(this).closest(\"tr\").remove();\n   135→    });\n   136→    $('#contenedor-vigencia-pruebas [name=\"vigencia_pruebas\"]').change(function () {\n   137→        var vigencia_codigo = $(this).val();\n   138→        switch (vigencia_codigo) {\n   139→            case '0':\n   140→                $('#contenedor-vigencia-pruebas #contenedor-input-es-dias').removeClass('d-none');\n   141→                $('#contenedor-vigencia-pruebas #contenedor-input-es-fecha').addClass('d-none');\n   142→                break;\n   143→            case '1':\n   144→                $('#contenedor-vigencia-pruebas #contenedor-input-es-dias').addClass('d-none');\n   145→                $('#contenedor-vigencia-pruebas #contenedor-input-es-fecha').removeClass('d-none');\n   146→                break;\n   147→        }\n   148→    });\n   149→    $('#modal-mover-proceso [name=\"vigencia_pruebas\"]').change(function () {\n   150→        var vigencia_codigo = $(this).val();\n   151→        switch (vigencia_codigo) {\n   152→            case '0':\n   153→                $('#modal-mover-proceso #contenedor-input-es-dias').removeClass('d-none');\n   154→                $('#modal-mover-proceso #contenedor-input-es-fecha').addClass('d-none');\n   155→                break;\n   156→            case '1':\n   157→                $('#modal-mover-proceso #contenedor-input-es-dias').addClass('d-none');\n   158→                $('#modal-mover-proceso #contenedor-input-es-fecha').removeClass('d-none');\n   159→                break;\n   160→        }\n   161→    });\n   162→    $('#modal-reagendar [name=\"vigencia_pruebas\"]').change(function () {\n   163→        var vigencia_codigo = $(this).val();\n   164→        switch (vigencia_codigo) {\n   165→            case '0':\n   166→                $('#modal-reagendar #contenedor-input-es-horas').addClass('d-none');\n   167→                $('#modal-reagendar #contenedor-input-es-dias').removeClass('d-none');\n   168→                $('#modal-reagendar #contenedor-input-es-fecha').addClass('d-none');\n   169→                break;\n   170→            case '1':\n   171→                $('#modal-reagendar #contenedor-input-es-horas').addClass('d-none');\n   172→                $('#modal-reagendar #contenedor-input-es-dias').addClass('d-none');\n   173→                $('#modal-reagendar #contenedor-input-es-fecha').removeClass('d-none');\n   174→                break;\n   175→        }\n   176→    });\n   177→\n   178→    $('#modal-agregar-participantes').find('.modal-body').addClass('px-0 pt-0');\n   179→    if (window.location.href.includes(\"create\") || window.location.href.includes(\"edit\")) {\n   180→        obtenerPlantilla(empresa_id);\n   181→    }\n   182→});\n   183→\n   184→/**\n   185→ * Agrega valores al dataform.\n   186→ *\n   187→ * @param {array} datos_formulario Datos del evento success.\n   188→ * @returns {void}\n   189→ * @author Jair Carvajal\n   190→ * @author Andres Morales\n   191→ */\n   192→function agregarDataForm(datos_formulario) {\n   193→    const rawValue = datos_formulario.get('emails_destinatarios');\n   194→    const fecha = datos_formulario.get('fecha_hora_expiracion').trim();\n   195→    datos_formulario.delete('emails_destinatarios');\n   196→    datos_formulario.delete('fecha_hora_expiracion');\n   197→\n   198→    datos_formulario.append('fecha_hora_expiracion', `${fecha} 00:00:00`);\n   199→    rawValue.split(',')\n   200→        .map(correo => correo.trim())\n   201→        .filter(correo => correo.length > 0)\n   202→        .forEach(correo => {\n   203→            datos_formulario.append('emails_destinatarios[]', correo);\n   204→        });\n   205→\n   206→    return datos_formulario;\n   207→}\n   208→\n   209→/**\n   210→ * Pintar las filas de los participantes en la tabla.\n   211→ *\n   212→ * @returns {void}\n   213→ * @author Jair Carvajal\n   214→ * @author Andres Morales\n   215→ */\n   216→function pintarFila() {\n   217→    $(\"#tabla-participantes\").append(fila);\n   218→    $(\"#numero_documento\").val(\"\");\n   219→    $(\"#correo_electronico\").val(\"\");\n   220→    $(\"#mensaje-candidato\").empty();\n   221→}\n   222→\n   223→/**\n   224→ * Ejecutar cuando el formulario se envía correctamente.\n   225→ *\n   226→ * @param {array} evento Datos del evento success.\n   227→ * @returns {void}\n   228→ * @author Jair Carvajal\n   229→ */\n   230→function postSuccess(evento) {\n   231→    mostrarToast('success', 'Proceso compartido exitosamente.');\n   232→    $('#modal-compartir-procesos').modal('hide');\n   233→}\n   234→\n   235→/**\n   236→ * Ejecutar cuando el formulario se envía correctamente.\n   237→ *\n   238→ * @param {string} cadenaCorreos strign con los correos para validarlos.\n   239→ * @returns {void}\n   240→ * @author Jair Carvajal\n   241→ */\n   242→function validarCorreos(cadenaCorreos) {\n   243→    let correos = cadenaCorreos\n   244→        .split(',')\n   245→        .map(c => c.trim())\n   246→        .filter(c => c.length > 0);\n   247→    let regex_correo = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n   248→\n   249→    let todos_validos = correos.every(correo => regex_correo.test(correo));\n   250→\n   251→    return todos_validos;\n   252→}\n   253→\n   254→/**\n   255→ * Crear boton adicional para ckeditor.\n   256→ *\n   257→ * @returns {html} botón adicional para ckeditor.\n   258→ * @author Andres Morales\n   259→ */\n   260→function botonAdicionalCkeditor(id) {\n   261→    return `\n   262→        <div class=\"border-start border-black border-2 px-2 my-0 dropdown\">\n   263→            ${crearBoton({\n   264→                clases: 'dropdown-toggle text-body-3 btn-dropdown-ckeditor',\n   265→                texto: 'Agregar variable<i class=\"bi bi-chevron-down text-body-3 ms-2\"></i>',\n   266→                data: [{texto: 'bs-toggle', value: 'dropdown'},{texto: 'bs-auto-close', value: 'outside'},]\n   267→            })}\n   268→            <div class=\"dropdown-menu bg-white\">\n   269→                <button type=\"button\" class=\"dropdown-item-ckeditor p-2\" onclick=\"agregarVariable('__nombre_participante__')\">Nombre participante</button>\n   270→                <button type=\"button\" class=\"dropdown-item-ckeditor p-2\" onclick=\"agregarVariable('__nombre_empresa__')\">Nombre empresa</button>\n   271→                <button type=\"button\" class=\"dropdown-item-ckeditor p-2\" onclick=\"agregarVariable('__nombre_proceso__')\">Nombre proceso</button>\n   272→            </div>\n   273→        </div>\n   274→    `;\n   275→}\n   276→\n   277→/**\n   278→ * Agrega la variable en cuestion en el ckeditor.\n   279→ *\n   280→ * @returns {void}\n   281→ * @author Andres Morales\n   282→ */\n   283→function agregarVariable(variable) {\n   284→    let texto = $('#descripcion_mensaje').data('editor').getData()\n   285→    $('#descripcion_mensaje').data('editor').setData(texto + variable);\n   286→}\n   287→\n   288→/**\n   289→ * Valida el email ingresado para ingresar participantes.\n   290→ *\n   291→ * @returns {boolean} Si el email cumple con la estructura.\n   292→ * @author Andres Morales\n   293→ */\n   294→function validateEmail(email) {\n   295→    let re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n   296→    return re.test(email);\n   297→}\n   298→\n   299→/**\n   300→ * Realizar validación adicional de un formulario para activar o desactivar pasos.\n   301→ *\n   302→ * @param {string} formulario Identificador del formulario.\n   303→ * @returns {boolean} True si los correos son válidos, false en caso contrario.\n   304→ * @author José Manuel Jiménez\n   305→ * @author Andres Morales\n   306→ */\n   307→function validacionAdicional(formulario) {\n   308→    if (!validarCorreos($(\"#email\").val())) {\n   309→        mostrarToast('danger', 'Hay correos inválidos, validalos y vuelve a intentar.');\n   310→        return false;\n   311→    }\n   312→    return true;\n   313→}\n   314→\n   315→/**\n   316→ * Abrir modal para agregar participantes.\n   317→ *\n   318→ * @param {number} id ID del proceso.\n   319→ * @returns {void}\n   320→ * @author Daniel Beltrán\n   321→ * @author Andres Morales\n   322→ */\n   323→function abrirModalAgregarParticipantes(id) {\n   324→    let proceso = null;\n   325→\n   326→    if (typeof PROCESO !== 'undefined' && PROCESO && PROCESO.id == id) {\n   327→        proceso = PROCESO;\n   328→    } else if (typeof procesos_datos_ids !== 'undefined' && procesos_datos_ids && Array.isArray(procesos_datos_ids)) {\n   329→        proceso = procesos_datos_ids.find(p => p.id == id);\n   330→    }\n   331→\n   332→    if (proceso && proceso.fecha_cierre) {\n   333→        let fecha_cierre = new Date(proceso.fecha_cierre);\n   334→        let fecha_actual = new Date();\n   335→\n   336→        fecha_cierre.setHours(23, 59, 59, 999);\n   337→        fecha_actual.setHours(0, 0, 0, 0);\n   338→\n   339→        let dias_restantes = Math.floor((fecha_cierre - fecha_actual) / (1000 * 60 * 60 * 24));\n   340→\n   341→        if (dias_restantes <= 3) {\n   342→            Swal.fire({\n   343→                showCloseButton: true,\n   344→                closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n   345→                showConfirmButton: false,\n   346→                showDenyButton: false,\n   347→                showCancelButton: false,\n   348→                html: `\n   349→                    <div class=\"row w-100 mx-0 mt-2\">\n   350→                        <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Tiempo insuficiente</div>\n   351→                        <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">Faltan 3 días o menos para la fecha de vencimiento y no hay suficiente tiempo para agendar pruebas.</div>\n   352→                        <div class=\"col-12 mt-5 mb-2\">\n   353→                            ${crearBoton({\n   354→                                clases: 'btn-primary w-100 justify-content-center',\n   355→                                texto: 'Entendido',\n   356→                                onclick:`Swal.close();`\n   357→                            })}\n   358→                        </div>\n   359→                    </div>\n   360→                `,\n   361→            });\n   362→            return;\n   363→        }\n   364→    }\n   365→\n   366→    $('#modal-agregar-participantes #proceso_id').val(id);\n   367→    obtenerPlantilla(proceso.empresa_id, true);\n   368→}\n   369→\n   370→/**\n   371→ * Abrir modal para agendar participantes de forma masiva en el proceso.\n   372→ *\n   373→ * @param {number} id Id del proceso.\n   374→ * @returns {void}\n   375→ * @author Fahibram Cárcamo\n   376→ */\n   377→function abrirModalAgendamientoMasivo(id) {\n   378→    $('#modal-agendamiento-masivo #proceso_id').val(id);\n   379→    $('#modal-agendamiento-masivo').modal('show');\n   380→}\n   381→\n   382→/**\n   383→ * Realiza la petición AJAX al end-point que extrae los datos de los participantes del proceso\n   384→ * contenidos en el archivo Excel cargado y los retorna en formato JSON para ser agendados de forma\n   385→ * masiva posteriormente.\n   386→ *\n   387→ * @returns {Promise<void>}\n   388→ * @author Fahibram Cárcamo\n   389→ */\n   390→async function extraerDatosParticipantes() {\n   391→    let archivo = $('#archivo_datos_participantes')[0].files[0];\n   392→\n   393→    if (!archivo) {\n   394→        mostrarToast('danger', 'Debe seleccionar un archivo Excel para procesar.');\n   395→        return;\n   396→    }\n   397→\n   398→    const datos_formulario = new FormData();\n   399→    datos_formulario.append('_token', $('input[name=\"_token\"]').val());\n   400→    datos_formulario.append('proceso_id', $('#modal-agendamiento-masivo #proceso_id').val());\n   401→    datos_formulario.append('archivo', archivo);\n   402→\n   403→    $('#modal-agendamiento-masivo #boton-guardar').html('Cargando...');\n   404→\n   405→    await $.ajax({\n   406→        url: '/procesos-extraer-datos-participantes',\n   407→        type: 'POST',\n   408→        data: datos_formulario,\n   409→        processData: false,\n   410→        contentType: false\n   411→    }).done(function(respuesta) {\n   412→        $('#modal-agendamiento-masivo').modal('hide');\n   413→        $('#modal-agregar-participantes').modal('show');\n   414→        $('#modal-agregar-participantes #proceso_id').val($('#modal-agendamiento-masivo #proceso_id').val());\n   415→        obtenerPlantilla(PROCESO.empresa_id);\n   416→        agregarParticipantesMasivamente(respuesta.datos_participantes);\n   417→    }).fail(function(error) {\n   418→        let mensaje_error = 'Ocurrió un error al procesar el archivo';\n   419→\n   420→        if (error.responseJSON && error.responseJSON.errors) {\n   421→            mensaje_error = error.responseJSON.errors;\n   422→        } else if (error.responseJSON && error.responseJSON.message) {\n   423→            mensaje_error = error.responseJSON.message;\n   424→        }\n   425→\n   426→        mostrarToast('danger', mensaje_error);\n   427→    });\n   428→\n   429→    $('#modal-agendamiento-masivo #boton-guardar').html('<i class=\"bi bi-upload me-2\"></i>Cargar');\n   430→}\n   431→\n   432→/**\n   433→ * Agregar participantes masivamente en el modal `#modal-agregar-participantes`.\n   434→ *\n   435→ * @param {array} datos_participantes Arreglo con los datos de los participantes a agregar.\n   436→ * @author Fahibram Cárcamo\n   437→ */\n   438→function agregarParticipantesMasivamente(datos_participantes) {\n   439→    datos_participantes.forEach(participante => {\n   440→        let documento_seleccionado = TIPOS_DOCUMENTO.find(opcion => parseInt(opcion.id) === participante.tipo_documento_id);\n   441→        let texto_documento = documento_seleccionado ? documento_seleccionado.nombre : 'Documento no encontrado';\n   442→\n   443→        fila = `\n   444→            <tr class=\"tr-contenido-participante\">\n   445→                <td class=\"justify-content-center\">${texto_documento}</td>\n   446→                <td class=\"justify-content-center\">${participante.documento}</td>\n   447→                <td class=\"justify-content-center\">${participante.email}</td>\n   448→                <td class=\"text-center\">\n   449→                    <input type=\"hidden\" name=\"participantes[]['documento']\" value=\"${participante.documento}\">\n   450→                    <input type=\"hidden\" name=\"participantes[]['email']\" value=\"${participante.email}\">\n   451→                    ${crearBoton({\n   452→                        type: 'button',\n   453→                        clases: 'btn-text-danger remove-btn',\n   454→                        texto: `\n   455→                            <svg\n   456→                                xmlns=\"http://www.w3.org/2000/svg\"\n   457→                                width=\"16\"\n   458→                                height=\"18\"\n   459→                                fill=\"currentColor\"\n   460→                                class=\"bi bi-trash-fill text-danger\"\n   461→                                viewBox=\"0 0 16 18\"\n   462→                            >\n   463→                                <path class=\"text-danger\" d=\"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0\"/>\n   464→                            </svg>\n   465→                        `,\n   466→                        tooltip: `${crearTooltip({ placement: `bottom`, content: 'Eliminar participante', toggle: `popover`,})}`,\n   467→                    })}\n   468→                </td>\n   469→            </tr>\n   470→        `;\n   471→\n   472→        pintarFila();\n   473→    });\n   474→}\n   475→\n   476→/**\n   477→ * Abrir modal para agregar participantes.\n   478→ *\n   479→ * @param {number} id ID del proceso.\n   480→ * @param {number|null} aplicante_id ID del participante (opcional).\n   481→ * @returns {void}\n   482→ * @author Jair Carvajal\n   483→ * @author Andres Morales\n   484→ * @author Andres Gonzalez\n   485→ */\n   486→function abrirModalCompartirProceso(id, aplicante_id = null) {\n   487→    if (!buscarFuncionalidad('compartir_proceso_interesados')) {\n   488→        modalFuncionalidadInactiva();\n   489→        return;\n   490→    }\n   491→\n   492→    $('#modal-compartir-procesos #proceso_id').val(id);\n   493→    if (aplicante_id != null) {\n   494→        $('#aplicante_id').val(aplicante_id);\n   495→        $('#formulario-compartir-procesos').attr('action', '/procesos-compartir-resultados-aplicante');\n   496→    } else {\n   497→        $('#formulario-compartir-procesos').attr('action', '/procesos-compartir/' + id);\n   498→    }\n   499→\n   500→    $('#modal-compartir-procesos').modal('show');\n   501→\n   502→    $('#modal-compartir-procesos').off('hidden.bs.modal').on('hidden.bs.modal', function () {\n   503→        $('#formulario-compartir-procesos')[0].reset();\n   504→    });\n   505→}\n   506→\n   507→/**\n   508→ * Guardar los nuevos participantes del proceso.\n   509→ *\n   510→ * @returns {Promise<void>}\n   511→ * @author Daniel Beltrán\n   512→ * @author Andres Morales\n   513→ * @author Andres Gonzalez\n   514→ */\n   515→async function guardarParticipantes() {\n   516→    let titulo_mensaje =  $('#formulario-agregar-participantes #titulo_mensaje').val();\n   517→    let descripcion_mensaje =  $('#formulario-agregar-participantes #descripcion_mensaje').data('editor').getData();\n   518→    let arrayElementos = $('.tr-contenido-participante').length ? $('.tr-contenido-participante').toArray() : [];\n   519→    if (arrayElementos.length === 0) {\n   520→        mostrarToast('danger', 'Debe agregar al menos un participante.');\n   521→        return;\n   522→    }\n   523→    if (descripcion_mensaje.length > 800) {\n   524→        mostrarToast('danger', 'El campo descripción del mensaje no puede superar los 800 caracteres.');\n   525→        $('#boton-guardar').removeAttr('disabled');\n   526→        return;\n   527→    }\n   528→    let fechaActual = new Date();\n   529→    fechaActual.setDate(fechaActual.getDate() + 5);\n   530→    let fechaFormateada = fechaActual.toISOString().slice(0, 16);\n   531→\n   532→    const DATOS = new FormData();\n   533→    DATOS.append('_token', $('input[name=\"_token\"]').val());\n   534→    DATOS.append('proceso_id',$('#formulario-agregar-participantes #proceso_id').val());\n   535→    DATOS.append('vigencia_pruebas', 1);\n   536→    DATOS.append('dias_vencimiento_agendas', 5);\n   537→    DATOS.append('fecha_vencimiento_agendas', fechaFormateada);\n   538→    DATOS.append('titulo_mensaje', titulo_mensaje);\n   539→    DATOS.append('descripcion_mensaje', descripcion_mensaje);\n   540→    if ($('#con_logo').is(':checked')) {\n   541→        maneja_empresa = \"1\";\n   542→    } else {\n   543→        maneja_empresa = \"0\";\n   544→    }\n   545→    DATOS.append('maneja_empresa', maneja_empresa);\n   546→    DATOS.append('participantes', JSON.stringify(obtenerDatosParticipantes()));\n   547→\n   548→    await $.ajax({\n   549→        url        : `/procesos-participantes/${$('#proceso_id').val()}`,\n   550→        type       : 'POST',\n   551→        data       : DATOS,\n   552→        processData: false,\n   553→        contentType: false\n   554→    }).then((respuesta) => {\n   555→        mostrarToast('success', respuesta.message);\n   556→        $('#modal-agregar-participantes').modal('hide');\n   557→        $('#formulario-agregar-participantes')[0].reset();\n   558→        $('#formulario-agregar-participantes #tabla-participantes').empty();\n   559→\n   560→        if (window.location.pathname === '/procesos') {\n   561→            actualizarDatatables('tabla-pruebas-psicometricas');\n   562→        } else if (window.location.pathname.startsWith('/procesos/')) {\n   563→            actualizarDatatables('tabla_participantes');\n   564→        }\n   565→    }).catch((error) => {\n   566→        mostrarToast('danger', error.responseJSON.errors);\n   567→    });\n   568→}\n   569→\n   570→/**\n   571→ * Agregar fila de campos para un participante.\n   572→ *\n   573→ * @returns {void}\n   574→ * @author Andres Morales\n   575→ * @author Fahibram Cárcamo\n   576→ */\n   577→function agregarCamposParticipante() {\n   578→    let tipo_documento = $(\"#tipo_documento\").val();\n   579→    let numero_documento = $(\"#numero_documento\").val().trim();\n   580→    let email = $(\"#correo_electronico\").val().trim();\n   581→\n   582→    let documento_seleccionado = TIPOS_DOCUMENTO.find(opcion => opcion.id === tipo_documento);\n   583→    let texto_documento = documento_seleccionado ? documento_seleccionado.nombre : 'Documento no encontrado';\n   584→\n   585→    if (numero_documento === \"\" || email === \"\") {\n   586→        mostrarToast('danger', 'Debe rellenar los datos del participante.')\n   587→        return;\n   588→    }\n   589→\n   590→    if (!validateEmail(email)) {\n   591→        mostrarToast('danger', 'El correo del participante no es valido.')\n   592→        return;\n   593→    }\n   594→\n   595→    fila = `\n   596→        <tr class=\"tr-contenido-participante\">\n   597→            <td class=\"justify-content-center\">${texto_documento}</td>\n   598→            <td class=\"justify-content-center\">${numero_documento}</td>\n   599→            <td class=\"justify-content-center\">${email}</td>\n   600→            <td class=\"text-center\">\n   601→                <input type=\"hidden\" name=\"participantes[]['documento']\" value=\"${numero_documento}\">\n   602→                <input type=\"hidden\" name=\"participantes[]['email']\" value=\"${email}\">\n   603→                ${crearBoton({\n   604→                    type: 'button',\n   605→                    clases: 'btn-text-danger remove-btn',\n   606→                    texto: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"18\" fill=\"currentColor\" class=\"bi bi-trash-fill text-danger\" viewBox=\"0 0 16 18\">\n   607→                                <path class=\"text-danger\" d=\"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0\"/>\n   608→                            </svg>`,\n   609→                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'Eliminar participante', toggle: `popover`,})}`,\n   610→                })}\n   611→            </td>\n   612→        </tr>\n   613→    `;\n   614→\n   615→    // Esto es para pausar la funcion de verificar las agendas existentes y si se quiere usar o no las pruebas anteriores\n   616→    pintarFila();\n   617→    return;\n   618→    let html = `\n   619→        ${crearAlerta('info', `El candidato identificado con ${texto_documento} Nro. <strong> ${numero_documento}</strong>, Ya aplicó estas pruebas desea usarlas para este proceso?`)}\n   620→        <div class=\"mt-2 col-6 d-flex justify-content-center\">\n   621→            ${crearBoton({\n   622→                id: 'usar-pruebas-btn',\n   623→                clases: 'btn-primary w-50 d-flex justify-content-center',\n   624→                texto: 'Usar pruebas',\n   625→                type: 'button',\n   626→            })}\n   627→        </div>\n   628→        <div class=\"mt-2 col-6 d-flex justify-content-center\">\n   629→            ${crearBoton({\n   630→                id: 'ignorar-pruebas-btn',\n   631→                clases: 'btn-text-gray w-50 d-flex justify-content-center',\n   632→                texto: 'No usar',\n   633→                type: 'button',\n   634→            })}\n   635→        </div>\n   636→    `;\n   637→\n   638→    let envio_pruebas = null;\n   639→    if (typeof pruebas !== 'undefined' && pruebas !== null) {\n   640→        envio_pruebas = pruebas[$('#proceso_id').val()];\n   641→    } else if (typeof pruebas_guardar !== 'undefined' && pruebas_guardar !== null) {\n   642→        envio_pruebas = pruebas_guardar;\n   643→    }\n   644→\n   645→    $.ajax({\n   646→        url : `/agendas-participante`,\n   647→        type: 'POST',\n   648→        data: {\n   649→            _token : $('input[name=\"_token\"]').val(),\n   650→            _method: 'POST',\n   651→            documento : numero_documento,\n   652→            empresa_id: $(\"#empresa_sesion_id\").val(),\n   653→            prueba_ids : envio_pruebas,\n   654→            proceso_id: $(\"#proceso_id\").val(),\n   655→        }\n   656→    }).then((respuesta) => {\n   657→        if (respuesta.data.length == 0) {\n   658→            pintarFila();\n   659→        } else {\n   660→            $(\"#mensaje-candidato\").append(html);\n   661→        }\n   662→    }).catch((error) => {\n   663→        console.log(error);\n   664→    });\n   665→\n   666→}\n   667→\n   668→/**\n   669→ * Obtener los datos de los participantes agregados en el formulario.\n   670→ *\n   671→ * @returns {Array} Datos de los participantes.\n   672→ * @author Daniel Beltrán\n   673→ * @author Andres Morales\n   674→ */\n   675→function obtenerDatosParticipantes() {\n   676→    let participantes = [];\n   677→\n   678→    $('.tr-contenido-participante').each(function() {\n   679→        let documento = $(this).find(\"input[name=\\\"participantes[]['documento']\\\"]\").val();\n   680→        let email = $(this).find(\"input[name=\\\"participantes[]['email']\\\"]\").val();\n   681→\n   682→        if (documento && email) {\n   683→            participantes.push({ documento: documento, email: email });\n   684→        }\n   685→    });\n   686→\n   687→    return participantes;\n   688→}\n   689→\n   690→/**\n   691→ * Obtener la plantilla de correo para los participantes.\n   692→ *\n   693→ * @param {number} empresa_id ID de la empresa.\n   694→ * @param {boolean} despliega_modal Indica si se debe desplegar el modal.\n   695→ * @returns {Array} Datos de los participantes.\n   696→ * @author Jair Carvajal\n   697→ * @author Daniel Beltrán\n   698→ */\n   699→function obtenerPlantilla(empresa_id, despliega_modal = false) {\n   700→    $.ajax({\n   701→        url : `/plantilla-correo`,\n   702→        type: 'GET',\n   703→        data: {\n   704→            empresa_id         : empresa_id,\n   705→            plantilla_correo_id: 15\n   706→        }\n   707→    }).then((respuesta) => {\n   708→        titulo_mensaje    = respuesta.data.titulo;\n   709→        contenido_mensaje = respuesta.data.contenido;\n   710→        maneja_empresa    = respuesta.data.con_logo_empresa;\n   711→\n   712→        $('#titulo_mensaje').val(respuesta.data.titulo);\n   713→        $('#descripcion_mensaje').data('editor').setData(respuesta.data.contenido);\n   714→\n   715→        if (maneja_empresa == '1') $('#con_logo').prop('checked', true);\n   716→        if (despliega_modal) {\n   717→            $('#modal-agregar-participantes').modal('show');\n   718→        }\n   719→    }).catch((error) => {\n   720→        mostrarToast('danger', 'Error al consultar la plantilla');\n   721→    });\n   722→}\n   723→\n   724→/**\n   725→ * Mostrar el modal de compartir acceso.\n   726→ *\n   727→ * @param {Object} usuario Información del participante.\n   728→ * @returns {void}\n   729→ * @author Andres Morales\n   730→ * @author Daniel Beltrán\n   731→ */\n   732→function modalCompartirAcceso(usuario) {\n   733→    $.ajax({\n   734→        url : `/generar-acceso-usuario/${usuario.id}`,\n   735→        type: 'POST',\n   736→        data: {\n   737→            _token: $('meta[name=\"csrf-token\"]').attr('content')\n   738→        }\n   739→    }).done((respuesta) => {\n   740→        $('#enlace-acceso').attr('href', respuesta.data.enlace);\n   741→        $('#enlace-acceso').text(respuesta.data.enlace);\n   742→        $('.enlace-acceso').data('texto', respuesta.data.enlace);\n   743→    }).fail((error) => {\n   744→        mostrarToast('danger', 'Ocurrió un error al generar el enlace de acceso');\n   745→    });\n   746→\n   747→    $('#modal-compartir-acceso #imagen_usuario').attr('src', '/usuarios-imagen/'+usuario.id);\n   748→    $('#modal-compartir-acceso #nombre').html(`ID ${usuario.id} - ${usuario.nombre}`);\n   749→    $('#modal-compartir-acceso #correo').html(`<i class=\"bi bi-envelope me-2\"></i> ${usuario.email}`);\n   750→    $('#modal-detalle-participante').modal('hide');\n   751→    $('#modal-compartir-acceso').modal('show');\n   752→}\n   753→\n   754→/**\n   755→ * Abrir el modal para mover de proceso.\n   756→ *\n   757→ * @param {array} informacion ID del participante.\n   758→ * @param {string} nombre_tabla Nombre de la tabla de participantes.\n   759→ * @returns {void}\n   760→ * @author Andres Morales\n   761→ */\n   762→function abrirModalMoverDeProceso(informacion, nombre_tabla) {\n   763→    if (informacion.masivo) {\n   764→        $('#modal-mover-proceso #nombre_persona_mover').parent().parent().hide();\n   765→    } else {\n   766→        window[nombre_tabla + '_seleccionados'] = [];\n   767→        var participante_completo = window[nombre_tabla + '_ids'].find(p => p.id === informacion.id);\n   768→        window[nombre_tabla + '_seleccionados'] = [participante_completo || informacion];\n   769→        $('#modal-mover-proceso #nombre_persona_mover').parent().parent().show();\n   770→        $('#modal-mover-proceso #nombre_persona_mover').text(`ID ${informacion.id} - ${informacion.nombre}`);\n   771→    }\n   772→\n   773→    $('#modal-mover-proceso').data('nombre-tabla', nombre_tabla);\n   774→\n   775→    inicializarSelect2Asincrono('proceso_id_asincrono', 'procesos-listado', 'nombre', { id: 'id', nombre: 'nombre'}, true, {\n   776→        empresa_id: PROCESO.empresa_id,\n   777→        excluir_id: PROCESO.id\n   778→    });\n   779→    $('#formulario-mover-proceso')[0].reset();\n   780→    $('#modal-mover-proceso #select2-proceso_id_asincrono-container').empty();\n   781→\n   782→    $('#modal-detalle-participante').modal('hide');\n   783→    $('#modal-mover-proceso').modal('show');\n   784→}\n   785→\n   786→/**\n   787→ * Mover participante de proceso.\n   788→ *\n   789→ * @returns {Promise<void>}\n   790→ * @author Daniel Beltrán\n   791→ * @author Andres Morales\n   792→ */\n   793→async function moverDeProceso() {\n   794→    var nombre_tabla = $('#modal-mover-proceso').data('nombre-tabla');\n   795→\n   796→    if (!nombre_tabla || !window[nombre_tabla + '_seleccionados'] || window[nombre_tabla + '_seleccionados'].length === 0) {\n   797→        mostrarToast('danger', 'No hay participantes seleccionados para mover.');\n   798→        return;\n   799→    }\n   800→\n   801→    const DATOS = new FormData();\n   802→    DATOS.append('_token', $('input[name=\"_token\"]').val());\n   803→    DATOS.append('proceso_actual_id', PROCESO.id);\n   804→    DATOS.append('proceso_destino_id', $('#proceso_id_asincrono').val());\n   805→    DATOS.append('participantes', JSON.stringify(window[nombre_tabla + '_seleccionados'].map(p => p.id)));\n   806→    DATOS.append('mantener_en_proceso', ($('#mantener_en_proceso').prop('checked') ? 1 : 0));\n   807→\n   808→    if ($('#modal-mover-proceso #es_fecha').prop('checked') == 1) {\n   809→        DATOS.append('fecha_vencimiento_agendas',($('#modal-mover-proceso #fecha_vencimiento_agendas').val()).replace(\" \", \"T\"));\n   810→        if (!$('#modal-mover-proceso #fecha_vencimiento_agendas').val()) { mostrarToast('danger', 'Debe ingresar una fecha de vencimiento.');return; }\n   811→    } else if ($('#modal-mover-proceso #es_dias').prop('checked') == 1) {\n   812→        DATOS.append('dias_vencimiento_agendas', $('#modal-mover-proceso #dias_vencimiento_agendas').val());\n   813→        if (!$('#modal-mover-proceso #dias_vencimiento_agendas').val()) { mostrarToast('danger', 'Debe ingresar cantidad de dias.');return; }\n   814→    }\n   815→\n   816→    await $.ajax({\n   817→        url : `/participantes-cambiar-proceso`,\n   818→        type: 'POST',\n   819→        data: DATOS,\n   820→        processData: false,\n   821→        contentType: false\n   822→    }).done(function (respuesta) {\n   823→        window[nombre_tabla + '_seleccionados'] = [];\n   824→        $('#modal-mover-proceso').modal('hide');\n   825→        $('#formulario-mover-proceso').trigger('reset');\n   826→        mostrarToast('success', respuesta.message);\n   827→        actualizarDatatables(nombre_tabla);\n   828→        validarSeleccionados(nombre_tabla);\n   829→    }).fail(function (error) {\n   830→        mostrarToast('danger', error.responseJSON?.message || error.message || 'Error al mover participantes');\n   831→    });\n   832→}\n   833→\n   834→/**\n   835→ * Descargar plantilla Excel para agendamiento masiva de participantes.\n   836→ *\n   837→ * @returns {void}\n   838→ * @author Fahibram Cárcamo\n   839→ */\n   840→function descargarPlantillaAgendamientoMasivo() {\n   841→    $.ajax({\n   842→        url: '/procesos-descargar-guia-agendamiento-masivo',\n   843→        type: 'GET',\n   844→        xhrFields: {\n   845→            responseType: 'blob'\n   846→        },\n   847→        success: function(data, status, xhr) {\n   848→            let nombre_archivo = 'archivo_guia_para_carga_masiva_de_participantes.xlsx';\n   849→            let disposicion_contenido = xhr.getResponseHeader('Content-Disposition');\n   850→\n   851→            if (disposicion_contenido) {\n   852→                let nombre_archivo_match = disposicion_contenido.match(/filename=\"(.+)\"/);\n   853→                if (nombre_archivo_match) nombre_archivo = nombre_archivo_match[1];\n   854→            }\n   855→\n   856→            let blob = new Blob([data], {type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});\n   857→\n   858→            let url = window.URL.createObjectURL(blob);\n   859→            let link = document.createElement('a');\n   860→            link.href = url;\n   861→            link.download = nombre_archivo;\n   862→            document.body.appendChild(link);\n   863→            link.click();\n   864→            window.URL.revokeObjectURL(url);\n   865→            document.body.removeChild(link);\n   866→        },\n   867→        error: function(xhr, status, error) {\n   868→            let mensaje_error = 'Ocurrió un error al descargar el archivo';\n   869→\n   870→            try {\n   871→                if (xhr.responseJSON && xhr.responseJSON.message) mensaje_error = xhr.responseJSON.message;\n   872→                else if (xhr.responseJSON && xhr.responseJSON.errors) mensaje_error = xhr.responseJSON.errors;\n   873→            } catch (error) {\n   874→                // Si no se puede parsear la respuesta JSON, usar mensaje por defecto\n   875→            }\n   876→\n   877→            Swal.fire({\n   878→                showCloseButton: true,\n   879→                closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n   880→                showConfirmButton: false,\n   881→                showDenyButton: false,\n   882→                showCancelButton: false,\n   883→                html: `\n   884→                    <div class=\"row w-100 mx-0 mt-2\">\n   885→                        <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Error al descargar</div>\n   886→                        <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">${mensaje_error}</div>\n   887→                        <div class=\"col-12 mt-5 mb-2\">\n   888→                            ${crearBoton({\n   889→                                clases: 'btn-primary w-100 justify-content-center',\n   890→                                texto: 'Entendido',\n   891→                                onclick: 'Swal.close();'\n   892→                            })}\n   893→                        </div>\n   894→                    </div>\n   895→                `\n   896→            });\n   897→        }\n   898→    });\n   899→}\n   900→\n   901→/**\n   902→ * Muestra modal para archivar o desarchivar un proceso.\n   903→ *\n   904→ * @param {number} id ID del proceso.\n   905→ * @param {number} activo Estado activo del proceso (1 = activo, 0 = archivado).\n   906→ * @returns {void}\n   907→ * @author Andres Morales\n   908→ */\n   909→function archivarDesarchivarProceso(id, activo) {\n   910→    let es_activo = activo == 1;\n   911→    let titulo = es_activo ? '¿Seguro que deseas archivar?' : '¿Seguro que deseas desarchivar?';\n   912→    let mensaje = es_activo\n   913→        ? 'Estás a punto de archivar este proceso.'\n   914→        : 'Estás a punto de desarchivar este proceso.';\n   915→    let texto_boton = es_activo ? 'Archivar' : 'Desarchivar';\n   916→\n   917→    Swal.fire({\n   918→        showCloseButton: true,\n   919→        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n   920→        showConfirmButton: false,\n   921→        showDenyButton: false,\n   922→        showCancelButton: false,\n   923→        html: `\n   924→            <div class=\"row w-100 mx-0 mt-2\">\n   925→                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">${titulo}</div>\n   926→                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">${mensaje}</div>\n   927→                <div class=\"col-6 mt-5 mb-2\">\n   928→                    ${crearBoton({\n   929→                        clases: 'btn-outline-primary w-100 justify-content-center',\n   930→                        texto: 'Cancelar',\n   931→                        onclick: `Swal.clickDeny();`\n   932→                    })}\n   933→                </div>\n   934→                <div class=\"col-6 mt-5 mb-2\">\n   935→                    ${crearBoton({\n   936→                        clases: 'btn-primary w-100 justify-content-center',\n   937→                        texto: texto_boton,\n   938→                        onclick: `Swal.clickConfirm();`\n   939→                    })}\n   940→                </div>\n   941→            </div>\n   942→        `,\n   943→    }).then(async (result) => {\n   944→        if (result.isConfirmed) {\n   945→            await ejecutarArchivarProceso(id, function() {\n   946→                if (typeof actualizarDatatables !== 'undefined' && typeof nombre_tabla_procesos !== 'undefined') {\n   947→                    actualizarDatatables(nombre_tabla_procesos);\n   948→                }\n   949→            });\n   950→        }\n   951→    });\n   952→}\n   953→\n   954→/**\n   955→ * Ejecutar el archivado o desarchivado de un proceso.\n   956→ *\n   957→ * @param {number} id ID del proceso.\n   958→ * @param {Function} callback Función a ejecutar después de archivar.\n   959→ * @returns {Promise<void>}\n   960→ * @author Andres Morales\n   961→ */\n   962→async function ejecutarArchivarProceso(id, callback) {\n   963→    await $.ajax({\n   964→        url : '/procesos-archivar',\n   965→        type: 'PUT',\n   966→        data: {\n   967→            _token: $('input[name=\"_token\"]').val(),\n   968→            id: id\n   969→        }\n   970→    }).then((respuesta) => {\n   971→        mostrarToast('success', respuesta.message);\n   972→        if (callback && typeof callback === 'function') {\n   973→            callback();\n   974→        }\n   975→    }).catch(() => {\n   976→        mostrarToast('danger', 'Ocurrió un error al archivar el proceso');\n   977→    });\n   978→}\n   979→\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"55d76e90-1901-407b-952b-492fc1f64f50","timestamp":"2026-01-29T14:26:07.057Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\procesos\\procesos.js","content":"const configuracion_tablas = {\n    autoWidth: false,\n    responsive: true,\n    processing: false,\n    serverSide: false,\n    searching: true,\n    deferRender: true,\n    paging: true,\n    aaSorting: [],\n    language: lenguaje_componente_datatables,\n    lengthMenu: [\n        [10, 25, 50, 100, 200],\n        [10, 25, 50, 100, 200]\n    ],\n    pageLength: 10,\n    scrollX: true,\n    scrollY: 'calc(100vh)',\n    scrollCollapse: true\n};\n\nconst TIPOS_DOCUMENTO = [\n    {id: '1', nombre: 'Cédula de ciudadanía'},\n    {id: '2', nombre: 'Tarjeta de identidad'},\n    {id: '3', nombre: 'Pasaporte'},\n    {id: '4', nombre: 'Cédula de extranjería'}\n];\n\nconst ESTADOS_PROCESOS = {\n    '1': crearTag({ texto: 'Pendiente', class: 'text-label-1 tag-filled-yellow'}),\n    '2': crearTag({ texto: 'Activo', class: 'text-label-1 tag-filled-blue'}),\n    '3': crearTag({ texto: 'Completada', class: 'text-label-1 tag-filled-green'}),\n    '4': crearTag({ texto: 'Cerrado', class: 'text-label-1 tag-filled-gray'}),\n    '5': crearTag({ texto: 'Suspendido', class: 'text-label-1 tag-filled-purple'}),\n};\n\nconst PRIORIDAD_PROCESOS = {\n    '1': crearTag({ texto: '<i class=\"bi bi-chevron-down me-2\"></i>Baja <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-blue'}),\n    '2': crearTag({ texto: '<i class=\"bi bi-dash-lg me-2\"></i>Media <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-yellow'}),\n    '3': crearTag({ texto: '<i class=\"bi bi-chevron-up me-2\"></i>Alta <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-orange'}),\n    '4': crearTag({ texto: '<i class=\"bi bi-chevron-double-up me-2\"></i>Urgente <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-red'}),\n    'null': crearTag({ texto: 'Sin prioridad <i class=\"bi bi-caret-down-fill ms-1\"></i>', class: 'text-label-1 tag-tonal-gray'}),\n};\n\nconst ESTADO_PARTICIPANTES = {\n    '9': crearTag({ texto: 'En pruebas', class: 'px-4 text-center text-label-1 tag-tonal-orange'}),\n    '10': crearTag({ texto: 'Seleccionado', class: 'px-4 text-center text-label-1 tag-tonal-green'}),\n    '11': crearTag({ texto: 'Descartado', class: 'px-4 text-center text-label-1 tag-tonal-red'}),\n};\nconst ESTADO_PRUEBAS = {\n    '1': crearTag({ texto: 'Invalidada', class: 'px-4 text-center text-label-2 tag-tonal-gray'}),\n    '2': crearTag({ texto: 'Recomendado', class: 'px-4 text-center text-label-2 tag-tonal-green'}),\n    '3': crearTag({ texto: 'Sin iniciar', class: 'px-4 text-center text-label-2 tag-tonal-blue'}),\n    '4': crearTag({ texto: 'Sugerido', class: 'px-4 text-center text-label-2 tag-tonal-yellow'}),\n    '5': crearTag({ texto: 'No recomendado', class: 'px-4 text-center text-label-2 tag-tonal-red'}),\n};\nconst ESTADO_AGENDAS = {\n    '1': crearTag({ texto: 'Sin iniciar', class: 'px-4 text-center text-label-1 tag-tonal-blue'}),\n    '2': crearTag({ texto: 'Iniciada', class: 'px-4 text-center text-label-1 tag-tonal-yellow'}),\n    '3': crearTag({ texto: 'Finalizada', class: 'px-4 text-center text-label-1 tag-tonal-green'}),\n    '4': crearTag({ texto: 'Expirada', class: 'px-4 text-center text-label-1 tag-tonal-red'}),\n    '5': crearTag({ texto: 'Invalidada', class: 'px-4 text-center text-label-1 tag-tonal-gray'}),\n    '6': crearTag({ texto: 'Sin pago', class: 'px-4 text-center text-label-1 tag-tonal-purple'}),\n};\n\nconst convertirFecha = fecha => {\n    if (!fecha) return \"\";\n    fecha = String(fecha).substring(0, 10);\n    return fecha.includes('-') ? fecha.split('-').reverse().join('-') : \"Formato incorrecto\";\n};\n\n/**\n * Crear tag de estado de agenda con tooltip si el estado requiere fechas.\n *\n * @param {object} agenda Objeto agenda con estado_id, fecha_inicio y fecha_cierre.\n * @returns {string} HTML del tag con o sin tooltip.\n * @author Sergio Vargas\n */\nfunction crearTagEstadoAgenda(agenda) {\n    const estados_config = {\n        '1': { texto: 'Sin iniciar', class: 'px-4 text-center text-label-1 tag-tonal-blue', mostrar_fechas: true },\n        '2': { texto: 'Iniciada', class: 'px-4 text-center text-label-1 tag-tonal-yellow', mostrar_fechas: true },\n        '3': { texto: 'Finalizada', class: 'px-4 text-center text-label-1 tag-tonal-green', mostrar_fechas: false },\n        '4': { texto: 'Expirada', class: 'px-4 text-center text-label-1 tag-tonal-red', mostrar_fechas: true },\n        '5': { texto: 'Invalidada', class: 'px-4 text-center text-label-1 tag-tonal-gray', mostrar_fechas: false },\n        '6': { texto: 'Sin pago', class: 'px-4 text-center text-label-1 tag-tonal-purple', mostrar_fechas: false },\n    };\n\n    const estado_id = String(agenda.estado_id);\n    const config = estados_config[estado_id];\n\n    if (!config) {\n        return crearTag({ texto: 'Desconocido', class: 'px-4 text-center text-label-1 tag-tonal-gray' });\n    }\n\n    let tooltip_content = '';\n    if (config.mostrar_fechas && agenda.fecha_inicio && agenda.fecha_cierre) {\n        const fecha_inicio_formateada = convertirFecha(agenda.fecha_inicio);\n        const fecha_cierre_formateada = convertirFecha(agenda.fecha_cierre);\n        tooltip_content = `Fecha inicio: ${fecha_inicio_formateada}<br>Fecha fin: ${fecha_cierre_formateada}`;\n    }\n\n    if (tooltip_content) {\n        return `\n            <div class=\"tag ${config.class} text-label-1\" data-bs-toggle=\"tooltip\" data-bs-html=\"true\" data-bs-placement=\"top\" title=\"${tooltip_content}\">\n                ${config.texto}\n            </div>\n        `;\n    } else {\n        return crearTag({ texto: config.texto, class: config.class });\n    }\n}\n\nlet fila = \"\";\nlet titulo_mensaje = '';\nlet contenido_mensaje = '';\nlet maneja_empresa = '';\n\n$(document).ready(() => {\n    obtenerFuncionalidadesActivasPlan();\n    configurarFormulario(\"formulario-compartir-procesos\");\n\n    $(document).on(\"click\", '#usar-pruebas-btn', function() {\n        mostrarToast('success', 'Pruebas usadas EN DESARROLLO.');\n    });\n    $(document).on(\"click\", '#agregar-participantes-btn', function() {\n        $(\"#mensaje-candidato\").empty();\n        agregarCamposParticipante();\n    });\n    $(document).on(\"click\", '#ignorar-pruebas-btn', function() {\n        pintarFila();\n    });\n\n    $(document).on(\"click\", \".remove-btn\", function() {\n        $(this).closest(\"tr\").remove();\n    });\n    $('#contenedor-vigencia-pruebas [name=\"vigencia_pruebas\"]').change(function () {\n        var vigencia_codigo = $(this).val();\n        switch (vigencia_codigo) {\n            case '0':\n                $('#contenedor-vigencia-pruebas #contenedor-input-es-dias').removeClass('d-none');\n                $('#contenedor-vigencia-pruebas #contenedor-input-es-fecha').addClass('d-none');\n                break;\n            case '1':\n                $('#contenedor-vigencia-pruebas #contenedor-input-es-dias').addClass('d-none');\n                $('#contenedor-vigencia-pruebas #contenedor-input-es-fecha').removeClass('d-none');\n                break;\n        }\n    });\n    $('#modal-mover-proceso [name=\"vigencia_pruebas\"]').change(function () {\n        var vigencia_codigo = $(this).val();\n        switch (vigencia_codigo) {\n            case '0':\n                $('#modal-mover-proceso #contenedor-input-es-dias').removeClass('d-none');\n                $('#modal-mover-proceso #contenedor-input-es-fecha').addClass('d-none');\n                break;\n            case '1':\n                $('#modal-mover-proceso #contenedor-input-es-dias').addClass('d-none');\n                $('#modal-mover-proceso #contenedor-input-es-fecha').removeClass('d-none');\n                break;\n        }\n    });\n    $('#modal-reagendar [name=\"vigencia_pruebas\"]').change(function () {\n        var vigencia_codigo = $(this).val();\n        switch (vigencia_codigo) {\n            case '0':\n                $('#modal-reagendar #contenedor-input-es-horas').addClass('d-none');\n                $('#modal-reagendar #contenedor-input-es-dias').removeClass('d-none');\n                $('#modal-reagendar #contenedor-input-es-fecha').addClass('d-none');\n                break;\n            case '1':\n                $('#modal-reagendar #contenedor-input-es-horas').addClass('d-none');\n                $('#modal-reagendar #contenedor-input-es-dias').addClass('d-none');\n                $('#modal-reagendar #contenedor-input-es-fecha').removeClass('d-none');\n                break;\n        }\n    });\n\n    $('#modal-agregar-participantes').find('.modal-body').addClass('px-0 pt-0');\n    if (window.location.href.includes(\"create\") || window.location.href.includes(\"edit\")) {\n        obtenerPlantilla(empresa_id);\n    }\n});\n\n/**\n * Agrega valores al dataform.\n *\n * @param {array} datos_formulario Datos del evento success.\n * @returns {void}\n * @author Jair Carvajal\n * @author Andres Morales\n */\nfunction agregarDataForm(datos_formulario) {\n    const rawValue = datos_formulario.get('emails_destinatarios');\n    const fecha = datos_formulario.get('fecha_hora_expiracion').trim();\n    datos_formulario.delete('emails_destinatarios');\n    datos_formulario.delete('fecha_hora_expiracion');\n\n    datos_formulario.append('fecha_hora_expiracion', `${fecha} 00:00:00`);\n    rawValue.split(',')\n        .map(correo => correo.trim())\n        .filter(correo => correo.length > 0)\n        .forEach(correo => {\n            datos_formulario.append('emails_destinatarios[]', correo);\n        });\n\n    return datos_formulario;\n}\n\n/**\n * Pintar las filas de los participantes en la tabla.\n *\n * @returns {void}\n * @author Jair Carvajal\n * @author Andres Morales\n */\nfunction pintarFila() {\n    $(\"#tabla-participantes\").append(fila);\n    $(\"#numero_documento\").val(\"\");\n    $(\"#correo_electronico\").val(\"\");\n    $(\"#mensaje-candidato\").empty();\n}\n\n/**\n * Ejecutar cuando el formulario se envía correctamente.\n *\n * @param {array} evento Datos del evento success.\n * @returns {void}\n * @author Jair Carvajal\n */\nfunction postSuccess(evento) {\n    mostrarToast('success', 'Proceso compartido exitosamente.');\n    $('#modal-compartir-procesos').modal('hide');\n}\n\n/**\n * Ejecutar cuando el formulario se envía correctamente.\n *\n * @param {string} cadenaCorreos strign con los correos para validarlos.\n * @returns {void}\n * @author Jair Carvajal\n */\nfunction validarCorreos(cadenaCorreos) {\n    let correos = cadenaCorreos\n        .split(',')\n        .map(c => c.trim())\n        .filter(c => c.length > 0);\n    let regex_correo = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n\n    let todos_validos = correos.every(correo => regex_correo.test(correo));\n\n    return todos_validos;\n}\n\n/**\n * Crear boton adicional para ckeditor.\n *\n * @returns {html} botón adicional para ckeditor.\n * @author Andres Morales\n */\nfunction botonAdicionalCkeditor(id) {\n    return `\n        <div class=\"border-start border-black border-2 px-2 my-0 dropdown\">\n            ${crearBoton({\n                clases: 'dropdown-toggle text-body-3 btn-dropdown-ckeditor',\n                texto: 'Agregar variable<i class=\"bi bi-chevron-down text-body-3 ms-2\"></i>',\n                data: [{texto: 'bs-toggle', value: 'dropdown'},{texto: 'bs-auto-close', value: 'outside'},]\n            })}\n            <div class=\"dropdown-menu bg-white\">\n                <button type=\"button\" class=\"dropdown-item-ckeditor p-2\" onclick=\"agregarVariable('__nombre_participante__')\">Nombre participante</button>\n                <button type=\"button\" class=\"dropdown-item-ckeditor p-2\" onclick=\"agregarVariable('__nombre_empresa__')\">Nombre empresa</button>\n                <button type=\"button\" class=\"dropdown-item-ckeditor p-2\" onclick=\"agregarVariable('__nombre_proceso__')\">Nombre proceso</button>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Agrega la variable en cuestion en el ckeditor.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction agregarVariable(variable) {\n    let texto = $('#descripcion_mensaje').data('editor').getData()\n    $('#descripcion_mensaje').data('editor').setData(texto + variable);\n}\n\n/**\n * Valida el email ingresado para ingresar participantes.\n *\n * @returns {boolean} Si el email cumple con la estructura.\n * @author Andres Morales\n */\nfunction validateEmail(email) {\n    let re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return re.test(email);\n}\n\n/**\n * Realizar validación adicional de un formulario para activar o desactivar pasos.\n *\n * @param {string} formulario Identificador del formulario.\n * @returns {boolean} True si los correos son válidos, false en caso contrario.\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction validacionAdicional(formulario) {\n    if (!validarCorreos($(\"#email\").val())) {\n        mostrarToast('danger', 'Hay correos inválidos, validalos y vuelve a intentar.');\n        return false;\n    }\n    return true;\n}\n\n/**\n * Abrir modal para agregar participantes.\n *\n * @param {number} id ID del proceso.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Andres Morales\n */\nfunction abrirModalAgregarParticipantes(id) {\n    let proceso = null;\n\n    if (typeof PROCESO !== 'undefined' && PROCESO && PROCESO.id == id) {\n        proceso = PROCESO;\n    } else if (typeof procesos_datos_ids !== 'undefined' && procesos_datos_ids && Array.isArray(procesos_datos_ids)) {\n        proceso = procesos_datos_ids.find(p => p.id == id);\n    }\n\n    if (proceso && proceso.fecha_cierre) {\n        let fecha_cierre = new Date(proceso.fecha_cierre);\n        let fecha_actual = new Date();\n\n        fecha_cierre.setHours(23, 59, 59, 999);\n        fecha_actual.setHours(0, 0, 0, 0);\n\n        let dias_restantes = Math.floor((fecha_cierre - fecha_actual) / (1000 * 60 * 60 * 24));\n\n        if (dias_restantes <= 3) {\n            Swal.fire({\n                showCloseButton: true,\n                closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n                showConfirmButton: false,\n                showDenyButton: false,\n                showCancelButton: false,\n                html: `\n                    <div class=\"row w-100 mx-0 mt-2\">\n                        <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Tiempo insuficiente</div>\n                        <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">Faltan 3 días o menos para la fecha de vencimiento y no hay suficiente tiempo para agendar pruebas.</div>\n                        <div class=\"col-12 mt-5 mb-2\">\n                            ${crearBoton({\n                                clases: 'btn-primary w-100 justify-content-center',\n                                texto: 'Entendido',\n                                onclick:`Swal.close();`\n                            })}\n                        </div>\n                    </div>\n                `,\n            });\n            return;\n        }\n    }\n\n    $('#modal-agregar-participantes #proceso_id').val(id);\n    obtenerPlantilla(proceso.empresa_id, true);\n}\n\n/**\n * Abrir modal para agendar participantes de forma masiva en el proceso.\n *\n * @param {number} id Id del proceso.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction abrirModalAgendamientoMasivo(id) {\n    $('#modal-agendamiento-masivo #proceso_id').val(id);\n    $('#modal-agendamiento-masivo').modal('show');\n}\n\n/**\n * Realiza la petición AJAX al end-point que extrae los datos de los participantes del proceso\n * contenidos en el archivo Excel cargado y los retorna en formato JSON para ser agendados de forma\n * masiva posteriormente.\n *\n * @returns {Promise<void>}\n * @author Fahibram Cárcamo\n */\nasync function extraerDatosParticipantes() {\n    let archivo = $('#archivo_datos_participantes')[0].files[0];\n\n    if (!archivo) {\n        mostrarToast('danger', 'Debe seleccionar un archivo Excel para procesar.');\n        return;\n    }\n\n    const datos_formulario = new FormData();\n    datos_formulario.append('_token', $('input[name=\"_token\"]').val());\n    datos_formulario.append('proceso_id', $('#modal-agendamiento-masivo #proceso_id').val());\n    datos_formulario.append('archivo', archivo);\n\n    $('#modal-agendamiento-masivo #boton-guardar').html('Cargando...');\n\n    await $.ajax({\n        url: '/procesos-extraer-datos-participantes',\n        type: 'POST',\n        data: datos_formulario,\n        processData: false,\n        contentType: false\n    }).done(function(respuesta) {\n        $('#modal-agendamiento-masivo').modal('hide');\n        $('#modal-agregar-participantes').modal('show');\n        $('#modal-agregar-participantes #proceso_id').val($('#modal-agendamiento-masivo #proceso_id').val());\n        obtenerPlantilla(PROCESO.empresa_id);\n        agregarParticipantesMasivamente(respuesta.datos_participantes);\n    }).fail(function(error) {\n        let mensaje_error = 'Ocurrió un error al procesar el archivo';\n\n        if (error.responseJSON && error.responseJSON.errors) {\n            mensaje_error = error.responseJSON.errors;\n        } else if (error.responseJSON && error.responseJSON.message) {\n            mensaje_error = error.responseJSON.message;\n        }\n\n        mostrarToast('danger', mensaje_error);\n    });\n\n    $('#modal-agendamiento-masivo #boton-guardar').html('<i class=\"bi bi-upload me-2\"></i>Cargar');\n}\n\n/**\n * Agregar participantes masivamente en el modal `#modal-agregar-participantes`.\n *\n * @param {array} datos_participantes Arreglo con los datos de los participantes a agregar.\n * @author Fahibram Cárcamo\n */\nfunction agregarParticipantesMasivamente(datos_participantes) {\n    datos_participantes.forEach(participante => {\n        let documento_seleccionado = TIPOS_DOCUMENTO.find(opcion => parseInt(opcion.id) === participante.tipo_documento_id);\n        let texto_documento = documento_seleccionado ? documento_seleccionado.nombre : 'Documento no encontrado';\n\n        fila = `\n            <tr class=\"tr-contenido-participante\">\n                <td class=\"justify-content-center\">${texto_documento}</td>\n                <td class=\"justify-content-center\">${participante.documento}</td>\n                <td class=\"justify-content-center\">${participante.email}</td>\n                <td class=\"text-center\">\n                    <input type=\"hidden\" name=\"participantes[]['documento']\" value=\"${participante.documento}\">\n                    <input type=\"hidden\" name=\"participantes[]['email']\" value=\"${participante.email}\">\n                    ${crearBoton({\n                        type: 'button',\n                        clases: 'btn-text-danger remove-btn',\n                        texto: `\n                            <svg\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                width=\"16\"\n                                height=\"18\"\n                                fill=\"currentColor\"\n                                class=\"bi bi-trash-fill text-danger\"\n                                viewBox=\"0 0 16 18\"\n                            >\n                                <path class=\"text-danger\" d=\"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0\"/>\n                            </svg>\n                        `,\n                        tooltip: `${crearTooltip({ placement: `bottom`, content: 'Eliminar participante', toggle: `popover`,})}`,\n                    })}\n                </td>\n            </tr>\n        `;\n\n        pintarFila();\n    });\n}\n\n/**\n * Abrir modal para agregar participantes.\n *\n * @param {number} id ID del proceso.\n * @param {number|null} aplicante_id ID del participante (opcional).\n * @returns {void}\n * @author Jair Carvajal\n * @author Andres Morales\n * @author Andres Gonzalez\n */\nfunction abrirModalCompartirProceso(id, aplicante_id = null) {\n    if (!buscarFuncionalidad('compartir_proceso_interesados')) {\n        modalFuncionalidadInactiva();\n        return;\n    }\n\n    $('#modal-compartir-procesos #proceso_id').val(id);\n    if (aplicante_id != null) {\n        $('#aplicante_id').val(aplicante_id);\n        $('#formulario-compartir-procesos').attr('action', '/procesos-compartir-resultados-aplicante');\n    } else {\n        $('#formulario-compartir-procesos').attr('action', '/procesos-compartir/' + id);\n    }\n\n    $('#modal-compartir-procesos').modal('show');\n\n    $('#modal-compartir-procesos').off('hidden.bs.modal').on('hidden.bs.modal', function () {\n        $('#formulario-compartir-procesos')[0].reset();\n    });\n}\n\n/**\n * Guardar los nuevos participantes del proceso.\n *\n * @returns {Promise<void>}\n * @author Daniel Beltrán\n * @author Andres Morales\n * @author Andres Gonzalez\n */\nasync function guardarParticipantes() {\n    let titulo_mensaje =  $('#formulario-agregar-participantes #titulo_mensaje').val();\n    let descripcion_mensaje =  $('#formulario-agregar-participantes #descripcion_mensaje').data('editor').getData();\n    let arrayElementos = $('.tr-contenido-participante').length ? $('.tr-contenido-participante').toArray() : [];\n    if (arrayElementos.length === 0) {\n        mostrarToast('danger', 'Debe agregar al menos un participante.');\n        return;\n    }\n    if (descripcion_mensaje.length > 800) {\n        mostrarToast('danger', 'El campo descripción del mensaje no puede superar los 800 caracteres.');\n        $('#boton-guardar').removeAttr('disabled');\n        return;\n    }\n    let fechaActual = new Date();\n    fechaActual.setDate(fechaActual.getDate() + 5);\n    let fechaFormateada = fechaActual.toISOString().slice(0, 16);\n\n    const DATOS = new FormData();\n    DATOS.append('_token', $('input[name=\"_token\"]').val());\n    DATOS.append('proceso_id',$('#formulario-agregar-participantes #proceso_id').val());\n    DATOS.append('vigencia_pruebas', 1);\n    DATOS.append('dias_vencimiento_agendas', 5);\n    DATOS.append('fecha_vencimiento_agendas', fechaFormateada);\n    DATOS.append('titulo_mensaje', titulo_mensaje);\n    DATOS.append('descripcion_mensaje', descripcion_mensaje);\n    if ($('#con_logo').is(':checked')) {\n        maneja_empresa = \"1\";\n    } else {\n        maneja_empresa = \"0\";\n    }\n    DATOS.append('maneja_empresa', maneja_empresa);\n    DATOS.append('participantes', JSON.stringify(obtenerDatosParticipantes()));\n\n    await $.ajax({\n        url        : `/procesos-participantes/${$('#proceso_id').val()}`,\n        type       : 'POST',\n        data       : DATOS,\n        processData: false,\n        contentType: false\n    }).then((respuesta) => {\n        mostrarToast('success', respuesta.message);\n        $('#modal-agregar-participantes').modal('hide');\n        $('#formulario-agregar-participantes')[0].reset();\n        $('#formulario-agregar-participantes #tabla-participantes').empty();\n\n        if (window.location.pathname === '/procesos') {\n            actualizarDatatables('tabla-pruebas-psicometricas');\n        } else if (window.location.pathname.startsWith('/procesos/')) {\n            actualizarDatatables('tabla_participantes');\n        }\n    }).catch((error) => {\n        mostrarToast('danger', error.responseJSON.errors);\n    });\n}\n\n/**\n * Agregar fila de campos para un participante.\n *\n * @returns {void}\n * @author Andres Morales\n * @author Fahibram Cárcamo\n */\nfunction agregarCamposParticipante() {\n    let tipo_documento = $(\"#tipo_documento\").val();\n    let numero_documento = $(\"#numero_documento\").val().trim();\n    let email = $(\"#correo_electronico\").val().trim();\n\n    let documento_seleccionado = TIPOS_DOCUMENTO.find(opcion => opcion.id === tipo_documento);\n    let texto_documento = documento_seleccionado ? documento_seleccionado.nombre : 'Documento no encontrado';\n\n    if (numero_documento === \"\" || email === \"\") {\n        mostrarToast('danger', 'Debe rellenar los datos del participante.')\n        return;\n    }\n\n    if (!validateEmail(email)) {\n        mostrarToast('danger', 'El correo del participante no es valido.')\n        return;\n    }\n\n    fila = `\n        <tr class=\"tr-contenido-participante\">\n            <td class=\"justify-content-center\">${texto_documento}</td>\n            <td class=\"justify-content-center\">${numero_documento}</td>\n            <td class=\"justify-content-center\">${email}</td>\n            <td class=\"text-center\">\n                <input type=\"hidden\" name=\"participantes[]['documento']\" value=\"${numero_documento}\">\n                <input type=\"hidden\" name=\"participantes[]['email']\" value=\"${email}\">\n                ${crearBoton({\n                    type: 'button',\n                    clases: 'btn-text-danger remove-btn',\n                    texto: `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"18\" fill=\"currentColor\" class=\"bi bi-trash-fill text-danger\" viewBox=\"0 0 16 18\">\n                                <path class=\"text-danger\" d=\"M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5M8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5m3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0\"/>\n                            </svg>`,\n                    tooltip: `${crearTooltip({ placement: `bottom`, content: 'Eliminar participante', toggle: `popover`,})}`,\n                })}\n            </td>\n        </tr>\n    `;\n\n    // Esto es para pausar la funcion de verificar las agendas existentes y si se quiere usar o no las pruebas anteriores\n    pintarFila();\n    return;\n    let html = `\n        ${crearAlerta('info', `El candidato identificado con ${texto_documento} Nro. <strong> ${numero_documento}</strong>, Ya aplicó estas pruebas desea usarlas para este proceso?`)}\n        <div class=\"mt-2 col-6 d-flex justify-content-center\">\n            ${crearBoton({\n                id: 'usar-pruebas-btn',\n                clases: 'btn-primary w-50 d-flex justify-content-center',\n                texto: 'Usar pruebas',\n                type: 'button',\n            })}\n        </div>\n        <div class=\"mt-2 col-6 d-flex justify-content-center\">\n            ${crearBoton({\n                id: 'ignorar-pruebas-btn',\n                clases: 'btn-text-gray w-50 d-flex justify-content-center',\n                texto: 'No usar',\n                type: 'button',\n            })}\n        </div>\n    `;\n\n    let envio_pruebas = null;\n    if (typeof pruebas !== 'undefined' && pruebas !== null) {\n        envio_pruebas = pruebas[$('#proceso_id').val()];\n    } else if (typeof pruebas_guardar !== 'undefined' && pruebas_guardar !== null) {\n        envio_pruebas = pruebas_guardar;\n    }\n\n    $.ajax({\n        url : `/agendas-participante`,\n        type: 'POST',\n        data: {\n            _token : $('input[name=\"_token\"]').val(),\n            _method: 'POST',\n            documento : numero_documento,\n            empresa_id: $(\"#empresa_sesion_id\").val(),\n            prueba_ids : envio_pruebas,\n            proceso_id: $(\"#proceso_id\").val(),\n        }\n    }).then((respuesta) => {\n        if (respuesta.data.length == 0) {\n            pintarFila();\n        } else {\n            $(\"#mensaje-candidato\").append(html);\n        }\n    }).catch((error) => {\n        console.log(error);\n    });\n\n}\n\n/**\n * Obtener los datos de los participantes agregados en el formulario.\n *\n * @returns {Array} Datos de los participantes.\n * @author Daniel Beltrán\n * @author Andres Morales\n */\nfunction obtenerDatosParticipantes() {\n    let participantes = [];\n\n    $('.tr-contenido-participante').each(function() {\n        let documento = $(this).find(\"input[name=\\\"participantes[]['documento']\\\"]\").val();\n        let email = $(this).find(\"input[name=\\\"participantes[]['email']\\\"]\").val();\n\n        if (documento && email) {\n            participantes.push({ documento: documento, email: email });\n        }\n    });\n\n    return participantes;\n}\n\n/**\n * Obtener la plantilla de correo para los participantes.\n *\n * @param {number} empresa_id ID de la empresa.\n * @param {boolean} despliega_modal Indica si se debe desplegar el modal.\n * @returns {Array} Datos de los participantes.\n * @author Jair Carvajal\n * @author Daniel Beltrán\n */\nfunction obtenerPlantilla(empresa_id, despliega_modal = false) {\n    $.ajax({\n        url : `/plantilla-correo`,\n        type: 'GET',\n        data: {\n            empresa_id         : empresa_id,\n            plantilla_correo_id: 15\n        }\n    }).then((respuesta) => {\n        titulo_mensaje    = respuesta.data.titulo;\n        contenido_mensaje = respuesta.data.contenido;\n        maneja_empresa    = respuesta.data.con_logo_empresa;\n\n        $('#titulo_mensaje').val(respuesta.data.titulo);\n        $('#descripcion_mensaje').data('editor').setData(respuesta.data.contenido);\n\n        if (maneja_empresa == '1') $('#con_logo').prop('checked', true);\n        if (despliega_modal) {\n            $('#modal-agregar-participantes').modal('show');\n        }\n    }).catch((error) => {\n        mostrarToast('danger', 'Error al consultar la plantilla');\n    });\n}\n\n/**\n * Mostrar el modal de compartir acceso.\n *\n * @param {Object} usuario Información del participante.\n * @returns {void}\n * @author Andres Morales\n * @author Daniel Beltrán\n */\nfunction modalCompartirAcceso(usuario) {\n    $.ajax({\n        url : `/generar-acceso-usuario/${usuario.id}`,\n        type: 'POST',\n        data: {\n            _token: $('meta[name=\"csrf-token\"]').attr('content')\n        }\n    }).done((respuesta) => {\n        $('#enlace-acceso').attr('href', respuesta.data.enlace);\n        $('#enlace-acceso').text(respuesta.data.enlace);\n        $('.enlace-acceso').data('texto', respuesta.data.enlace);\n    }).fail((error) => {\n        mostrarToast('danger', 'Ocurrió un error al generar el enlace de acceso');\n    });\n\n    $('#modal-compartir-acceso #imagen_usuario').attr('src', '/usuarios-imagen/'+usuario.id);\n    $('#modal-compartir-acceso #nombre').html(`ID ${usuario.id} - ${usuario.nombre}`);\n    $('#modal-compartir-acceso #correo').html(`<i class=\"bi bi-envelope me-2\"></i> ${usuario.email}`);\n    $('#modal-detalle-participante').modal('hide');\n    $('#modal-compartir-acceso').modal('show');\n}\n\n/**\n * Abrir el modal para mover de proceso.\n *\n * @param {array} informacion ID del participante.\n * @param {string} nombre_tabla Nombre de la tabla de participantes.\n * @returns {void}\n * @author Andres Morales\n */\nfunction abrirModalMoverDeProceso(informacion, nombre_tabla) {\n    if (informacion.masivo) {\n        $('#modal-mover-proceso #nombre_persona_mover').parent().parent().hide();\n    } else {\n        window[nombre_tabla + '_seleccionados'] = [];\n        var participante_completo = window[nombre_tabla + '_ids'].find(p => p.id === informacion.id);\n        window[nombre_tabla + '_seleccionados'] = [participante_completo || informacion];\n        $('#modal-mover-proceso #nombre_persona_mover').parent().parent().show();\n        $('#modal-mover-proceso #nombre_persona_mover').text(`ID ${informacion.id} - ${informacion.nombre}`);\n    }\n\n    $('#modal-mover-proceso').data('nombre-tabla', nombre_tabla);\n\n    inicializarSelect2Asincrono('proceso_id_asincrono', 'procesos-listado', 'nombre', { id: 'id', nombre: 'nombre'}, true, {\n        empresa_id: PROCESO.empresa_id,\n        excluir_id: PROCESO.id\n    });\n    $('#formulario-mover-proceso')[0].reset();\n    $('#modal-mover-proceso #select2-proceso_id_asincrono-container').empty();\n\n    $('#modal-detalle-participante').modal('hide');\n    $('#modal-mover-proceso').modal('show');\n}\n\n/**\n * Mover participante de proceso.\n *\n * @returns {Promise<void>}\n * @author Daniel Beltrán\n * @author Andres Morales\n */\nasync function moverDeProceso() {\n    var nombre_tabla = $('#modal-mover-proceso').data('nombre-tabla');\n\n    if (!nombre_tabla || !window[nombre_tabla + '_seleccionados'] || window[nombre_tabla + '_seleccionados'].length === 0) {\n        mostrarToast('danger', 'No hay participantes seleccionados para mover.');\n        return;\n    }\n\n    const DATOS = new FormData();\n    DATOS.append('_token', $('input[name=\"_token\"]').val());\n    DATOS.append('proceso_actual_id', PROCESO.id);\n    DATOS.append('proceso_destino_id', $('#proceso_id_asincrono').val());\n    DATOS.append('participantes', JSON.stringify(window[nombre_tabla + '_seleccionados'].map(p => p.id)));\n    DATOS.append('mantener_en_proceso', ($('#mantener_en_proceso').prop('checked') ? 1 : 0));\n\n    if ($('#modal-mover-proceso #es_fecha').prop('checked') == 1) {\n        DATOS.append('fecha_vencimiento_agendas',($('#modal-mover-proceso #fecha_vencimiento_agendas').val()).replace(\" \", \"T\"));\n        if (!$('#modal-mover-proceso #fecha_vencimiento_agendas').val()) { mostrarToast('danger', 'Debe ingresar una fecha de vencimiento.');return; }\n    } else if ($('#modal-mover-proceso #es_dias').prop('checked') == 1) {\n        DATOS.append('dias_vencimiento_agendas', $('#modal-mover-proceso #dias_vencimiento_agendas').val());\n        if (!$('#modal-mover-proceso #dias_vencimiento_agendas').val()) { mostrarToast('danger', 'Debe ingresar cantidad de dias.');return; }\n    }\n\n    await $.ajax({\n        url : `/participantes-cambiar-proceso`,\n        type: 'POST',\n        data: DATOS,\n        processData: false,\n        contentType: false\n    }).done(function (respuesta) {\n        window[nombre_tabla + '_seleccionados'] = [];\n        $('#modal-mover-proceso').modal('hide');\n        $('#formulario-mover-proceso').trigger('reset');\n        mostrarToast('success', respuesta.message);\n        actualizarDatatables(nombre_tabla);\n        validarSeleccionados(nombre_tabla);\n    }).fail(function (error) {\n        mostrarToast('danger', error.responseJSON?.message || error.message || 'Error al mover participantes');\n    });\n}\n\n/**\n * Descargar plantilla Excel para agendamiento masiva de participantes.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction descargarPlantillaAgendamientoMasivo() {\n    $.ajax({\n        url: '/procesos-descargar-guia-agendamiento-masivo',\n        type: 'GET',\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function(data, status, xhr) {\n            let nombre_archivo = 'archivo_guia_para_carga_masiva_de_participantes.xlsx';\n            let disposicion_contenido = xhr.getResponseHeader('Content-Disposition');\n\n            if (disposicion_contenido) {\n                let nombre_archivo_match = disposicion_contenido.match(/filename=\"(.+)\"/);\n                if (nombre_archivo_match) nombre_archivo = nombre_archivo_match[1];\n            }\n\n            let blob = new Blob([data], {type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'});\n\n            let url = window.URL.createObjectURL(blob);\n            let link = document.createElement('a');\n            link.href = url;\n            link.download = nombre_archivo;\n            document.body.appendChild(link);\n            link.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(link);\n        },\n        error: function(xhr, status, error) {\n            let mensaje_error = 'Ocurrió un error al descargar el archivo';\n\n            try {\n                if (xhr.responseJSON && xhr.responseJSON.message) mensaje_error = xhr.responseJSON.message;\n                else if (xhr.responseJSON && xhr.responseJSON.errors) mensaje_error = xhr.responseJSON.errors;\n            } catch (error) {\n                // Si no se puede parsear la respuesta JSON, usar mensaje por defecto\n            }\n\n            Swal.fire({\n                showCloseButton: true,\n                closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n                showConfirmButton: false,\n                showDenyButton: false,\n                showCancelButton: false,\n                html: `\n                    <div class=\"row w-100 mx-0 mt-2\">\n                        <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Error al descargar</div>\n                        <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">${mensaje_error}</div>\n                        <div class=\"col-12 mt-5 mb-2\">\n                            ${crearBoton({\n                                clases: 'btn-primary w-100 justify-content-center',\n                                texto: 'Entendido',\n                                onclick: 'Swal.close();'\n                            })}\n                        </div>\n                    </div>\n                `\n            });\n        }\n    });\n}\n\n/**\n * Muestra modal para archivar o desarchivar un proceso.\n *\n * @param {number} id ID del proceso.\n * @param {number} activo Estado activo del proceso (1 = activo, 0 = archivado).\n * @returns {void}\n * @author Andres Morales\n */\nfunction archivarDesarchivarProceso(id, activo) {\n    let es_activo = activo == 1;\n    let titulo = es_activo ? '¿Seguro que deseas archivar?' : '¿Seguro que deseas desarchivar?';\n    let mensaje = es_activo\n        ? 'Estás a punto de archivar este proceso.'\n        : 'Estás a punto de desarchivar este proceso.';\n    let texto_boton = es_activo ? 'Archivar' : 'Desarchivar';\n\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">${titulo}</div>\n                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">${mensaje}</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.clickDeny();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: texto_boton,\n                        onclick: `Swal.clickConfirm();`\n                    })}\n                </div>\n            </div>\n        `,\n    }).then(async (result) => {\n        if (result.isConfirmed) {\n            await ejecutarArchivarProceso(id, function() {\n                if (typeof actualizarDatatables !== 'undefined' && typeof nombre_tabla_procesos !== 'undefined') {\n                    actualizarDatatables(nombre_tabla_procesos);\n                }\n            });\n        }\n    });\n}\n\n/**\n * Ejecutar el archivado o desarchivado de un proceso.\n *\n * @param {number} id ID del proceso.\n * @param {Function} callback Función a ejecutar después de archivar.\n * @returns {Promise<void>}\n * @author Andres Morales\n */\nasync function ejecutarArchivarProceso(id, callback) {\n    await $.ajax({\n        url : '/procesos-archivar',\n        type: 'PUT',\n        data: {\n            _token: $('input[name=\"_token\"]').val(),\n            id: id\n        }\n    }).then((respuesta) => {\n        mostrarToast('success', respuesta.message);\n        if (callback && typeof callback === 'function') {\n            callback();\n        }\n    }).catch(() => {\n        mostrarToast('danger', 'Ocurrió un error al archivar el proceso');\n    });\n}\n","numLines":979,"startLine":1,"totalLines":979}},"sourceToolAssistantUUID":"dc4f1c59-8f5e-4732-9470-f33d4969d3ed"}
{"parentUuid":"55d76e90-1901-407b-952b-492fc1f64f50","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01DkzKp7icXiNfkYg4sw421p","toolUseID":"toolu_01DkzKp7icXiNfkYg4sw421p","timestamp":"2026-01-29T14:26:07.058Z","uuid":"3b6f398e-ce4f-4f8f-95b2-23b933605340"}
{"parentUuid":"3b6f398e-ce4f-4f8f-95b2-23b933605340","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_011UWBEzaEE9SUXXKtomKs7m","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Ahora tengo todo el contexto necesario. Voy a implementar la funcionalidad del modal de advertencia de créditos. \n\nEl plan es:\n1. Modificar la función `obtenerCreditosDisponiblesEmpresa()` en `globales.js` para verificar si debe mostrar el modal\n2. Crear una nueva función `mostrarModalAdvertenciaCreditosDisponibles()` para mostrar el modal\n3. Usar localStorage para guardar qué umbrales ya se han mostrado y no mostrar el mismo modal múltiples veces\n4. El modal solo se debe mostrar al ingresar a la ruta `/procesos`\n\nSegún el diseño de Figma:\n- Título: \"Solicita más créditos\"\n- Descripción: \"Tu saldo está por debajo del X% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.\"\n- Botón \"Cancelar\" (outline azul)\n- Botón \"Solicitar más créditos\" (azul filled)\n\nVoy a usar el sistema de modales existente con `crearModal()`.\n\nPara la lógica:\n- Los umbrales son: 20%, 10%, 5%, 0%\n- Debo guardar en localStorage qué umbrales ya se han mostrado\n- Debo resetear esto cuando cambien los créditos (o por sesión)\n\nImplementación:\n1. Agregar variable para controlar si ya se mostró el modal en esta sesión\n2. Crear función para determinar el umbral actual\n3. Crear función para mostrar el modal\n4. Integrar en `obtenerCreditosDisponiblesEmpresa()` \n5. Agregar el modal al HTML (lo agregaré dinámicamente con JS)\n\nVoy a implementar esto en `globales.js` ya que es donde está la función existente.","signature":"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"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":20260,"cache_read_input_tokens":61720,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":20260},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpkUsD2wFTnSUCzCaR1","type":"assistant","uuid":"18ab2d64-9a8e-4e97-aadf-ea470afc91c6","timestamp":"2026-01-29T14:26:18.847Z"}
{"parentUuid":"18ab2d64-9a8e-4e97-aadf-ea470afc91c6","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_011UWBEzaEE9SUXXKtomKs7m","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora tengo todo el contexto necesario. Voy a implementar la funcionalidad del modal de advertencia de créditos. La lógica será:\n\n1. Verificar el porcentaje de créditos al cargar la página `/procesos`\n2. Si está en umbrales críticos (20%, 10%, 5%, 0%), mostrar el modal una vez por sesión\n3. Usar `sessionStorage` para evitar mostrar el modal múltiples veces en la misma sesión"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":20260,"cache_read_input_tokens":61720,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":20260},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpkUsD2wFTnSUCzCaR1","type":"assistant","uuid":"303c1793-41d6-4ae3-bd15-9a14c6b31611","timestamp":"2026-01-29T14:26:20.639Z"}
{"parentUuid":"303c1793-41d6-4ae3-bd15-9a14c6b31611","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_011UWBEzaEE9SUXXKtomKs7m","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01VdNfktWSeUmMY478vemKz7","name":"Edit","input":{"replace_all":false,"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","old_string":"let mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];","new_string":"let mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n// Umbrales para mostrar el modal de advertencia de créditos (en porcentaje)\nconst UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0];"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":20260,"cache_read_input_tokens":61720,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":20260},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpkUsD2wFTnSUCzCaR1","type":"assistant","uuid":"89d9a389-1488-4f41-b6c2-703fb939897d","timestamp":"2026-01-29T14:26:24.672Z"}
{"type":"file-history-snapshot","messageId":"89d9a389-1488-4f41-b6c2-703fb939897d","snapshot":{"messageId":"68f30d83-8a1a-4144-aa3d-97912336f558","trackedFileBackups":{"public\\js\\globales.js":{"backupFileName":"f7aa1ebeb3700bae@v1","version":1,"backupTime":"2026-01-29T14:26:26.953Z"}},"timestamp":"2026-01-29T14:24:19.250Z"},"isSnapshotUpdate":true}
{"parentUuid":"89d9a389-1488-4f41-b6c2-703fb939897d","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01VdNfktWSeUmMY478vemKz7","type":"tool_result","content":"The file C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js has been updated successfully."}]},"uuid":"407f99e8-6c18-4403-a3d7-f9b6b82b9b25","timestamp":"2026-01-29T14:26:26.976Z","toolUseResult":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","oldString":"let mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];","newString":"let mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n// Umbrales para mostrar el modal de advertencia de créditos (en porcentaje)\nconst UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0];","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n/**\n * Mostrar modal de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    // Verificar si el string incluye información de hora (espacio, T, o dos puntos)\n    if (!fecha_inicial.includes(\" \") && !fecha_inicial.includes(\"T\") && !fecha_inicial.includes(\":\")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n * @author Jair Carvajal\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            const NO_LEIDOS_IDS = new Set(Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id) : []);\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = NO_LEIDOS_IDS.has(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**\n * Muestra Modal para informar que no cuenta con la funcionalidad\n *.\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction modalFuncionalidadInactiva() {\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Adquiere esta funcionalidad</div>\n                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">No tienes esta funcionalidad activa. Por favor, contacta a tu asesor.</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.clickDeny();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Entiendo',\n                        onclick: `Swal.clickConfirm();`\n                    })}\n                </div>\n            </div>\n        `,\n    }).then(async (resultado) => {\n        //\n    });\n}\n\n/**\n * Busca una funcionalidad por su llave.\n *\n * @param {string} llave Llave de la funcionalidad a buscar.\n * @param {Array|null} funcionalidades funcionalidades.\n * @returns {boolean}\n * @author Andres Gonzalez\n */\nfunction buscarFuncionalidad(llave, funcionalidades = null) {\n    let datos = funcionalidades ?? funcionalidades_disponibles_empresa;\n\n    if (!Array.isArray(datos) || datos.length === 0) {\n        return false;\n    }\n\n    return datos.some(item => item?.funcionalidad?.llave === llave);\n}\n","structuredPatch":[{"oldStart":37,"oldLines":6,"newStart":37,"newLines":9,"lines":[" "," let funcionalidades_disponibles_empresa = [];"," ","+// Umbrales para mostrar el modal de advertencia de créditos (en porcentaje)","+const UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0];","+"," /**","  * Mostrar modal de créditos IA","  *"]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"89d9a389-1488-4f41-b6c2-703fb939897d"}
{"type":"queue-operation","operation":"enqueue","timestamp":"2026-01-29T14:26:30.130Z","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","content":"ten en cuenta que obtenerCreditosDisponiblesEmpresa en globales.js ya calcula cuanto queda"}
{"parentUuid":"407f99e8-6c18-4403-a3d7-f9b6b82b9b25","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01M14PfJKjuuxSFFnYfedZtV","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Ahora voy a agregar las funciones para verificar y mostrar el modal de advertencia de créditos. Voy a agregar estas funciones después de la función `obtenerCreditosDisponiblesEmpresa()`.","signature":"EuYCCkYICxgCKkDnpgQ0Oa1mW3VlZnyzI6Zwq3Syy6Z4lTC0R5RSwVdqikyjawnfifE/ZNi68hboXTExi4tf8Kw2g6IGfWVHokF4Egw4YYOaUojX31dcTToaDPPtt9fx4kmEm4GX1iIwzrgAeo8QSI3V81yjyrlryqnUTryqU4tmyR1uEguPyYOKgJl+akl4sEm4bIFjHKUSKs0Bwb1lV2/fZYZK529j2S2m8VVvn6v5otuBBpvqDfss5mIlaDHLxxO7cUiXUCieCJKDg4rMy9+kyoMnlqnfo5r3fVWmeg2gsEeEmdt8cdvalMCG30ATwgFo+y0aVDxPeYFkk19deeoUT32U+O05je9Fm5T0g9V0uSJNT+e7WZqtn1eWwiRAGO/LSMor1VKhPJ/tukojtYsX3aAPoCZheZvCY033YddLLaLZG+3WkX/hb+obYPcu9IGhyjaUQzstxIF73XQUrterWjZ0XtoIpBgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":929,"cache_read_input_tokens":81980,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":929},"output_tokens":8,"service_tier":"standard"}},"requestId":"req_011CXbpmxWeWSuDATuZzHBPj","type":"assistant","uuid":"a15c4dc4-9d72-40c5-8bc4-8b10c5fef4c8","timestamp":"2026-01-29T14:26:30.347Z"}
{"type":"queue-operation","operation":"enqueue","timestamp":"2026-01-29T14:26:46.647Z","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","content":"y quiero que por cada umbral lo muestre 1 sola vez por dia"}
{"type":"queue-operation","operation":"enqueue","timestamp":"2026-01-29T14:26:55.492Z","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","content":"si baja al siguiente vuelve a salir ese dia"}
{"parentUuid":"a15c4dc4-9d72-40c5-8bc4-8b10c5fef4c8","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01M14PfJKjuuxSFFnYfedZtV","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01RVvfRZQcx21fsdkQz4z1qY","name":"Edit","input":{"replace_all":false,"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","old_string":"/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}","new_string":"/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @param {boolean} verificar_modal Si se debe verificar si mostrar el modal de advertencia\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos', verificar_modal = false) {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n\n                // Verificar si se debe mostrar el modal de advertencia\n                if (verificar_modal && plan_credito !== null) {\n                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);\n                }\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por sesión para cada umbral alcanzado.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Verificar si ya se mostró el modal para este umbral en esta sesión\n    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;\n\n    if (sessionStorage.getItem(llave_sesion)) {\n        return;\n    }\n\n    // Marcar como mostrado y mostrar el modal\n    sessionStorage.setItem(llave_sesion, 'true');\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}\n\n/**\n * Mostrar el modal de advertencia de créditos disponibles.\n *\n * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {\n    let mensaje_descripcion = umbral === 0\n        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'\n        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;\n\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>\n                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.close();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Solicitar más créditos',\n                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`\n                    })}\n                </div>\n            </div>\n        `,\n    });\n}\n\n/**\n * Solicitar más créditos desde el modal de advertencia.\n * Contacta al ejecutivo de la empresa via WhatsApp.\n *\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction solicitarMasCreditosDesdeModal(empresa_id) {\n    $.ajax({\n        url: `/empresas/${empresa_id}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            Swal.close();\n        },\n        error: function() {\n            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');\n            Swal.close();\n        }\n    });\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":929,"cache_read_input_tokens":81980,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":929},"output_tokens":8,"service_tier":"standard"}},"requestId":"req_011CXbpmxWeWSuDATuZzHBPj","type":"assistant","uuid":"186a6bf0-fb71-470d-bd71-97fe77eb6f57","timestamp":"2026-01-29T14:27:04.911Z"}
{"type":"queue-operation","operation":"remove","timestamp":"2026-01-29T14:27:32.945Z","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b"}
{"type":"queue-operation","operation":"remove","timestamp":"2026-01-29T14:27:32.945Z","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b"}
{"type":"queue-operation","operation":"remove","timestamp":"2026-01-29T14:27:32.945Z","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b"}
{"parentUuid":"186a6bf0-fb71-470d-bd71-97fe77eb6f57","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01RVvfRZQcx21fsdkQz4z1qY","type":"tool_result","content":"The file C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js has been updated successfully."}]},"uuid":"3cb39893-2ca4-4ff4-9259-1cb412348b7f","timestamp":"2026-01-29T14:27:32.276Z","toolUseResult":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","oldString":"/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}","newString":"/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @param {boolean} verificar_modal Si se debe verificar si mostrar el modal de advertencia\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos', verificar_modal = false) {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n\n                // Verificar si se debe mostrar el modal de advertencia\n                if (verificar_modal && plan_credito !== null) {\n                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);\n                }\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por sesión para cada umbral alcanzado.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Verificar si ya se mostró el modal para este umbral en esta sesión\n    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;\n\n    if (sessionStorage.getItem(llave_sesion)) {\n        return;\n    }\n\n    // Marcar como mostrado y mostrar el modal\n    sessionStorage.setItem(llave_sesion, 'true');\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}\n\n/**\n * Mostrar el modal de advertencia de créditos disponibles.\n *\n * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {\n    let mensaje_descripcion = umbral === 0\n        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'\n        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;\n\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>\n                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.close();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Solicitar más créditos',\n                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`\n                    })}\n                </div>\n            </div>\n        `,\n    });\n}\n\n/**\n * Solicitar más créditos desde el modal de advertencia.\n * Contacta al ejecutivo de la empresa via WhatsApp.\n *\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction solicitarMasCreditosDesdeModal(empresa_id) {\n    $.ajax({\n        url: `/empresas/${empresa_id}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            Swal.close();\n        },\n        error: function() {\n            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');\n            Swal.close();\n        }\n    });\n}","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n// Umbrales para mostrar el modal de advertencia de créditos (en porcentaje)\nconst UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0];\n\n/**\n * Mostrar modal de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    // Verificar si el string incluye información de hora (espacio, T, o dos puntos)\n    if (!fecha_inicial.includes(\" \") && !fecha_inicial.includes(\"T\") && !fecha_inicial.includes(\":\")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n * @author Jair Carvajal\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            const NO_LEIDOS_IDS = new Set(Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id) : []);\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = NO_LEIDOS_IDS.has(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**\n * Muestra Modal para informar que no cuenta con la funcionalidad\n *.\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction modalFuncionalidadInactiva() {\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Adquiere esta funcionalidad</div>\n                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">No tienes esta funcionalidad activa. Por favor, contacta a tu asesor.</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.clickDeny();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Entiendo',\n                        onclick: `Swal.clickConfirm();`\n                    })}\n                </div>\n            </div>\n        `,\n    }).then(async (resultado) => {\n        //\n    });\n}\n\n/**\n * Busca una funcionalidad por su llave.\n *\n * @param {string} llave Llave de la funcionalidad a buscar.\n * @param {Array|null} funcionalidades funcionalidades.\n * @returns {boolean}\n * @author Andres Gonzalez\n */\nfunction buscarFuncionalidad(llave, funcionalidades = null) {\n    let datos = funcionalidades ?? funcionalidades_disponibles_empresa;\n\n    if (!Array.isArray(datos) || datos.length === 0) {\n        return false;\n    }\n\n    return datos.some(item => item?.funcionalidad?.llave === llave);\n}\n","structuredPatch":[{"oldStart":1414,"oldLines":11,"newStart":1414,"newLines":12,"lines":["  *","  * @param {number} empresa_id ID de la empresa","  * @param {string} contenedor_id ID del contenedor donde se mostrará el tag","+ * @param {boolean} verificar_modal Si se debe verificar si mostrar el modal de advertencia","  * @returns {void}","  * @author Andres Gonzalez","  * @author Daniel Beltrán","  */","-function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos') {","+function obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos', verificar_modal = false) {","     if (!empresa_id || !$(`#${contenedor_id}`).length) {","         return;","     }"]},{"oldStart":1456,"oldLines":6,"newStart":1457,"newLines":11,"lines":["                     class: clase_tag,","                     icono_final: icono_final,","                 }));","+","+                // Verificar si se debe mostrar el modal de advertencia","+                if (verificar_modal && plan_credito !== null) {","+                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);","+                }","             } else {","                 $(`#${contenedor_id}`).html(crearTag({","                     texto: 'No tienes plan de créditos',"]},{"oldStart":1475,"oldLines":6,"newStart":1481,"newLines":115,"lines":[" }"," "," /**","+ * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.","+ * Los umbrales son: 20%, 10%, 5% y 0%.","+ * El modal solo se muestra una vez por sesión para cada umbral alcanzado.","+ *","+ * @param {number} porcentaje_disponible Porcentaje de créditos disponibles","+ * @param {number} empresa_id ID de la empresa","+ * @returns {void}","+ * @author Sergio Vargas","+ */","+function verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {","+    // Determinar el umbral actual alcanzado","+    let umbral_actual = null;","+","+    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {","+        if (porcentaje_disponible <= umbral) {","+            umbral_actual = umbral;","+        } else {","+            break;","+        }","+    }","+","+    // Si no se alcanzó ningún umbral, no mostrar el modal","+    if (umbral_actual === null) {","+        return;","+    }","+","+    // Verificar si ya se mostró el modal para este umbral en esta sesión","+    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;","+","+    if (sessionStorage.getItem(llave_sesion)) {","+        return;","+    }","+","+    // Marcar como mostrado y mostrar el modal","+    sessionStorage.setItem(llave_sesion, 'true');","+    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);","+}","+","+/**","+ * Mostrar el modal de advertencia de créditos disponibles.","+ *","+ * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)","+ * @param {number} empresa_id ID de la empresa","+ * @returns {void}","+ * @author Sergio Vargas","+ */","+function mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {","+    let mensaje_descripcion = umbral === 0","+        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'","+        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;","+","+    Swal.fire({","+        showCloseButton: true,","+        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',","+        showConfirmButton: false,","+        showDenyButton: false,","+        showCancelButton: false,","+        html: `","+            <div class=\"row w-100 mx-0 mt-2\">","+                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>","+                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>","+                <div class=\"col-6 mt-5 mb-2\">","+                    ${crearBoton({","+                        clases: 'btn-outline-primary w-100 justify-content-center',","+                        texto: 'Cancelar',","+                        onclick: `Swal.close();`","+                    })}","+                </div>","+                <div class=\"col-6 mt-5 mb-2\">","+                    ${crearBoton({","+                        clases: 'btn-primary w-100 justify-content-center',","+                        texto: 'Solicitar más créditos',","+                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`","+                    })}","+                </div>","+            </div>","+        `,","+    });","+}","+","+/**","+ * Solicitar más créditos desde el modal de advertencia.","+ * Contacta al ejecutivo de la empresa via WhatsApp.","+ *","+ * @param {number} empresa_id ID de la empresa","+ * @returns {void}","+ * @author Sergio Vargas","+ */","+function solicitarMasCreditosDesdeModal(empresa_id) {","+    $.ajax({","+        url: `/empresas/${empresa_id}`,","+        method: 'GET',","+        dataType: 'json',","+        success: function(respuesta) {","+            if (respuesta?.data?.ejecutivo?.telefono) {","+                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');","+            } else {","+                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');","+            }","+            Swal.close();","+        },","+        error: function() {","+            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');","+            Swal.close();","+        }","+    });","+}","+","+/**","  * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.","  *","  * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional)."]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"186a6bf0-fb71-470d-bd71-97fe77eb6f57"}
{"parentUuid":"3cb39893-2ca4-4ff4-9259-1cb412348b7f","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01FmWicHa78YfFxGL6aFwkXW","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"El usuario quiere que:\n1. Cada umbral se muestre solo 1 vez por día (no por sesión)\n2. Si baja al siguiente umbral, debe mostrar el nuevo modal ese mismo día\n\nEsto significa que debo usar `localStorage` con una fecha de expiración en lugar de `sessionStorage`. Y la llave debe incluir el umbral específico, no solo marcar que se mostró.\n\nVoy a modificar la función `verificarYMostrarModalAdvertenciaCreditosDisponibles()` para usar localStorage con expiración diaria.","signature":"EoMFCkYICxgCKkAnUKs+tmfI6NMmXH1OBscRgDtQQmf3gN5lsFoDu8Gt1Pwr4Q0grggsAbA1SnSz6ZZTSJrsWhi9xcgr3YA+toWyEgxdM+2DjLw3Dpw0IEEaDN03YRGC6yhtAuWB8yIw77cs1La61Dko+0E5tp/2CdFHdL/4GbQFTP9KT4EXPmSXb6nbcb6Z8FSjyrncBiTCKuoDgIwZxS/gzqNBze46Q2byS3Le2m/BYe/ZSuxQImPMc2Fj4S5IUBExnjzdkT0JNiTrWAd1w24f9KKS98Cp87XBdxFbqDNltFI5FJ7jJpyhOmvvJTUCWFI2Bvc8Gf9rlJM61I6SDogh/ZBneDsswS5MdEsSLh5BJy1I7bDjCKpeXvlHgrgcn4/Aw/aeZg2WCd5ji/GGmZ14JWvUwO+9fVgPitkKVSO4j/bLVuOMdDC3jfrng17Dtv7CIkTR3IZAK1l7a1zWn4xGE+xSFWRnTItQcqcQFUXBsliKjJyyFeufeNeKQ+d4Yb5eq+SUmWoxFjWlihz3Wtb/1o4vkbN0/kLN/pFVdDFWpsTver1op6ISCpRzriuIk8ohWqb50SZughaduUWXXOcvuch6A/RE/IKUW9aoltt8m7gBgWy3Z4RCyCfa1YFAnNgTha1VFPUqmYcIZK0iNs/dz/ucrh84oQ5j/6ouISm0RbKrnSVdjCmrEvT6uG0ejtw5so/6JydlWhEKGz5mg5jOTUh+LmkNkJN5x6iawyaDCKvHnr5C3ZlKY8+mZrqnF+16xIV79jhdlQUCgSDl6QiZLJLn6dN/lWU6JTJHmB3tPr2mIqcuRUJ8PhuIeqibEPq7nJO5iXUmmEKweqbafzt51/OvzRgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":3782,"cache_read_input_tokens":82909,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":3782},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXbproWJXUt6qVeb3bGwN","type":"assistant","uuid":"c850b2c6-22c9-4d1f-adf8-44ab61d92b63","timestamp":"2026-01-29T14:27:38.309Z"}
{"parentUuid":"c850b2c6-22c9-4d1f-adf8-44ab61d92b63","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01FmWicHa78YfFxGL6aFwkXW","type":"message","role":"assistant","content":[{"type":"text","text":"Entendido. Voy a modificar la lógica para que cada umbral se muestre solo 1 vez por día, pero si baja a un umbral más bajo, se muestre ese nuevo umbral aunque ya se haya mostrado otro umbral ese día."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":3782,"cache_read_input_tokens":82909,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":3782},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXbproWJXUt6qVeb3bGwN","type":"assistant","uuid":"cbc95a76-ad6d-485d-b123-7eefb4019d76","timestamp":"2026-01-29T14:27:39.467Z"}
{"parentUuid":"cbc95a76-ad6d-485d-b123-7eefb4019d76","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01FmWicHa78YfFxGL6aFwkXW","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01Tp2kWAHwg1sNFfegWAYTkY","name":"Edit","input":{"replace_all":false,"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","old_string":"/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por sesión para cada umbral alcanzado.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Verificar si ya se mostró el modal para este umbral en esta sesión\n    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;\n\n    if (sessionStorage.getItem(llave_sesion)) {\n        return;\n    }\n\n    // Marcar como mostrado y mostrar el modal\n    sessionStorage.setItem(llave_sesion, 'true');\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}","new_string":"/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por día para cada umbral alcanzado.\n * Si baja a un umbral más bajo, se muestra ese nuevo umbral aunque ya se haya mostrado otro ese día.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado (el más bajo que aplica)\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Obtener la fecha actual en formato YYYY-MM-DD\n    let fecha_hoy = new Date().toISOString().split('T')[0];\n    let llave_storage = `modal_creditos_${empresa_id}`;\n\n    // Obtener los datos guardados en localStorage\n    let datos_guardados = localStorage.getItem(llave_storage);\n    let umbrales_mostrados_hoy = {};\n\n    if (datos_guardados) {\n        try {\n            let datos = JSON.parse(datos_guardados);\n            // Si la fecha guardada es de hoy, usar los umbrales guardados\n            if (datos.fecha === fecha_hoy) {\n                umbrales_mostrados_hoy = datos.umbrales || {};\n            }\n            // Si es de otro día, se resetean los umbrales (objeto vacío)\n        } catch (e) {\n            // Si hay error al parsear, se resetea\n            umbrales_mostrados_hoy = {};\n        }\n    }\n\n    // Verificar si ya se mostró el modal para este umbral hoy\n    if (umbrales_mostrados_hoy[umbral_actual]) {\n        return;\n    }\n\n    // Marcar este umbral como mostrado hoy\n    umbrales_mostrados_hoy[umbral_actual] = true;\n\n    // Guardar en localStorage\n    localStorage.setItem(llave_storage, JSON.stringify({\n        fecha: fecha_hoy,\n        umbrales: umbrales_mostrados_hoy\n    }));\n\n    // Mostrar el modal\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":3782,"cache_read_input_tokens":82909,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":3782},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXbproWJXUt6qVeb3bGwN","type":"assistant","uuid":"57c3ca13-f14c-4edb-aee3-fdf8b628a6ea","timestamp":"2026-01-29T14:27:49.789Z"}
{"parentUuid":"57c3ca13-f14c-4edb-aee3-fdf8b628a6ea","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01Tp2kWAHwg1sNFfegWAYTkY","type":"tool_result","content":"The file C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js has been updated successfully."}]},"uuid":"197c3a0c-22d9-428a-babe-02d63f84a0cd","timestamp":"2026-01-29T14:28:27.212Z","toolUseResult":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","oldString":"/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por sesión para cada umbral alcanzado.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Verificar si ya se mostró el modal para este umbral en esta sesión\n    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;\n\n    if (sessionStorage.getItem(llave_sesion)) {\n        return;\n    }\n\n    // Marcar como mostrado y mostrar el modal\n    sessionStorage.setItem(llave_sesion, 'true');\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}","newString":"/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por día para cada umbral alcanzado.\n * Si baja a un umbral más bajo, se muestra ese nuevo umbral aunque ya se haya mostrado otro ese día.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado (el más bajo que aplica)\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Obtener la fecha actual en formato YYYY-MM-DD\n    let fecha_hoy = new Date().toISOString().split('T')[0];\n    let llave_storage = `modal_creditos_${empresa_id}`;\n\n    // Obtener los datos guardados en localStorage\n    let datos_guardados = localStorage.getItem(llave_storage);\n    let umbrales_mostrados_hoy = {};\n\n    if (datos_guardados) {\n        try {\n            let datos = JSON.parse(datos_guardados);\n            // Si la fecha guardada es de hoy, usar los umbrales guardados\n            if (datos.fecha === fecha_hoy) {\n                umbrales_mostrados_hoy = datos.umbrales || {};\n            }\n            // Si es de otro día, se resetean los umbrales (objeto vacío)\n        } catch (e) {\n            // Si hay error al parsear, se resetea\n            umbrales_mostrados_hoy = {};\n        }\n    }\n\n    // Verificar si ya se mostró el modal para este umbral hoy\n    if (umbrales_mostrados_hoy[umbral_actual]) {\n        return;\n    }\n\n    // Marcar este umbral como mostrado hoy\n    umbrales_mostrados_hoy[umbral_actual] = true;\n\n    // Guardar en localStorage\n    localStorage.setItem(llave_storage, JSON.stringify({\n        fecha: fecha_hoy,\n        umbrales: umbrales_mostrados_hoy\n    }));\n\n    // Mostrar el modal\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n// Umbrales para mostrar el modal de advertencia de créditos (en porcentaje)\nconst UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0];\n\n/**\n * Mostrar modal de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    // Verificar si el string incluye información de hora (espacio, T, o dos puntos)\n    if (!fecha_inicial.includes(\" \") && !fecha_inicial.includes(\"T\") && !fecha_inicial.includes(\":\")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n * @author Jair Carvajal\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            const NO_LEIDOS_IDS = new Set(Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id) : []);\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = NO_LEIDOS_IDS.has(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @param {boolean} verificar_modal Si se debe verificar si mostrar el modal de advertencia\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos', verificar_modal = false) {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n\n                // Verificar si se debe mostrar el modal de advertencia\n                if (verificar_modal && plan_credito !== null) {\n                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);\n                }\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por sesión para cada umbral alcanzado.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Verificar si ya se mostró el modal para este umbral en esta sesión\n    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;\n\n    if (sessionStorage.getItem(llave_sesion)) {\n        return;\n    }\n\n    // Marcar como mostrado y mostrar el modal\n    sessionStorage.setItem(llave_sesion, 'true');\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}\n\n/**\n * Mostrar el modal de advertencia de créditos disponibles.\n *\n * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {\n    let mensaje_descripcion = umbral === 0\n        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'\n        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;\n\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>\n                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.close();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Solicitar más créditos',\n                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`\n                    })}\n                </div>\n            </div>\n        `,\n    });\n}\n\n/**\n * Solicitar más créditos desde el modal de advertencia.\n * Contacta al ejecutivo de la empresa via WhatsApp.\n *\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction solicitarMasCreditosDesdeModal(empresa_id) {\n    $.ajax({\n        url: `/empresas/${empresa_id}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            Swal.close();\n        },\n        error: function() {\n            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');\n            Swal.close();\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**\n * Muestra Modal para informar que no cuenta con la funcionalidad\n *.\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction modalFuncionalidadInactiva() {\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Adquiere esta funcionalidad</div>\n                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">No tienes esta funcionalidad activa. Por favor, contacta a tu asesor.</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.clickDeny();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Entiendo',\n                        onclick: `Swal.clickConfirm();`\n                    })}\n                </div>\n            </div>\n        `,\n    }).then(async (resultado) => {\n        //\n    });\n}\n\n/**\n * Busca una funcionalidad por su llave.\n *\n * @param {string} llave Llave de la funcionalidad a buscar.\n * @param {Array|null} funcionalidades funcionalidades.\n * @returns {boolean}\n * @author Andres Gonzalez\n */\nfunction buscarFuncionalidad(llave, funcionalidades = null) {\n    let datos = funcionalidades ?? funcionalidades_disponibles_empresa;\n\n    if (!Array.isArray(datos) || datos.length === 0) {\n        return false;\n    }\n\n    return datos.some(item => item?.funcionalidad?.llave === llave);\n}\n","structuredPatch":[{"oldStart":1483,"oldLines":7,"newStart":1483,"newLines":8,"lines":[" /**","  * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.","  * Los umbrales son: 20%, 10%, 5% y 0%.","- * El modal solo se muestra una vez por sesión para cada umbral alcanzado.","+ * El modal solo se muestra una vez por día para cada umbral alcanzado.","+ * Si baja a un umbral más bajo, se muestra ese nuevo umbral aunque ya se haya mostrado otro ese día.","  *","  * @param {number} porcentaje_disponible Porcentaje de créditos disponibles","  * @param {number} empresa_id ID de la empresa"]},{"oldStart":1491,"oldLines":7,"newStart":1492,"newLines":7,"lines":["  * @author Sergio Vargas","  */"," function verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {","-    // Determinar el umbral actual alcanzado","+    // Determinar el umbral actual alcanzado (el más bajo que aplica)","     let umbral_actual = null;"," ","     for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {"]},{"oldStart":1507,"oldLines":15,"newStart":1508,"newLines":43,"lines":["         return;","     }"," ","-    // Verificar si ya se mostró el modal para este umbral en esta sesión","-    let llave_sesion = `modal_creditos_mostrado_${empresa_id}_${umbral_actual}`;","+    // Obtener la fecha actual en formato YYYY-MM-DD","+    let fecha_hoy = new Date().toISOString().split('T')[0];","+    let llave_storage = `modal_creditos_${empresa_id}`;"," ","-    if (sessionStorage.getItem(llave_sesion)) {","+    // Obtener los datos guardados en localStorage","+    let datos_guardados = localStorage.getItem(llave_storage);","+    let umbrales_mostrados_hoy = {};","+","+    if (datos_guardados) {","+        try {","+            let datos = JSON.parse(datos_guardados);","+            // Si la fecha guardada es de hoy, usar los umbrales guardados","+            if (datos.fecha === fecha_hoy) {","+                umbrales_mostrados_hoy = datos.umbrales || {};","+            }","+            // Si es de otro día, se resetean los umbrales (objeto vacío)","+        } catch (e) {","+            // Si hay error al parsear, se resetea","+            umbrales_mostrados_hoy = {};","+        }","+    }","+","+    // Verificar si ya se mostró el modal para este umbral hoy","+    if (umbrales_mostrados_hoy[umbral_actual]) {","         return;","     }"," ","-    // Marcar como mostrado y mostrar el modal","-    sessionStorage.setItem(llave_sesion, 'true');","+    // Marcar este umbral como mostrado hoy","+    umbrales_mostrados_hoy[umbral_actual] = true;","+","+    // Guardar en localStorage","+    localStorage.setItem(llave_storage, JSON.stringify({","+        fecha: fecha_hoy,","+        umbrales: umbrales_mostrados_hoy","+    }));","+","+    // Mostrar el modal","     mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);"," }"," "]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"57c3ca13-f14c-4edb-aee3-fdf8b628a6ea"}
{"parentUuid":"197c3a0c-22d9-428a-babe-02d63f84a0cd","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01EcqqeZcznmfy2VnAtvcRRK","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Ahora necesito asegurarme de que el modal se active específicamente cuando se ingresa a la ruta `/procesos`. Necesito modificar la vista de procesos o el archivo `procesos.js` para llamar a `obtenerCreditosDisponiblesEmpresa()` con el parámetro `verificar_modal = true`.\n\nActualmente en `globales.js`, la función se llama en el `$(document).ready()` pero no verifica la ruta ni pasa el parámetro para verificar el modal. \n\nDebo modificar esto para que:\n1. En la ruta `/procesos`, se llame con `verificar_modal = true`\n2. En otras rutas, se siga llamando normalmente sin mostrar el modal\n\nVoy a verificar primero cómo se hace esto actualmente y luego agregar la lógica para detectar la ruta `/procesos`.","signature":"EuoGCkYICxgCKkATxQ1Cim9kQnVYe89ZJ2d6otTyAaR6bw6VLeykBSHEa1kMCXPa2TSmsfan/Fs1h3ocu1BaIkDy8X5bfWfNaAN3Egznc3b1QqovBpnyyFMaDC9ONlH9IJrY9UYYlSIwCFZWIwbdGznY2SaSG9fZlAZf6kNGgMCrS/E5fhRVqtJk+NyhGrvaJWrB9Z3pK6GTKtEF9rpAy1BPFc+m/z11WFg5AcOI9LUjBMf75oMHoO+sDTNDOSLyDOCZgCSq92y9lVRgM1TJc6fb3U7ezwMDhtyWTT+Evh/rjD2ybA86VuOmv2aBDNxyFc8kfcl86r59wfuu/2okXEMz50cNrAlfx87Kwapp5EmrShm/MpYsj3JMIy9fwt5/Cd2sCv8ziYaN6Vl3OGRYJO3oB5bjwQJ9rNA2jmjdVtG+3KxSjk8SBFictkYFAmmu37gOzkTzaFq80HvLiiqrEtXbHR7g46KlXX9UGDYpQlrttAdYcGYYRpeBXYpJyMqWX1XvmvElN9ca/VYzsvRCyVtPudOZEMrzvtwXmRhaVIL1i6JCI4TO1h9mTqm6Z5qD+/65f7KWptOOdGqA/qlGzdyWdVIHcwGsbf9G7pMjE33Jr2/FLUX3SURWZOPwHzwZYEvZr47YJ3Bst9GFOhfveztCBCUjWiPzHoMGWj91I45jnOvcZ3sT3z9hNkzqb6dhWBBLtPjUwn/Ie4j+JB1l4/RKYnR6WN9J4oC6+aWxHpwcY7Ku0vHl+HawBSkRZMdZ5xcXdHkN55AFjxQfzxe7NtvDzUfOA3WDk5nzmIeacZ5F73VFrjPKKKe+hiKwI/y5Tm+cQb8A9O8KMi8N+4VkPw4sD+ivAyY5zDUG981vGYd3cilnN3hU3Va7nfRtaHocSJnJsjmTaZNp3cm9KPyj2qyl5b9cKSBtMnpA2z/wd2TFV5UldwW+VbzR/5+6KavSNA76Ee7MW89tYdvbfuG5lVy6qasHRea8W+T0DLyVacxT8tJeWzyfeV9WfSrhdEWOQl9nrm8zQdsp3XnQGjuS8mfldLZFm7TTRh9587tW3HfNuAMYKIcrXWJUb/NnCENykv52kO/rWmRi+6u+vAfLZiNVYgOmcJqhqBJliRtRU4NFfiGyRS3Rw30XpTr4kBj/AppykUpewjJarzpMyxgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1649,"cache_read_input_tokens":86691,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1649},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpvqdQUBj2dvEtGGXhx","type":"assistant","uuid":"f7e0541a-1645-48c3-975e-f46107051cc9","timestamp":"2026-01-29T14:28:36.719Z"}
{"parentUuid":"f7e0541a-1645-48c3-975e-f46107051cc9","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01EcqqeZcznmfy2VnAtvcRRK","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora necesito asegurarme de que el modal se active específicamente cuando se ingresa a la ruta `/procesos`. Voy a modificar la vista de procesos para que active esta verificación."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1649,"cache_read_input_tokens":86691,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1649},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpvqdQUBj2dvEtGGXhx","type":"assistant","uuid":"eada5444-e1bb-4fda-9c89-f1171be58ba6","timestamp":"2026-01-29T14:28:37.405Z"}
{"parentUuid":"eada5444-e1bb-4fda-9c89-f1171be58ba6","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01EcqqeZcznmfy2VnAtvcRRK","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01A8ECCtjcGxxaRjLgPkhcUH","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","offset":156,"limit":40}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1649,"cache_read_input_tokens":86691,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1649},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpvqdQUBj2dvEtGGXhx","type":"assistant","uuid":"7eadbfb3-cb06-40fd-807d-224e0dee7879","timestamp":"2026-01-29T14:28:38.128Z"}
{"parentUuid":"7eadbfb3-cb06-40fd-807d-224e0dee7879","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01A8ECCtjcGxxaRjLgPkhcUH","type":"tool_result","content":"   156→\n   157→/**\n   158→ * Ajustar el ancho de los elementos select2 asincrono multiple.\n   159→ *\n   160→ * @returns {void}\n   161→ * @author Andres Morales\n   162→ */\n   163→$(document).ready(function () {\n   164→    cargarNotificiacionesHeader();\n   165→    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n   166→        configurarWebSocketNotificaciones();\n   167→    }\n   168→    setTimeout(() => {\n   169→        $(\".input-container\").each(function () {\n   170→            let $container = $(this);\n   171→            let $select = $container.find(\"select[multiple]\");\n   172→            let $icon = $container.find(\".input-icono1\");\n   173→            if ($select.length && $icon.length) {\n   174→                $(this).find('.select2-selection--multiple').addClass('ps-5')\n   175→            }\n   176→        });\n   177→    }, 1000);\n   178→    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n   179→        if (mostro_modal_creditos_ia) {\n   180→            $(modals_abiertos_ia).removeClass('d-none');\n   181→        }\n   182→        mostro_modal_creditos_ia = false;\n   183→    });\n   184→\n   185→    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n   186→    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n   187→        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n   188→    }\n   189→});\n   190→\n   191→/**\n   192→ * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n   193→ *\n   194→ * @param {string} fecha_entrada fecha en formato ISO\n   195→ * @returns {string} fecha y hora formateada\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"27a7a55d-83b7-4cf5-b871-4d4b88fc69c6","timestamp":"2026-01-29T14:28:39.039Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","content":"\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada","numLines":40,"startLine":156,"totalLines":1701}},"sourceToolAssistantUUID":"7eadbfb3-cb06-40fd-807d-224e0dee7879"}
{"parentUuid":"27a7a55d-83b7-4cf5-b871-4d4b88fc69c6","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01A8ECCtjcGxxaRjLgPkhcUH","toolUseID":"toolu_01A8ECCtjcGxxaRjLgPkhcUH","timestamp":"2026-01-29T14:28:39.040Z","uuid":"3a46d6b4-17f0-4b92-bf1d-6d71b825c482"}
{"parentUuid":"3a46d6b4-17f0-4b92-bf1d-6d71b825c482","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HJUMfkmw9jV2X4ku8VY6dQ","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Veo que en el `$(document).ready()` de `globales.js` se llama a `obtenerCreditosDisponiblesEmpresa()` cuando existe el contenedor de créditos. Necesito modificar esta llamada para que detecte si estamos en la ruta `/procesos` y pase el parámetro `verificar_modal = true`.","signature":"EroDCkYICxgCKkD6wHUZ1pUd7t2GIy2A193sve/IayPhZ5ahz8GwcLE9rC0/j4eVx30oYj6EE936cSKeK4qHpkKB0bfVNvP3+rhiEgytAIPYThzCxQwfK/8aDIy/s10UKY8ZjQEJqiIwX+mjO7qAzP6YWIOtvYZfxseWiDdgGd1gTwv2aFyOSD+MA+M3+5M/ymZxah2wc1lGKqEC3ri8YtGATI3q/s5BNYjxEHj06ieU0aR03VwNrsNZIJVPAtD+VgNiGBUb6zAjYXO9g+MHlisNxx/YGx/9++HUvb/uTNxt2DU9omP098Xry2Zxh9qQUn4WDzIWrz7BNgmDCeNPi9PH+2Xbvqt1hynX/aS1mczHufeBroPD8Dt1knjQRn/GRTNtbKqilCe8ZZ8UrewlJo/YGgdg8Gg+TGgVAWuDtVCg2SpNKdzmF2Y+9k5ARpf1X9W3rFs36fSGLfvCYf5019bGSmb1QQoqpzjdQ8HPTdAK5CeT26XRu5Ajn2T9MT6rd71NMjCZdlZ5g6e9iSlTdBfmKjFwnuOEI/bdq/oE7/MthT0t0MKrEixCcnHI7K/ZhWQFUtCB6lh8jRnbzxgB"}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1053,"cache_read_input_tokens":88340,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1053},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpwgu5AzTYfUyqUanBE","type":"assistant","uuid":"4ca0c8ae-5e9d-4d28-81c4-71ab82d43775","timestamp":"2026-01-29T14:28:42.817Z"}
{"parentUuid":"4ca0c8ae-5e9d-4d28-81c4-71ab82d43775","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HJUMfkmw9jV2X4ku8VY6dQ","type":"message","role":"assistant","content":[{"type":"text","text":"Voy a modificar el `$(document).ready()` para detectar si estamos en la ruta `/procesos` y activar la verificación del modal."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1053,"cache_read_input_tokens":88340,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1053},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpwgu5AzTYfUyqUanBE","type":"assistant","uuid":"d70ab61a-8072-4bcd-9691-47674e27d797","timestamp":"2026-01-29T14:28:43.293Z"}
{"parentUuid":"d70ab61a-8072-4bcd-9691-47674e27d797","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01HJUMfkmw9jV2X4ku8VY6dQ","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01HJMTJqR24vqphLCHiA8CCW","name":"Edit","input":{"replace_all":false,"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","old_string":"    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});","new_string":"    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        // Verificar si estamos en la ruta /procesos para mostrar el modal de advertencia\n        let verificar_modal = window.location.pathname === '/procesos';\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val(), 'contenedor-tag-creditos', verificar_modal);\n    }\n});"}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1053,"cache_read_input_tokens":88340,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1053},"output_tokens":3,"service_tier":"standard"}},"requestId":"req_011CXbpwgu5AzTYfUyqUanBE","type":"assistant","uuid":"75e4797d-cd39-4a38-b5af-b46932cbc929","timestamp":"2026-01-29T14:28:45.719Z"}
{"parentUuid":"75e4797d-cd39-4a38-b5af-b46932cbc929","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01HJMTJqR24vqphLCHiA8CCW","type":"tool_result","content":"The file C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js has been updated successfully."}]},"uuid":"db1e25c9-6354-4817-bbd0-c57469e71f5d","timestamp":"2026-01-29T14:29:03.027Z","toolUseResult":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","oldString":"    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});","newString":"    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        // Verificar si estamos en la ruta /procesos para mostrar el modal de advertencia\n        let verificar_modal = window.location.pathname === '/procesos';\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val(), 'contenedor-tag-creditos', verificar_modal);\n    }\n});","originalFile":"// Mensajes en español para el plugin Select2\nconst mensajes_select2 = {\n    'noResults'              : () => { return 'No hay resultados para la búsqueda.'; },\n    'searching'              : () => { return 'Buscando...'; },\n    'Loading'                : () => { return 'Cargando...'; },\n    'loadingMore'            : () => { return 'Cargando más resultados...'; },\n    'dropdownFooter'         : (texto) => { return `Mostrando ${texto} resultados`; },\n    'emptyOptions'           : () => { return 'No hay opciones disponibles.'; },\n    'appendItems'            : (items) => { return `Agregando ${items.length} elementos.`; },\n    'maximumSelectionReached': () => { return 'Se ha alcanzado el número máximo de selecciones.'; },\n    'selectOnClose'          : () => { return 'Seleccione una opción al cerrar el menú.'; },\n    'escapeKeyUp'            : () => { return 'Presione \\'Escape\\' para cerrar el menú.'; },\n    'errorLoading'           : () => { return 'Error al cargar datos. Inténtalo de nuevo más tarde.'; },\n    'inputTooShort'          : (elemento) => { return `Ingresa al menos ${elemento.minimum} caracteres para iniciar una búsqueda.`; },\n    'noMatches'              : () => { return 'No se encontraron coincidencias para tu búsqueda.'; },\n    'allowClear'             : () => { return 'Borrar selección'; },\n    'SelectionTooLong'       : (conteo, maximo) => { return `Solo puedes seleccionar ${maximo} opciones.`; },\n    'loadMore'               : () => { return 'Cargando más resultados...'; },\n    'removing'               : (seleccion) => { return 'Eliminando...'; },\n    'matches'                : (coincidencias, total) => {\n        if (coincidencias === 0) {\n            return 'No hay coincidencias.';\n        } else if (coincidencias === 1) {\n            return 'Se encontró 1 coincidencia.';\n        } else {\n            return `Se encontraron ${coincidencias} coincidencias entre ${total}.`;\n        }\n    }\n};\n\n// audios\nvar audio_notificacion = new Audio('/audios/notificacion.mp3');\n\nlet mostro_modal_creditos_ia = false;\nlet funcion_ejecucion_ia = null;\nlet modals_abiertos_ia = null;\n\nlet funcionalidades_disponibles_empresa = [];\n\n// Umbrales para mostrar el modal de advertencia de créditos (en porcentaje)\nconst UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0];\n\n/**\n * Mostrar modal de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarModalCreditosIA(servicio_ia_id) {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta_empresa) {\n            if (respuesta_empresa?.data?.creditos_disponibles > 0) {\n                $.ajax({\n                    url: `/servicios-ia/${servicio_ia_id}/creditos`,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(respuesta) {\n                        if (respuesta?.data?.consume_creditos && respuesta?.data?.consume_creditos <= respuesta_empresa.data.creditos_disponibles) {\n                            $('#cantidad-creditos-descontar-modal').text(respuesta.data.consume_creditos);\n                            $('#modal-consumo-creditos-ia').modal('show');\n                            mostro_modal_creditos_ia = true;\n                            modals_abiertos_ia = $('.modal.show').not('#modal-consumo-creditos-ia').not('#modal-generando-ia');\n                            $(modals_abiertos_ia).addClass('d-none');\n                        } else {\n                            mostrarToastSolicitarCreditosIA();\n                        }\n                    }\n                });\n            } else {\n                mostrarToastSolicitarCreditosIA();\n            }\n        }\n    });\n}\n\n/**\n * Mostrar toast para solicitar créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction mostrarToastSolicitarCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let adicional_toast = '';\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                adicional_toast = `<a href=\"https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.\" target=\"_blank\">\n                    <p class=\"text-label-1 text-white no-visited text-decoration-none mb-0\">Solicitar</p>\n                </a>`;\n            }\n            setTimeout(() => {\n                $('#modal-generando-ia').modal('hide');\n                $('#modal-cargue-ia').modal('hide');\n                mostrarToast('danger', 'No cuentas con créditos. Solicita créditos adicionales.', '', adicional_toast);\n            }, 300);\n        }\n    });\n}\n\n/**\n * Continuar ejecución IA luego del modal de créditos\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction continuarEjecucionIA() {\n    if (funcion_ejecucion_ia) {\n        funcion_ejecucion_ia();\n        funcion_ejecucion_ia = null;\n    }\n    mostro_modal_creditos_ia = false;\n    $('#modal-consumo-creditos-ia').modal('hide');\n}\n\n/**\n * Solicitar más créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction solicitarMasCreditosIA() {\n    $.ajax({\n        url: `/empresas/${$('#empresa_sesion_id').val()}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            $('#modal-solicitar-mas-creditos-ia').modal('hide');\n        }\n    });\n}\n\n/**\n * Validar respuesta de créditos IA\n *\n * @return void\n * @author José Manuel Jiménez\n */\nfunction validarRespuestaCreditosIA(error_ia) {\n    if (error_ia == 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.') {\n        mostrarToastSolicitarCreditosIA();\n        return true;\n    }\n    return false;\n}\n\n/**\n * Ajustar el ancho de los elementos select2 asincrono multiple.\n *\n * @returns {void}\n * @author Andres Morales\n */\n$(document).ready(function () {\n    cargarNotificiacionesHeader();\n    if (window.configuracion_reverbg && window.configuracion_reverbg.activar_websocket) {\n        configurarWebSocketNotificaciones();\n    }\n    setTimeout(() => {\n        $(\".input-container\").each(function () {\n            let $container = $(this);\n            let $select = $container.find(\"select[multiple]\");\n            let $icon = $container.find(\".input-icono1\");\n            if ($select.length && $icon.length) {\n                $(this).find('.select2-selection--multiple').addClass('ps-5')\n            }\n        });\n    }, 1000);\n    $('#modal-consumo-creditos-ia').on('hidden.bs.modal', function () {\n        if (mostro_modal_creditos_ia) {\n            $(modals_abiertos_ia).removeClass('d-none');\n        }\n        mostro_modal_creditos_ia = false;\n    });\n\n    // Cargar créditos disponibles si existe el contenedor y el ID de empresa\n    if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {\n        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());\n    }\n});\n\n/**\n * Formatear fecha a formato dd/mm/yyyy - hh:mm AM/PM.  Ejemplo: 01/Feb/2022 - 12:00 PM\n *\n * @param {string} fecha_entrada fecha en formato ISO\n * @returns {string} fecha y hora formateada\n * @author Andres Morales\n */\nfunction formatearFecha(fecha_entrada) {\n    var fecha = new Date(fecha_entrada);\n    var dia = fecha.getDate();\n    var mes = fecha.toLocaleString('es-ES', { month: 'short' });\n    var anio = fecha.getFullYear();\n    let hora = fecha.getHours();\n    let minuto = fecha.getMinutes();\n    let ampm = hora >= 12 ? 'PM' : 'AM';\n    hora = hora % 12 || 12;\n    minuto = minuto.toString().padStart(2, '0');\n    return `${dia}/${mes}/${anio} - ${hora}:${minuto} ${ampm}`;\n}\n\nfunction formatearFecha2(fecha_entrada) {\n    let partes = fecha_entrada.split(' ');\n    let fecha = partes[0].split('-');\n    let hora = partes[1];\n    let fechaISO = `${fecha[2]}-${fecha[1]}-${fecha[0]}T${hora}`;\n\n    let date = new Date(fechaISO);\n\n    if (isNaN(date.getTime())) {\n        return 'Fecha inválida';\n    }\n\n    let dia = date.getDate();\n    let mes = date.toLocaleString('eu-EU', { month: 'short' });\n    let anio = date.getFullYear();\n    return `${dia}/${mes}/${anio}`;\n}\n\n/**\n * Opción para contraer o agrandar el menú principal\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction contraerMenu() {\n    if ($('.sidebar-menu').hasClass('close')) {\n        $('.sidebar-menu').removeClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'abierto');\n        $('#btn-collapse').attr('data-bs-original-title', 'Contraer');\n        $('#btn-collapse').attr('data-bs-title', 'Contraer');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-2\").addClass(\"px-5\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n    } else {\n        $('.sidebar-menu').addClass('d-none');\n        localStorage.setItem('opcion_menu_storage', 'cerrado');\n        $('#btn-collapse').attr('data-bs-original-title', 'Expandir');\n        $('#btn-collapse').attr('data-bs-title', 'Expandir');\n        $(\".menu-bar\").each(function() {\n            $(this).removeClass(\"px-5\").addClass(\"px-2\");\n        });\n        $('[data-bs-toggle=\"tooltip\"]').each(function () { new bootstrap.Tooltip(this); });\n    }\n    $('.tooltip.bs-tooltip-auto').remove();\n    $('.sidebar-menu').toggleClass('close');\n    $('.contenedor-vista').toggleClass('close');\n    $('#btn-collapse').toggleClass('close');\n    $('.nombre-usuario-empresa').toggle();\n    $('.menu-bar .text-menu').toggle();\n}\n\n/**\n * Opción para abrir o cerrar el menu segun la elección guardada\n *\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Morales\n */\nfunction mostrarMenuStorage() {\n    $(document).ready(function() {\n        $('.lista-primary[data-bs-toggle=\"tooltip\"]').each(function () {\n            var tooltip_instancia = bootstrap.Tooltip.getInstance(this);\n            if (tooltip_instancia) {\n                tooltip_instancia.dispose();\n            }\n        });\n\n        if (window.innerWidth < 768) {\n            localStorage.setItem('opcion_menu_storage', 'cerrado');\n        }\n\n        if (localStorage.getItem('opcion_menu_storage') === 'cerrado') {\n            contraerMenu();\n        }\n        let $active = $('.menu-bar .active');\n\n        if ($active.length) {\n            $('.menu-bar').scrollTop($active.position().top);\n        }\n    });\n}\nmostrarMenuStorage();\n\n/**\n * Funcion para hacer el slug de un texto desde jquery.\n *\n * @returns {void}\n * @author Andres Morales\n */\nfunction slugify(text) {\n    return $.trim(text)\n        .toLowerCase()\n        .normalize(\"NFD\")\n        .replace(/[\\u0300-\\u036f]/g, \"\")\n        .replace(/[^a-z0-9 -]/g, \"\")\n        .replace(/\\s+/g, \"-\")\n        .replace(/-+/g, \"-\");\n}\n\n/**\n * Función generica para mostrar mensajes de respuesta\n *\n * @param {string} tipo_alerta define el color de la alerta segun alerts de botstrap.\n * @param {string} texto_1 Texto que mostrara la alerta.\n * @param {string} texto_2 Texto secundario en la alerta.\n * @param {string} accion Acción adicional(por definir).\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Andres Gonzalez\n */\nfunction mostrarToast(tipo_alerta, texto_1, texto_2 = '', accion = '', icono2 = '') {\n    let icono = '';\n    let texto_color = 'text-white';\n    if (accion != '') {\n        accion = `<div class=\"col-auto p-0 text-label-1\">${accion}</div>`;\n    }\n\n    if (tipo_alerta == 'success') {\n        icono = 'bi bi-check-circle';\n    }\n\n    if (tipo_alerta == 'neutral') {\n        icono = 'bi bi-info-circle';\n    }\n\n    if (tipo_alerta == 'warning') {\n        icono = 'bi bi-info-circle';\n        texto_color = \"text-red-letras\";\n    }\n\n    if (tipo_alerta == 'danger') {\n        icono = 'bi bi-x-circle';\n    }\n\n    if (icono2 != '') {\n        icono = icono2;\n    }\n\n    if (texto_2 != '') {\n        texto_2 = `<div class=\"col-12 p-0 text-label-1 ${texto_color}\">${texto_2}</div>`;\n    }\n\n    let alert_toast = $(`\n        <div class=\"alert toast-${tipo_alerta} alert-dismissible fade show d-flex align-items-center pe-3 py-3 me-3\" role=\"alert\" style=\"display:none\">\n            <div class=\"col-auto\">\n                <span class=\"${icono} ${texto_color}\"></span>\n            </div>\n            <div class=\"col px-3\">\n                <div class=\"row m-0 ${texto_color}\">\n                    <div class=\"col-12 p-0 text-label-1 ${texto_color}\">\n                        ${texto_1}\n                    </div>\n                    ${texto_2}\n                </div>\n            </div>\n            ${accion}\n            <div class=\"col-auto ms-3 pointer\" data-bs-dismiss=\"alert\">\n                <span class=\"bi bi-x ${texto_color}\"></span>\n            </div>\n        </div>\n    `);\n    $('#contenedor-alert-toast').append(alert_toast);\n    alert_toast.fadeIn();\n    setTimeout(function() {\n        alert_toast.fadeOut();\n        alert_toast.alert('close');\n    }, 5000);\n}\n\n/**\n * Formatear número.\n *\n * @param {number} numero número a formatear\n * @author Andres Morales\n */\nfunction formatearNumero(numero) {\n    return parseInt(numero).toLocaleString('es-ES');\n}\n\n/**\n * Formatear fecha.\n *\n * @param {*} fecha Fecha a formatear.\n * @param {boolean} incluir_segundos Indica si se debe incluir los segundos en la hora.\n * @param {string} formato Formato en el que se retornará la fecha.\n * @param {string} separador Símbolo que se usará para separar días, meses y años.\n * @returns {Object} Objeto con la fecha y hora formateada.\n * @author Daniel Beltrán\n */\nfunction formatearFechaConceptual(fecha, incluir_segundos = false, formato = 'Ymd', separador = '-') {\n    const NUEVA_FECHA = new Date(fecha);\n    const ANO         = NUEVA_FECHA.getFullYear();\n    const MES         = String(NUEVA_FECHA.getMonth() + 1).padStart(2, '0');\n    const DIA         = String(NUEVA_FECHA.getDate()).padStart(2, '0');\n    const HORAS       = String(NUEVA_FECHA.getHours()).padStart(2, '0');\n    const MINUTOS     = String(NUEVA_FECHA.getMinutes()).padStart(2, '0');\n    const SEGUNDOS    = String(NUEVA_FECHA.getSeconds()).padStart(2, '0');\n\n    let fecha_formateada = `${ANO}${separador}${MES}${separador}${DIA}`;\n\n    if (formato === 'dmY') {\n        fecha_formateada = `${DIA}${separador}${MES}${separador}${ANO}`;\n    }\n\n    return {\n        fecha: fecha_formateada,\n        hora : incluir_segundos ? `${HORAS}:${MINUTOS}:${SEGUNDOS}` : `${HORAS}:${MINUTOS}`\n    };\n}\n\n/**\n * Formatear fecha a May. 2023.\n *\n * @param {string} fechaISO Fecha a formatear.\n * @returns {string} Objeto con la fecha y hora formateada.\n * @author Andres Morales\n */\nfunction formatearFechaAnioMes(fechaISO) {\n    const fecha = new Date(fechaISO);\n    const opciones = { month: 'short', year: 'numeric' };\n    let fecha_formateada = fecha.toLocaleDateString('es-ES', opciones);\n\n    fecha_formateada = fecha_formateada.replace(\n        /^([a-zñ]+)(\\s\\d{4})$/,\n        (_, mes, anio) => `${mes.charAt(0).toUpperCase() + mes.slice(1)}. ${anio.trim()}`\n    );\n\n    return fecha_formateada;\n}\n\n/**\n * Formatear un numero a moneda.\n *\n * @param {string} valor Numero.\n * @returns {string} Numero formateado.\n * @author Andres Morales\n */\nfunction formatearMonedaCOP(valor) {\n    return new Intl.NumberFormat('es-CO', {\n        style: 'currency',\n        currency: 'COP',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n    }).format(valor);\n}\n\n/**\n * Formatear fecha a un formato d/m/Y hh:mm:ss entendible para el usuario.\n *\n * @param {*} fecha_inicial Fecha a formatear.\n * @returns {String} String con la fecha y hora formateada.\n * @author José Manuel Jiménez\n */\nfunction fechaMostrar(fecha_inicial) {\n    if (!fecha_inicial) {\n        return \"\";\n    }\n    const fecha = new Date(fecha_inicial);\n    if (isNaN(fecha.getTime())) {\n        return \"\";\n    }\n    const dia = String(fecha.getUTCDate()).padStart(2, '0');\n    const mes = String(fecha.getUTCMonth() + 1).padStart(2, '0');\n    const anio = fecha.getUTCFullYear();\n    // Verificar si el string incluye información de hora (espacio, T, o dos puntos)\n    if (!fecha_inicial.includes(\" \") && !fecha_inicial.includes(\"T\") && !fecha_inicial.includes(\":\")) {\n        return `${dia}/${mes}/${anio}`;\n    }\n    const horas = String(fecha.getUTCHours()).padStart(2, '0');\n    const minutos = String(fecha.getUTCMinutes()).padStart(2, '0');\n    const segundos = String(fecha.getUTCSeconds()).padStart(2, '0');\n    return `${dia}/${mes}/${anio} ${horas}:${minutos}:${segundos}`;\n}\n\n/**\n * Descargar Excel.\n *\n * @param {string} ruta Ruta desde donde se descarga el archivo.\n * @param {string} nombre_archivo Nombre del archivo descargado.\n * @param {boolean} marca_tiempo Indica si el nombre del archivo debe llevar marca de tiempo.\n * @param {Object} parametros Parámetros a enviar en la petición.\n * @returns {void}\n * @author Daniel Beltrán\n */\nasync function descargarExcel(ruta, nombre_archivo, marca_tiempo = true, parametros = {}) {\n    parametros._token = $('meta[name=\"csrf-token\"]').attr('content');\n\n    await $.ajax({\n        type     : 'POST',\n        url      : `/${ruta}`,\n        data     : parametros,\n        xhrFields: {\n            responseType: 'blob'\n        },\n        success: function (respuesta) {\n            // Crear una URL para el Blob\n            let url = window.URL.createObjectURL(respuesta); // 'respuesta' es el Blob\n            let a   = document.createElement('a'); // Crea un nuevo elemento <a> para iniciar la descarga\n            a.href  = url;\n            const fecha_actual     = new Date();\n            const dia              = fecha_actual.getDate();\n            const mes              = fecha_actual.getMonth() + 1;\n            const ano              = fecha_actual.getFullYear();\n            const hora             = fecha_actual.getHours();\n            const minutos          = fecha_actual.getMinutes();\n            const segundos         = fecha_actual.getSeconds();\n            const fecha_formateada = `${dia}${mes}${ano}${hora}${minutos}${segundos}`;\n\n            a.download = marca_tiempo ? `${nombre_archivo}-${fecha_formateada}.xlsx` : `${nombre_archivo}.xlsx`;\n            document.body.appendChild(a);\n            a.click();\n            window.URL.revokeObjectURL(url);\n            document.body.removeChild(a);\n        }\n    }).then(() => {\n        mostrarToast('success', 'Archivo descargado correctamente.');\n    }).catch((error) => {\n        mostrarToast('danger', 'Ocurrió un error al descargar el archivo.');\n    });\n}\n\n/**\n * Convierte un string a slug.\n *\n * @param {string} str\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction slug(str) {\n\n    // Quita espacios en blanco\n    str = str.replace(/^\\s+|\\s+$/g, \"\")\n\n    // Convierte el string a minusculas\n    str = str.toLowerCase()\n\n    // Quita los caracteres no alfanuméricos\n    str = str.replace(/[^a-z0-9 -]/g, \"\")\n\n    // Reemplaza los espacio con guiones\n    str = str.replace(/\\s+/g, \"-\")\n\n    // Remueve los guiones consecutivos\n    str = str.replace(/-+/g, \"-\")\n\n    return str\n}\n\n/**\n * Compara los elementos de dos arreglos y retorna `true` si son iguales y `false` en caso contrario\n * (Este función está pensada para comparar arreglos unidimensionales).\n *\n * @param {array} primer_arreglo\n * @param {array} segundo_arreglo\n * @param {boolean} comparar_orden\n * @return {boolean}\n * @author Fahibram Cárcamo\n */\nfunction sonArreglosIguales(primer_arreglo, segundo_arreglo, comparar_orden = false) {\n\n    if (!comparar_orden) {\n        primer_arreglo.sort()\n        segundo_arreglo.sort()\n    }\n\n    if (primer_arreglo.length !== segundo_arreglo.length) return false\n\n    for (let i = 0; i < primer_arreglo.length; i++) {\n        if (primer_arreglo[i] !== segundo_arreglo[i]) return false\n    }\n\n    return true\n}\n\n/**\n * Función para cambiar de empresa.\n *\n * @param {number} empresa_id ID de la empresa a la que se va a cambiar.\n * @returns {void}\n * @author José Manuel Jiménez\n * @author Daniel Beltrán\n */\nfunction cambiarEmpresa(empresa_id) {\n    $.ajax({\n        type: 'POST',\n        url: '/suplantar-rol-admin-general',\n        data: {\n            _token    : $('meta[name=\"csrf-token\"]').attr('content'),\n            empresa_id: empresa_id\n        },\n        success: function (respuesta) {\n            localStorage.setItem('notificacionToast', JSON.stringify({\n                tipo_alerta: 'success',\n                texto_1    : 'Cambio de empresa exitoso'\n            }));\n\n            window.location.reload();\n        },\n        error: function (error) {\n            mostrarToast('danger', 'Ocurrió un error al cambiar de empresa');\n        }\n    });\n}\n\n/**\n * Enviar la solucitud de suplantación de rol y empresa al Back-end.\n *\n * @param {function|null} callback_exito Callback ejecutado en caso de éxito.\n * @param {string} url URL de suplantación.\n * @param {string} _token Token CSRF del formulario.\n * @param {number} empresa_id Id de la empresa a suplantar.\n * @param {number|null} rol_id Id del rol a suplantar.\n * @param {function|null} callback_error Callback ejecutado en caso de error.\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nasync function enviarOrdenSuplantacionRolEmpresa (callback_exito, url, _token, empresa_id = null, rol_id = null, callback_error = null) {\n\n    let condicion_suplantacion = rol_id === null\n        ? empresa_id === null\n            ? true\n            : parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id)\n        : parseInt($('#rol_sesion_id').val()) !== parseInt(rol_id) && parseInt($('#empresa_sesion_id').val()) !== parseInt(empresa_id);\n\n    if (condicion_suplantacion) {\n        let data = { _token };\n        if (empresa_id !== null) data.empresa_id = empresa_id;\n        if (rol_id !== null) data.rol_id = rol_id;\n\n        await $.ajax({ type: 'POST', url, data })\n            .then((respuesta, status, xhr) => {\n                if (xhr.status >= 200 && xhr.status < 300 && callback_exito !== null) callback_exito();\n            })\n            .catch(error => {\n                let swal_titulo, swal_texto;\n\n                if (error.status === 404) {\n                    if (error.responseJSON.mensaje) {\n                        swal_titulo = 'Algo salió mal';\n                        if (error.responseJSON.mensaje === 'no existe rol_suplantar') {\n                            swal_texto = 'El rol no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe empresa_suplantar') {\n                            swal_texto = 'La empresa no existe.';\n                        } else if (error.responseJSON.mensaje === 'no existe usuario_suplantar') {\n                            swal_texto = 'El usuario no existe.';\n                        } else {\n                            swal_texto = '';\n                        }\n                    } else if (error.responseJSON.empresa && error.responseJSON.rol) {\n                        swal_titulo = 'No fué posible cambiar de empresa';\n                        swal_texto = error.responseJSON.rol === 'Administrador general' || error.responseJSON.rol === 'Propietario'\n                            ? `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol Administrador general o Propietario.`\n                            : `La empresa ${error.responseJSON.empresa} no tiene ningún usuario con el rol ${error.responseJSON.rol}.`;\n                    } else {\n                        swal_titulo = 'Algo salió mal';\n                        swal_texto = error.responseJSON.errors;\n                    }\n                } else {\n                    swal_titulo = 'Algo salió mal';\n                    swal_texto = '';\n                }\n\n                if (callback_error !== null) callback_error();\n\n                Swal.fire({\n                    title: swal_titulo,\n                    text: swal_texto,\n                    icon: \"error\",\n                    confirmButtonText: \"Aceptar\"\n                });\n            });\n    }\n}\n\n/**\n * Mostrar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction mostrarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'block';\n}\n\n/**\n * Ocultar tooltip según el div que lo contenga.\n *\n * @param {div} div Elemento en donde se va a mostrar el tooltip.\n * @returns {void}\n * @author Sol Espitia\n */\nfunction ocultarTooltip(div) {\n    const TOOLTIP         = div.querySelector('.tooltip-x');\n    TOOLTIP.style.display = 'none';\n}\n\n/**\n * Retornar la diferencia en días de dos fechas dadas.\n *\n * @param {string} fecha_inicial Fecha inicial\n * @param {string} fecha_final Fecha final\n * @param {bool} valor_absoluto Retorna la diferencia en valor absoluto\n * @returns {number}\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction diferenciaFechasDias(fecha_inicial, fecha_final, valor_absoluto = false, sumar_dia = true) {\n    let fecha1 = new Date(fecha_inicial);\n    let fecha2 = new Date(fecha_final);\n\n    fecha1.setHours(0, 0, 0, 0);\n    fecha2.setHours(0, 0, 0, 0);\n\n    let diferencia_milisegundos = fecha2.getTime() - fecha1.getTime();\n\n    let diferencia_dias = diferencia_milisegundos / (1000 * 60 * 60 * 24);\n    let resultado = diferencia_dias;\n    if (sumar_dia) {\n        resultado = diferencia_dias + 1;\n    }\n\n    return valor_absoluto ? Math.abs(resultado) : resultado;\n}\n\n/**\n * Retornar `true` si una fecha dada está dentro de un rango de fechas dadas, `false` en otro caso.\n *\n * @param {string} fecha Fecha dada\n * @param {string} fecha_desde Fecha inicial del rango\n * @param {string} fecha_hasta Fecha final del rango\n * @returns {boolean}\n * @author Fahibram Cárcamo\n */\nfunction fechaDentroDelRango(fecha, fecha_desde, fecha_hasta) {\n    fecha = new Date(fecha);\n    fecha_desde = new Date(fecha_desde);\n    fecha_hasta = new Date(fecha_hasta);\n\n    if (isNaN(fecha) || isNaN(fecha_desde) || isNaN(fecha_hasta)) {\n        throw new Error('Una o más fechas no son válidas.');\n    }\n\n    return fecha >= fecha_desde && fecha <= fecha_hasta;\n}\n\n/**\n * Descuenta el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nvar tiempos_usados = {};\n\nfunction descuentoTiempo(id, tiempo, callback, onTick) {\n    var $elemento = $('#' + id);\n    if ($elemento.length === 0) {\n        console.error('Elemento con id \"' + id + '\" no encontrado.');\n        return;\n    }\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n    }\n    let tiempoTotal = tiempo;\n    tiempos_usados[id] = setInterval(function() {\n        if (tiempo <= 0) {\n            clearInterval(tiempos_usados[id]);\n            delete tiempos_usados[id];\n            $elemento.text('Tiempo finalizado');\n            if (window.tiempoFinalizado()) {\n                tiempoFinalizado();\n            }\n            if (typeof callback === 'function') {\n                callback();\n            }\n            return;\n        }\n\n        var minutos = Math.floor(tiempo / 60);\n        var segundos = tiempo % 60;\n\n        var textoTiempo = minutos + ':' + (segundos < 10 ? '0' : '') + segundos + '<i class=\"bi bi-alarm ms-2\"></i>';\n\n        if (tiempo <= 15) {\n            $elemento.addClass('text-state-red');\n            $elemento.removeClass('text-state-green');\n        } else {\n            $elemento.addClass('text-state-green');\n            $elemento.removeClass('text-state-red');\n        }\n\n        $elemento.html(textoTiempo);\n\n        var tiempoUsado = tiempoTotal - tiempo;\n\n        if (typeof onTick === 'function') {\n            onTick((tiempoUsado % 5));\n        }\n        tiempo--;\n    }, 1000);\n}\n\n/**\n * Detengo el tiempo para las respuestas.\n *\n * @param id - ID del elemento HTML donde mostrar el tiempo\n * @param tiempo - Tiempo inicial en segundos\n * @author Jair Carvajal\n */\nfunction detenerDescuentoTiempo(id) {\n    if (tiempos_usados[id]) {\n        clearInterval(tiempos_usados[id]);\n        delete tiempos_usados[id];\n    }\n}\n\n/**\n * Genera un SVG de la imagen de usuario.\n *\n * @param id ID del usuario.\n * @param nombres Nombres del usuario.\n * @param apellidos Apellidos del usuario.\n * @return image\n * @author Andres Morales\n */\nfunction crearImagenUsuarioLetras(id, nombres, apellidos) {\n    var tamano = 200;\n    var iniciales = (nombres[0] + apellidos[0]).toUpperCase();\n    var hash = md5(id);\n\n    var r = parseInt(hash.substring(0, 2), 16);\n    var g = parseInt(hash.substring(2, 4), 16);\n    var b = parseInt(hash.substring(4, 6), 16);\n    var colorFondo = `rgb(${r},${g},${b})`;\n\n    var luminancia = 0.299 * r + 0.587 * g + 0.114 * b;\n    var colorTexto = luminancia > 150 ? \"#000000\" : \"#FFFFFF\";\n\n    // SVG como texto\n    var svg = `\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${tamano}\" height=\"${tamano}\">\n        <rect width=\"100%\" height=\"100%\" fill=\"${colorFondo}\" />\n        <text x=\"50%\" y=\"50%\" dy=\".35em\"\n            text-anchor=\"middle\"\n            font-family=\"Lato, sans-serif\"\n            font-size=\"${tamano * 0.4}\"\n            fill=\"${colorTexto}\">\n            ${iniciales}\n        </text>\n    </svg>`;\n    var svgEncoded = encodeURIComponent(svg)\n        .replace(/'/g, \"%27\")\n        .replace(/\"/g, \"%22\");\n\n    var dataUri = `data:image/svg+xml,${svgEncoded}`;\n    return dataUri;\n}\n\n/**\n * Carga las notificaciones\n *\n * @return void\n * @author Andres Morales\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n * @author Jair Carvajal\n */\nfunction cargarNotificiacionesHeader() {\n    $.ajax({\n        url: '/usuario-notificaciones',\n        type: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            let datos = respuesta.data;\n            let notificaciones_noleidas = datos?.unread_notifications?.length ?? 0;\n\n            // Siempre remover el badge existente\n            $('#dropdownNotificaciones #badge-notificaciones').remove();\n\n            // Solo agregar el badge si hay notificaciones no leídas\n            if (notificaciones_noleidas > 0) {\n                $('#dropdownNotificaciones').append(`<span id=\"badge-notificaciones\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n                $('#contador-notificaciones-abierto').append(`<span id=\"badge-notificaciones\" class=\"badge rounded-pill bg-state-red border border-white\">${notificaciones_noleidas}</span>`);\n\n                $('#contenedor-boton-marcar-todas').html(`\n                    <button class=\"btn btn-link text-primary w-100 d-flex justify-content-center\" onclick=\"marcarNotificacionesLeidas('all')\">\n                        Marcar todo como leído\n                    </button>\n                `);\n            }\n\n            const NO_LEIDOS_IDS = new Set(Array.isArray(datos?.unread_notifications) ? datos.unread_notifications.map(notificacion => notificacion.id) : []);\n\n            if (Array.isArray(datos?.notifications) && datos.notifications.length > 0) {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n                datos.notifications.forEach(notificacion => {\n                    const { id, data, updated_at } = notificacion;\n\n                    const NO_LEIDO = NO_LEIDOS_IDS.has(id);\n                    const MENSAJE = (data?.mensaje || '').slice(0, 120) + '...';\n                    const HORA = new Date(updated_at).toLocaleTimeString('es-CO', {\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        hour12: false\n                    });\n\n                    const notificaciones = `\n                        <li class=\"${NO_LEIDO ? '' : 'bg-gray-90'} notificaciones-listado py-0\" id=\"notificacion-${id}\">\n                            <a class=\"dropdown-item text-gray-10 text-decoration-none border-top pt-0 pb-1\" href=\"javascript:void(0)\" onclick=\"marcarNotificacionesLeidas('${id}','${data?.ruta}')\">\n                                <div class=\"d-flex justify-content-between\">\n                                    <div class=\"w-auto flex-grow-1 pe-3\">\n                                        <p class=\"mt-1 mb-0 text-headline-6 text-gray-10\">${data?.titulo}</p>\n                                        <p class=\"mb-0 text-body-3 text-gray-30 notificacion-mensaje\">${MENSAJE}</p>\n                                    </div>\n                                    <div class=\"w-auto my-auto ${NO_LEIDO ? 'text-cta-azul' : 'text-gray-10'} text-label-2 flex-shrink-0\">\n                                        ${HORA}${NO_LEIDO ? `<i class=\"bi bi-circle-fill text-cta-azul my-auto texto-notificacion-icono ms-3\"></i>` : ''}\n                                    </div>\n                                </div>\n                            </a>\n                        </li>\n                    `;\n\n                    $(notificaciones).insertBefore('#contenedor-boton-marcar-todas');\n                });\n\n            } else {\n                $('#notificacion-sinnotificaciones').hide();\n                $('.notificaciones-listado').remove();\n            }\n\n        },\n        error: function(xhr, status, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Marcar las notificaciones leídas.\n *\n * @param {array} notificaciones_ids ids de las notificaciones\n * @param {string} ruta_destino ruta donde se va ha actualizar la pagina\n * @returns {void}\n * @author Andres Gonzalez\n * @author Esperanza Olivo\n */\nfunction marcarNotificacionesLeidas(notificaciones_ids = null, ruta_destino = null, soporte_id = null) {\n\n    let data = {\n        _token: $('meta[name=\"csrf-token\"]').attr('content')\n    };\n\n    if (notificaciones_ids === 'all') {\n        data.marcar_todo = true;\n    } else if (soporte_id) {\n        data.soporte_id = soporte_id;\n    } else if (notificaciones_ids) {\n        data.notificaciones_ids = Array.isArray(notificaciones_ids)\n            ? notificaciones_ids\n            : [notificaciones_ids];\n    }\n\n    $.ajax({\n        url: '/usuario-marcar-notificaciones-leidas',\n        type: 'POST',\n        data: data,\n        success: function(respuesta) {\n            cargarNotificiacionesHeader();\n\n            if (notificaciones_ids && notificaciones_ids !== 'all' && ruta_destino) {\n                window.location.href = \"/\" + ruta_destino;\n            }\n\n            if (notificaciones_ids === 'all') {\n                $('#badge-notificaciones').remove();\n                $('#contenedor-boton-marcar-todas').empty();\n                $('.notificaciones-listado').addClass('bg-gray-90');\n                $('.bi-circle-fill').remove();\n            }\n        },\n        error: function(xhr, estatus, error) {\n            console.error('Error al cargar notificaciones:', error);\n        }\n    });\n}\n\n/**\n * Configurar WebSocket para notificaciones en tiempo real\n *\n * @return void\n * @author Andres Gonzalez\n */\nfunction configurarWebSocketNotificaciones() {\n    try {\n        if (!window.configuracion_reverbg) {\n            return;\n        }\n\n        const PUSHER = new Pusher(window.configuracion_reverbg.appKey, {\n            wsHost: window.configuracion_reverbg.host,\n            wsPort: window.configuracion_reverbg.port,\n            wssPort: window.configuracion_reverbg.port,\n            cluster: 'mt1',\n            forceTLS: false,\n            enabledTransports: ['ws', 'wss'],\n            authEndpoint: '/broadcasting-auth',\n            auth: {\n                headers: {\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n                }\n            }\n        });\n\n        PUSHER.connection.bind('failed', function() {\n            console.error('❌ Conexión WebSocket falló');\n        });\n\n        PUSHER.connection.bind('error', function(error) {\n            console.error('❌ Error de WebSocket:', error);\n        });\n\n        let usuario_id = window.configuracion_reverbg.usuario_id;\n\n        if (!usuario_id) {\n            return;\n        }\n\n        const NOMBRE_CANAL = `private-App.Models.Usuarios.User.${usuario_id}`;\n        const CANAL = PUSHER.subscribe(NOMBRE_CANAL);\n\n        CANAL.bind('pusher:subscription_error', function(error) {\n            console.error('❌ Error al suscribirse al canal:', error);\n        });\n\n        // Escuchar eventos específicos de notificaciones\n        CANAL.bind('Illuminate\\\\Notifications\\\\Events\\\\BroadcastNotificationCreated', function(data) {\n            if (data.tipo === 'nueva_notificacion') {\n                audio_notificacion.play();\n                cargarNotificiacionesHeader();\n            }\n\n            if (data.tipo === 'nuevo_mensaje') {\n                if (($('#soporte-guardado-id').val() == data.soporte_id) || ($('#soporte_empresa_id').val() == data.soporte_id)) {\n                    audio_notificacion.play();\n                    consultarChat(data.soporte_id);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('💥 Error en configurarWebSocketNotificaciones:', error);\n        console.error('Stack trace:', error.stack);\n    }\n}\n\n/**\n * Retornar el string entrante en formato title case.\n *\n * @param {string} texto\n * @returns {string}\n * @author Fahibram Cárcamo\n */\nfunction titleCase(texto) {\n    return texto.toLowerCase().replace(/\\b\\w/g, caracter => caracter.toUpperCase());\n}\n\n/**\n * Número de horas que durará el almacenamiento de la variable `ulitmas_empresas` en el\n * almacenamiento local **LocalStorage**.\n *\n * @var {number}\n * @author Fahibram Cárcamo\n */\nconst CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE = 6;\n\n/**\n * Validar si ya debe removerse la variable `ultimas_empresas` del alamacenamiento local\n * **LocalStorage**, si no es tiempo de eliminarla entonces se reinicia el tiempo de vigencia de la\n * variable.\n *\n * @returns {void}\n * @author Fahibram Cárcamo\n */\nfunction validarYActualizarUltimasEmpresasLocalStorage() {\n    let fecha_hora_actuales = moment();\n    let fecha_hora_vencimiento_ultimas_empresas = fecha_hora_actuales.clone().add(CANTIDAD_HORAS_VENCIMIENTO_ULTIMAS_EMPRESAS_LOCALSTORAGE, 'hours');\n    let fecha_hora_vencimiento_ultimas_empresas_localstorage = localStorage.getItem('vencimiento_ultimas_empresas');\n    let ultimas_empresas = localStorage.getItem('ultimas_empresas');\n\n    if (\n        ultimas_empresas != null &&\n        fecha_hora_vencimiento_ultimas_empresas_localstorage != null &&\n        fecha_hora_actuales.clone().isBefore(moment(fecha_hora_vencimiento_ultimas_empresas_localstorage).clone())\n    ) {\n        localStorage.setItem('vencimiento_ultimas_empresas', fecha_hora_vencimiento_ultimas_empresas.format('YYYY-MM-DD HH:mm:ss'));\n        return;\n    }\n\n    localStorage.removeItem('vencimiento_ultimas_empresas');\n    localStorage.removeItem('ultimas_empresas');\n}\n\n/**\n * Obtener la edad actual de un usuario según su fecha de nacimiento.\n *\n * @param {string} fecha_nacimiento\n * @returns {string}\n * @author José Manuel Jiménez\n * @author Fahibram Cárcamo\n * @author Andres Morales\n */\nfunction obtenerEdad(fecha_nacimiento) {\n    if (!fecha_nacimiento) return \"N/A\";\n    let hoy = new Date();\n    let nacimiento = new Date(fecha_nacimiento);\n    let edad = hoy.getFullYear() - nacimiento.getFullYear();\n    let mes = hoy.getMonth() - nacimiento.getMonth();\n    if (mes < 0 || (mes === 0 && hoy.getDate() < nacimiento.getDate())) edad--;\n    return edad + \" años\";\n}\n\n/**\n * Restablecer un input de tipo file.\n *\n * @param {html} elemento_input_html Elemento input html.\n * @param {html} label_elemento_input_html Label del elemento input html.\n * @param {html} boton_eliminar_elemento_input_html Botón para eliminar archivo del elemento input html.\n * @author Fahibram Cárcamo\n */\nfunction reiniciarCampoArchivo(elemento_input_html, label_elemento_input_html, boton_eliminar_elemento_input_html) {\n    elemento_input_html.val('');\n    elemento_input_html.removeAttr('data-base64');\n    label_elemento_input_html.text('Ningún archivo seleccionado');\n    boton_eliminar_elemento_input_html.hide();\n\n    if (elemento_input_html.data('imagen')) {\n        $('#' + elemento_input_html.data('imagen')).val('');\n        $('#' + elemento_input_html.data('imagen') + '_previsualizacion').attr('src', '');\n        $('#' + elemento_input_html.data('imagen') + '_fondo_previsualizacion').removeClass('d-none');\n    }\n}\n\n/**\n * Definir un campo destinado a recibir un número de teléfono celular.\n *\n * Esta función debe llamarse en el evento ready del objeto global document:\n * `$(document).ready(...)`. Ademas debe incluirse un pequeño fragmento de código en la función\n * `validacionAdicional` para que se agregué el código del número de celular al valor de campo\n * cuando se envíe el formulario donde se encutra el campo.\n *\n * ```\n * if (\n *   $('#input_celular_id').length &&\n *   $('#input_celular_id').val() !== '' &&\n *   input_celular.getNumber() !== ''\n * ) {\n *   $('#input_celular_id').val(input_celular.getNumber().slice(1));\n * }\n * ```\n *\n * Donde `input_celular` es el objeto retornado por esta función.\n *\n * @param {string} input_celular_id Id del campo.\n * @param {string} nombre_input_celular Nombre del campo.\n * @param {string} placeholder_input_celular Placeholder del campo.\n * @param {boolean} obligatorio El campo es obligatorio en el formulario.\n * @returns {object}\n * @author Fahibram Cárcamo\n */\nfunction definirInputTipoCelular(input_celular_id, nombre_input_celular, placeholder_input_celular, obligatorio = true) {\n    /**\n     * 🌎 Campo para ingresar un número de telefono con selectór de código de país con banderas.\n     * Este componente se creó con la librería International Telephone Input\n     * (https://intl-tel-input.com).\n     *\n     * La linea hiddenInput: () => ({ phone: 'celular_contacto' }) tiene como función establecer el\n     * nombre del campo, es decir, la llave del par llave-valor que se adjuntará en los datos del\n     * formulario cuando se envíe, en este caso 'celular_contacto'.\n     *\n     * Las lienas autoPlaceholder: 'aggressive' y\n     * customPlaceholder: (placeholder, country) => 'Celular*' se usan para definir el placeholder\n     * del campo.\n     *\n     * Con $('#celular_contacto').attr('required', true); se establece el campo como requerido\n     * dentro del formulario, se hace de esta forma porque la librería no admite el atributo\n     * required directamente en el componente html.\n     *\n     * @author Fahibram Cárcamo\n     */\n    if (document.querySelector(`#${input_celular_id}`)) {\n        const dropdown_dinamico = document.createElement('div');\n        document.body.appendChild(dropdown_dinamico);\n\n        let campo_celular = window.intlTelInput(document.querySelector(`#${input_celular_id}`), {\n            nationalMode: true,\n            initialCountry: 'co',\n            separateDialCode: true,\n            autoInsertDialCode: false,\n            autoPlaceholder: 'aggressive',\n            dropdownContainer: dropdown_dinamico,\n            customPlaceholder: (placeholder, country) => placeholder_input_celular,\n            loadUtils: () => import('https://cdn.jsdelivr.net/npm/intl-tel-input@25.4.2/build/js/utils.js'),\n            onlyCountries: [\n                'CO', // Colombia\n                'EC', // Ecuador\n                'AR', // Argentina\n                'CL', // Chile\n                'VE', // Venezuela\n                'PE', // Perú\n                'BO', // Bolivia\n                'UY', // Uruguay\n                'PY', // Paraguay\n                'PA', // Panamá\n                'MX', // México\n                'CR', // Costa Rica\n                // 'PR', // Puerto Rico\n                'CU', // Cuba\n                // 'DO', // República Dominicana\n                'SV', // El Salvador\n                'GT', // Guatemala\n                'HN', // Honduras\n                'NI', // Nicaragua\n                'ES', // España\n                'US', // Estados Unidos\n                'GQ'  // Guinea Ecuatorial\n            ]\n        });\n\n        if (obligatorio) $(`#${input_celular_id}`).attr('required', true);\n\n        return campo_celular;\n    }\n\n    return null;\n}\n\n/**\n * Establece la validación adicional que se aplica a un campo de tipo celular antes de enviar sus\n * datos en un formulario.\n *\n * @param {HTMLInputElement} input Elemento HTML del campo de tipo celular.\n * @param {string} input_id Id del elemento HTML del campo de tipo celular.\n * @author Fahibram Cárcamo\n * @author Jair Carvajal\n */\nfunction validacionAdicionalInputTipoCelular(input, input_id) {\n    let numero_completo = input.getNumber();\n    let indicativo = '+' + input.getSelectedCountryData().dialCode;\n    let codigo_iso2_pais = input.getSelectedCountryData().iso2;\n    let numero_sin_indicativo = numero_completo.replace(indicativo, '');\n    $(`#indicativo_${input_id}`).val(indicativo);\n    $(`#codigo_iso2_pais_${input_id}`).val(codigo_iso2_pais);\n    $(`#${input_id}`).val(numero_sin_indicativo);\n}\n\n/**\n * Rellenar un input de tipo celular.\n *\n * @param {string} indicativo_celular Código del país del número de celular.\n * @param {string} codigo_pais_iso2 Código ISO2 del país del número de celular.\n * @param {string} numero_celular Número de celular sin código de país.\n * @param {string} input_celular_id ID del input de tipo celular.\n * @param {HTMLInputElement} input_celular Input de tipo celular.\n * @returns {void}\n * @author Daniel Beltrán\n * @author Fahibram Cárcamo\n */\nfunction rellenarInputCelular(indicativo_celular, codigo_pais_iso2, numero_celular, input_celular_id, input_celular) {\n    $(`#${input_celular_id}`).val(numero_celular);\n    if (![null, undefined].includes(codigo_pais_iso2)) input_celular.setCountry(codigo_pais_iso2);\n}\n\n/**\n * Convierte imágenes de base64 a Blob.\n *\n * @param {string} cadena_base_64 Base 64 de la imagen.\n * @returns {Promise<Array>}\n * @author Andres Gonzalez\n */\nfunction imagenBase64Blob(cadena_base_64) {\n    if (!cadena_base_64 || !cadena_base_64.startsWith('data:image')) return null;\n    let datos_base_64 = cadena_base_64.split(',')[1];\n    let tipo_mime = cadena_base_64.match(/data:(.*?);base64/)[1];\n    let caracteres_binarios = atob(datos_base_64);\n    let arreglo_bytes = new Array(caracteres_binarios.length).fill(0).map((_, i) => caracteres_binarios.charCodeAt(i));\n    let bytes_uint8 = new Uint8Array(arreglo_bytes);\n    return new Blob([bytes_uint8], { type: tipo_mime });\n}\n\n\n/**\n * Limpiar estructuras html innecesarias en el check editor.\n *\n * @param {string} html - Cadena HTML generada por CKEditor a limpiar\n * @returns {string} HTML limpio sin elementos específicos de CKEditor\n * @author Andres Gonzalez\n * @author Jair Carvajal\n */\nfunction limpiarHTMLCKEditor(html) {\n    // Remover todos los elementos con clases de CKEditor\n    html = html.replace(/<div class=\"ck[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<span class=\"[^\"]*ck[^\"]*\"[^>]*>/gi, '<span>');\n\n    // Limpiar spans de imagen inline\n    html = html.replace(/<span class=\"image-inline[^\"]*\"[^>]*>/gi, '');\n    html = html.replace(/<\\/span>/g, '');\n\n    // Remover elementos de upload y widgets\n    html = html.replace(/<div class=\"ck-image-upload[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n    html = html.replace(/<div class=\"ck-fake-selection[^\"]*\"[^>]*>.*?<\\/div>/gs, '');\n\n    // Remover atributos innecesarios\n    html = html.replace(/contenteditable=\"[^\"]*\"/gi, '');\n    html = html.replace(/data-cke-filler=\"[^\"]*\"/gi, '');\n\n    // Limpiar párrafos vacíos con br\n    html = html.replace(/<p><br[^>]*><\\/p>/gi, '');\n    html = html.replace(/<br data-cke[^>]*>/gi, '');\n\n    // Limpiar espacios múltiples y saltos de línea\n    html = html.replace(/\\s+/g, ' ');\n    html = html.replace(/>\\s+</g, '><');\n\n    return html.trim();\n}\n\n/**\n * Ordena estudios por fecha_inicio más reciente (de más nueva a más antigua).\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} estudios - Array de objetos con estudios\n * @returns {Array} Array de estudios ordenados con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarEstudiosPorFecha(estudios) {\n    // Mapear con índice original\n    let estudios_con_indice = estudios.map((estudio, indice_original) => ({\n        ...estudio,\n        indice_original: indice_original\n    }));\n\n    // Ordenar estudios por fecha_inicio (más reciente primero)\n    let estudios_ordenados = estudios_con_indice.sort((a, b) => {\n        // Si ambos tienen fecha_inicio, ordenar por más reciente\n        if (a.fecha_inicio && b.fecha_inicio) {\n            return moment(b.fecha_inicio).diff(moment(a.fecha_inicio));\n        }\n        // Si solo uno tiene fecha_inicio, ese va primero\n        if (a.fecha_inicio && !b.fecha_inicio) return -1;\n        if (!a.fecha_inicio && b.fecha_inicio) return 1;\n        // Si ninguno tiene fecha_inicio, mantener orden original\n        return 0;\n    });\n\n    return estudios_ordenados;\n}\n\n/**\n * Ordena experiencias laborales por fecha: primero las que está trabajando actualmente (sin fecha_fin),\n * luego por fecha_fin más reciente.\n * Preserva los índices originales para permitir edición y eliminación correcta.\n *\n * @param {Array} experiencias - Array de objetos con experiencias laborales\n * @returns {Array} Array de experiencias ordenadas con propiedad indice_original\n * @author Jair Carvajal\n */\nfunction ordenarExperienciasPorFecha(experiencias) {\n    // Mapear con índice original\n    let experiencias_con_indice = experiencias.map((experiencia, indice_original) => ({\n        ...experiencia,\n        indice_original: indice_original\n    }));\n\n    // Ordenar experiencias\n    let experiencias_ordenadas = experiencias_con_indice.sort((a, b) => {\n        // Si 'a' no tiene fecha_fin (trabaja actualmente), va primero\n        if (!a.fecha_fin && b.fecha_fin) return -1;\n        // Si 'b' no tiene fecha_fin (trabaja actualmente), va primero\n        if (a.fecha_fin && !b.fecha_fin) return 1;\n        // Si ambos están trabajando actualmente (sin fecha_fin), mantener el orden actual\n        if (!a.fecha_fin && !b.fecha_fin) return 0;\n        // Si ambos tienen fecha_fin, ordenar por fecha más reciente primero (descendente)\n        return moment(b.fecha_fin).diff(moment(a.fecha_fin));\n    });\n\n    return experiencias_ordenadas;\n}\n\n/**\n * Obtener créditos disponibles de la empresa y actualizar el tag.\n * - Si tiene créditos >= 20% del plan: tag azul\n * - Si tiene créditos < 20% del plan: tag amarillo\n * - Si no tiene créditos: tag gris \"Sin créditos\"\n *\n * @param {number} empresa_id ID de la empresa\n * @param {string} contenedor_id ID del contenedor donde se mostrará el tag\n * @param {boolean} verificar_modal Si se debe verificar si mostrar el modal de advertencia\n * @returns {void}\n * @author Andres Gonzalez\n * @author Daniel Beltrán\n */\nfunction obtenerCreditosDisponiblesEmpresa(empresa_id, contenedor_id = 'contenedor-tag-creditos', verificar_modal = false) {\n    if (!empresa_id || !$(`#${contenedor_id}`).length) {\n        return;\n    }\n\n    $.ajax({\n        url: `/empresas/${empresa_id}/creditos`,\n        method: 'GET',\n        dataType: 'json',\n        success: function (respuesta) {\n            if (respuesta?.data) {\n                let creditos_disponibles = respuesta?.data?.creditos_disponibles ?? 0;\n                let creditos_plan = respuesta?.data?.creditos_plan ?? 0;\n                let plan_credito = respuesta?.data?.plan_credito;\n                let porcentaje_disponible = creditos_plan > 0 ? (creditos_disponibles / creditos_plan) * 100 : 0;\n\n                let texto_tag = '';\n                let clase_tag = '';\n                let icono_final = '';\n\n                if (creditos_disponibles <= 0 || plan_credito === null) {\n                    texto_tag = 'Sin créditos';\n                    clase_tag = 'tag-tonal-gray';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'No tienes créditos disponibles en este momento. Renueva tu plan o adquiere más créditos para continuar.' })}></i>`;\n                } else if (porcentaje_disponible < 20) {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-filled-yellow';\n                    icono_final = `<i class=\"bi bi-info-circle ms-1\" role=\"button\" tabindex=\"0\" ${crearTooltip({ placement: 'right', content: 'Estás cerca de agotar tus créditos. Te queda menos del 20% del total disponible. Considera recargar o revisar tu consumo para evitar interrupciones.' })}></i>`;\n                } else {\n                    texto_tag = `Créditos disponibles: ${formatearNumero(creditos_disponibles)}`;\n                    clase_tag = 'tag-tonal-blue';\n                }\n\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: texto_tag,\n                    class: clase_tag,\n                    icono_final: icono_final,\n                }));\n\n                // Verificar si se debe mostrar el modal de advertencia\n                if (verificar_modal && plan_credito !== null) {\n                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);\n                }\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por día para cada umbral alcanzado.\n * Si baja a un umbral más bajo, se muestra ese nuevo umbral aunque ya se haya mostrado otro ese día.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado (el más bajo que aplica)\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Obtener la fecha actual en formato YYYY-MM-DD\n    let fecha_hoy = new Date().toISOString().split('T')[0];\n    let llave_storage = `modal_creditos_${empresa_id}`;\n\n    // Obtener los datos guardados en localStorage\n    let datos_guardados = localStorage.getItem(llave_storage);\n    let umbrales_mostrados_hoy = {};\n\n    if (datos_guardados) {\n        try {\n            let datos = JSON.parse(datos_guardados);\n            // Si la fecha guardada es de hoy, usar los umbrales guardados\n            if (datos.fecha === fecha_hoy) {\n                umbrales_mostrados_hoy = datos.umbrales || {};\n            }\n            // Si es de otro día, se resetean los umbrales (objeto vacío)\n        } catch (e) {\n            // Si hay error al parsear, se resetea\n            umbrales_mostrados_hoy = {};\n        }\n    }\n\n    // Verificar si ya se mostró el modal para este umbral hoy\n    if (umbrales_mostrados_hoy[umbral_actual]) {\n        return;\n    }\n\n    // Marcar este umbral como mostrado hoy\n    umbrales_mostrados_hoy[umbral_actual] = true;\n\n    // Guardar en localStorage\n    localStorage.setItem(llave_storage, JSON.stringify({\n        fecha: fecha_hoy,\n        umbrales: umbrales_mostrados_hoy\n    }));\n\n    // Mostrar el modal\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}\n\n/**\n * Mostrar el modal de advertencia de créditos disponibles.\n *\n * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {\n    let mensaje_descripcion = umbral === 0\n        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'\n        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;\n\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>\n                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.close();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Solicitar más créditos',\n                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`\n                    })}\n                </div>\n            </div>\n        `,\n    });\n}\n\n/**\n * Solicitar más créditos desde el modal de advertencia.\n * Contacta al ejecutivo de la empresa via WhatsApp.\n *\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction solicitarMasCreditosDesdeModal(empresa_id) {\n    $.ajax({\n        url: `/empresas/${empresa_id}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            Swal.close();\n        },\n        error: function() {\n            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');\n            Swal.close();\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**\n * Muestra Modal para informar que no cuenta con la funcionalidad\n *.\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction modalFuncionalidadInactiva() {\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Adquiere esta funcionalidad</div>\n                <div class=\"col-12 mt-5 text-start text-body-2 fw-normal\">No tienes esta funcionalidad activa. Por favor, contacta a tu asesor.</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.clickDeny();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Entiendo',\n                        onclick: `Swal.clickConfirm();`\n                    })}\n                </div>\n            </div>\n        `,\n    }).then(async (resultado) => {\n        //\n    });\n}\n\n/**\n * Busca una funcionalidad por su llave.\n *\n * @param {string} llave Llave de la funcionalidad a buscar.\n * @param {Array|null} funcionalidades funcionalidades.\n * @returns {boolean}\n * @author Andres Gonzalez\n */\nfunction buscarFuncionalidad(llave, funcionalidades = null) {\n    let datos = funcionalidades ?? funcionalidades_disponibles_empresa;\n\n    if (!Array.isArray(datos) || datos.length === 0) {\n        return false;\n    }\n\n    return datos.some(item => item?.funcionalidad?.llave === llave);\n}\n","structuredPatch":[{"oldStart":184,"oldLines":7,"newStart":184,"newLines":9,"lines":[" ","     // Cargar créditos disponibles si existe el contenedor y el ID de empresa","     if ($('#contenedor-tag-creditos').length && $('#empresa_sesion_id').length) {","-        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val());","+        // Verificar si estamos en la ruta /procesos para mostrar el modal de advertencia","+        let verificar_modal = window.location.pathname === '/procesos';","+        obtenerCreditosDisponiblesEmpresa($('#empresa_sesion_id').val(), 'contenedor-tag-creditos', verificar_modal);","     }"," });"," "]}],"userModified":false,"replaceAll":false},"sourceToolAssistantUUID":"75e4797d-cd39-4a38-b5af-b46932cbc929"}
{"parentUuid":"db1e25c9-6354-4817-bbd0-c57469e71f5d","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_019viQHyPBfhwQhkY2eMLS3t","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Ahora la implementación está completa. Voy a revisar el código que agregué para asegurarme de que todo esté correcto y resumir lo que hice para el usuario.\n\nResumen de cambios:\n1. Agregué la constante `UMBRALES_ADVERTENCIA_CREDITOS` con los valores [20, 10, 5, 0]\n2. Modifiqué la función `obtenerCreditosDisponiblesEmpresa()` para aceptar un parámetro `verificar_modal`\n3. Creé la función `verificarYMostrarModalAdvertenciaCreditosDisponibles()` que:\n   - Determina el umbral actual alcanzado\n   - Usa localStorage con fecha para mostrar el modal solo 1 vez por día por umbral\n   - Si baja a un umbral más bajo, muestra el nuevo modal ese mismo día\n4. Creé la función `mostrarModalAdvertenciaCreditosDisponibles()` que muestra el modal con Swal.fire según el diseño de Figma\n5. Creé la función `solicitarMasCreditosDesdeModal()` que contacta al ejecutivo vía WhatsApp\n6. Modifiqué el `$(document).ready()` para detectar si estamos en `/procesos` y activar la verificación del modal\n\nTodo está listo. Voy a leer el código final para verificar que todo esté bien.","signature":"EuMJCkYICxgCKkC8yFueU84zcUyg5FtA7FUuPki8F5K8yYIsuuFxcqX7Ojx22FaQ36wvKxiM893zTFSwgxEictagjtTzW48kpWvoEgwzbeC3T/5RePbi8N0aDA/d3nxwvKMwgR9WzCIwZuQCUZijDVTozK1rjhZX5V/UpfokW2XKE34PIurbt25WjCprYc4StE+/gpavhtJHKsoIZ9WgdE29VWWGh6N5c4FCDRjUfajd4RII39Yqjq48wpwsGDI4mVKwVJMVved7OIPAJy/gz3hWNx2iVf2iN9xVRl7tC5GouqwpAxX/2Sj0TFt8w9zhli3RlhzQVx7TS8kU/6wL8/tTTo8Ik3G+vhDLreQRabMLMDSX2CAT4tM9V2a8YUoz0TW/1Fi5PVz7QOq936Cx3bwz8xtL+jlOVkHXnlmlpgzr/I7+OzfOfensvHojpG+OpisK9KJY56p9LXW58jSrm4iwkNUTX22Bg1ceCcgllbt1a3/nqKMpOCBaXQazUVf3aDJ76R2cAM/1k+ulCbsclf/iiYfEe1+a4S0HDpADbJp8fpdxZH2OW2pUGRnMlUtsA7UULoQV5xM5wSI5/SQMmbfQUouGACJEGYx0yOzZCFaHbQpAiG1kfaHNqXVqbxpn1+5PHsnClwz8mNCJiudDoxgFUXdXEI7X11BkyMMHmXtVK6B+TWJz5bsT06zoMH2nQ32iyJgOhEZauUt4UiBe2tLygsJOXvI0s70Ovo11rguAYGK8CCUFxWzAvoE6tUgzKczeijNyHMUL1D3hwTfQmjHTkC1ORevrYz2W5r9Zgbi9gTj6Sh0vDrb99wrNWTWJb89uKnz7sL8j1MiOjvV87Scw4NewDpM7vfCQvKV7XyesVVWkT1XWtiekLsTrFr8P5rZH4WinXK+gngmvMzxOoFKaQfooeMoYjvxi4+OSDfSavlhsjBQ2+oVbrJGdLWsN1i+Wkg0BFmKayseGHjdfLi+VbRhLwIFaJu4XsRDq3ex8x52F7Nlawb9UUdGT3Z1ANIXbl0xy0/Eo7i94zdyEtmA9lsWUeM/CqBmLD58o3bBCEmEoGrrYFLdraR+REpxs42YU+1ar98bFYcaDhSHmgKZDwz/LyperkrpRigToeLAAz2BWMfk3ecOvJc5oToF+YcmuMo7EplMjfnan3izB7e9XQWuxKcViOxlMjeYl3bbuD1ebBOyXqBy+uStvB/K5rHd8MCtakqcDc/+i/0Z/CiBabbAioyAKOl//Fg4z2zQq6GgDjOMEHZ0YntJwKaymzLox5C2vSWBbTktSeDB74C+P/SWED0gOsQtng/DdbdBpZ211QqghAxWhyh7TE7z9wNSQVkb5RAAzYFUCUVLMsMkgMhMO0DhekFV/9JD0olCrkE06wbUGnsYMZ4AqIqoIQl879Wgg7ibu/YVz9tsADFQC1e74G/LDSU8w49Yj13IG0lp5YYsHFVkbRd35bs72AmfkwvlYFcMbZ1ilqKHEQVPU/aSyfVUzvVOXe5SKvsqXwtUmsaWjt1ftIL9C3KG+s8idzgFWHileGcFuIw5XpzcA3dTONTe5vIyOBDiXQQWTHO68jLKVWW4JKUEfel0wyE4E769k3Ne1HWcyuOJzN8HcaBnHODqaCiIN31RioG1nm7Gi9jois1S7uubSnR7/DcR2GSmuGAE="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":529,"cache_read_input_tokens":89393,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":529},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpyToaLQq1rV6C2UVor","type":"assistant","uuid":"52351145-0820-4494-918c-efd955b6521e","timestamp":"2026-01-29T14:29:10.189Z"}
{"parentUuid":"52351145-0820-4494-918c-efd955b6521e","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_019viQHyPBfhwQhkY2eMLS3t","type":"message","role":"assistant","content":[{"type":"text","text":"Ahora voy a verificar que todo el código esté correcto leyendo las funciones que agregué."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":529,"cache_read_input_tokens":89393,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":529},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpyToaLQq1rV6C2UVor","type":"assistant","uuid":"74e7632e-a3bb-4f89-8aea-6058c4dd8101","timestamp":"2026-01-29T14:29:10.767Z"}
{"parentUuid":"74e7632e-a3bb-4f89-8aea-6058c4dd8101","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_019viQHyPBfhwQhkY2eMLS3t","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_01C5kLfhK3XhpeG7Foz6QsDY","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","offset":1465,"limit":120}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":529,"cache_read_input_tokens":89393,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":529},"output_tokens":4,"service_tier":"standard"}},"requestId":"req_011CXbpyToaLQq1rV6C2UVor","type":"assistant","uuid":"8d23a56b-0f3d-4a22-acb6-b1cc8e654fc3","timestamp":"2026-01-29T14:29:11.441Z"}
{"parentUuid":"8d23a56b-0f3d-4a22-acb6-b1cc8e654fc3","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_01C5kLfhK3XhpeG7Foz6QsDY","type":"tool_result","content":"  1465→                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);\n  1466→                }\n  1467→            } else {\n  1468→                $(`#${contenedor_id}`).html(crearTag({\n  1469→                    texto: 'No tienes plan de créditos',\n  1470→                    class: 'tag-tonal-gray'\n  1471→                }));\n  1472→            }\n  1473→\n  1474→            inicializarTooltips();\n  1475→        },\n  1476→        error: function () {\n  1477→            $(`#${contenedor_id}`).html(crearTag({\n  1478→                texto: 'Error al cargar créditos',\n  1479→                class: 'tag-tonal-gray'\n  1480→            }));\n  1481→        }\n  1482→    });\n  1483→}\n  1484→\n  1485→/**\n  1486→ * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n  1487→ * Los umbrales son: 20%, 10%, 5% y 0%.\n  1488→ * El modal solo se muestra una vez por día para cada umbral alcanzado.\n  1489→ * Si baja a un umbral más bajo, se muestra ese nuevo umbral aunque ya se haya mostrado otro ese día.\n  1490→ *\n  1491→ * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n  1492→ * @param {number} empresa_id ID de la empresa\n  1493→ * @returns {void}\n  1494→ * @author Sergio Vargas\n  1495→ */\n  1496→function verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n  1497→    // Determinar el umbral actual alcanzado (el más bajo que aplica)\n  1498→    let umbral_actual = null;\n  1499→\n  1500→    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n  1501→        if (porcentaje_disponible <= umbral) {\n  1502→            umbral_actual = umbral;\n  1503→        } else {\n  1504→            break;\n  1505→        }\n  1506→    }\n  1507→\n  1508→    // Si no se alcanzó ningún umbral, no mostrar el modal\n  1509→    if (umbral_actual === null) {\n  1510→        return;\n  1511→    }\n  1512→\n  1513→    // Obtener la fecha actual en formato YYYY-MM-DD\n  1514→    let fecha_hoy = new Date().toISOString().split('T')[0];\n  1515→    let llave_storage = `modal_creditos_${empresa_id}`;\n  1516→\n  1517→    // Obtener los datos guardados en localStorage\n  1518→    let datos_guardados = localStorage.getItem(llave_storage);\n  1519→    let umbrales_mostrados_hoy = {};\n  1520→\n  1521→    if (datos_guardados) {\n  1522→        try {\n  1523→            let datos = JSON.parse(datos_guardados);\n  1524→            // Si la fecha guardada es de hoy, usar los umbrales guardados\n  1525→            if (datos.fecha === fecha_hoy) {\n  1526→                umbrales_mostrados_hoy = datos.umbrales || {};\n  1527→            }\n  1528→            // Si es de otro día, se resetean los umbrales (objeto vacío)\n  1529→        } catch (e) {\n  1530→            // Si hay error al parsear, se resetea\n  1531→            umbrales_mostrados_hoy = {};\n  1532→        }\n  1533→    }\n  1534→\n  1535→    // Verificar si ya se mostró el modal para este umbral hoy\n  1536→    if (umbrales_mostrados_hoy[umbral_actual]) {\n  1537→        return;\n  1538→    }\n  1539→\n  1540→    // Marcar este umbral como mostrado hoy\n  1541→    umbrales_mostrados_hoy[umbral_actual] = true;\n  1542→\n  1543→    // Guardar en localStorage\n  1544→    localStorage.setItem(llave_storage, JSON.stringify({\n  1545→        fecha: fecha_hoy,\n  1546→        umbrales: umbrales_mostrados_hoy\n  1547→    }));\n  1548→\n  1549→    // Mostrar el modal\n  1550→    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n  1551→}\n  1552→\n  1553→/**\n  1554→ * Mostrar el modal de advertencia de créditos disponibles.\n  1555→ *\n  1556→ * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)\n  1557→ * @param {number} empresa_id ID de la empresa\n  1558→ * @returns {void}\n  1559→ * @author Sergio Vargas\n  1560→ */\n  1561→function mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {\n  1562→    let mensaje_descripcion = umbral === 0\n  1563→        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'\n  1564→        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;\n  1565→\n  1566→    Swal.fire({\n  1567→        showCloseButton: true,\n  1568→        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n  1569→        showConfirmButton: false,\n  1570→        showDenyButton: false,\n  1571→        showCancelButton: false,\n  1572→        html: `\n  1573→            <div class=\"row w-100 mx-0 mt-2\">\n  1574→                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>\n  1575→                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>\n  1576→                <div class=\"col-6 mt-5 mb-2\">\n  1577→                    ${crearBoton({\n  1578→                        clases: 'btn-outline-primary w-100 justify-content-center',\n  1579→                        texto: 'Cancelar',\n  1580→                        onclick: `Swal.close();`\n  1581→                    })}\n  1582→                </div>\n  1583→                <div class=\"col-6 mt-5 mb-2\">\n  1584→                    ${crearBoton({\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"d38990c9-0982-4d0f-abb1-e5dd7d27dcdb","timestamp":"2026-01-29T14:29:12.454Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","content":"                    verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id);\n                }\n            } else {\n                $(`#${contenedor_id}`).html(crearTag({\n                    texto: 'No tienes plan de créditos',\n                    class: 'tag-tonal-gray'\n                }));\n            }\n\n            inicializarTooltips();\n        },\n        error: function () {\n            $(`#${contenedor_id}`).html(crearTag({\n                texto: 'Error al cargar créditos',\n                class: 'tag-tonal-gray'\n            }));\n        }\n    });\n}\n\n/**\n * Verificar si se debe mostrar el modal de advertencia de créditos disponibles.\n * Los umbrales son: 20%, 10%, 5% y 0%.\n * El modal solo se muestra una vez por día para cada umbral alcanzado.\n * Si baja a un umbral más bajo, se muestra ese nuevo umbral aunque ya se haya mostrado otro ese día.\n *\n * @param {number} porcentaje_disponible Porcentaje de créditos disponibles\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction verificarYMostrarModalAdvertenciaCreditosDisponibles(porcentaje_disponible, empresa_id) {\n    // Determinar el umbral actual alcanzado (el más bajo que aplica)\n    let umbral_actual = null;\n\n    for (let umbral of UMBRALES_ADVERTENCIA_CREDITOS) {\n        if (porcentaje_disponible <= umbral) {\n            umbral_actual = umbral;\n        } else {\n            break;\n        }\n    }\n\n    // Si no se alcanzó ningún umbral, no mostrar el modal\n    if (umbral_actual === null) {\n        return;\n    }\n\n    // Obtener la fecha actual en formato YYYY-MM-DD\n    let fecha_hoy = new Date().toISOString().split('T')[0];\n    let llave_storage = `modal_creditos_${empresa_id}`;\n\n    // Obtener los datos guardados en localStorage\n    let datos_guardados = localStorage.getItem(llave_storage);\n    let umbrales_mostrados_hoy = {};\n\n    if (datos_guardados) {\n        try {\n            let datos = JSON.parse(datos_guardados);\n            // Si la fecha guardada es de hoy, usar los umbrales guardados\n            if (datos.fecha === fecha_hoy) {\n                umbrales_mostrados_hoy = datos.umbrales || {};\n            }\n            // Si es de otro día, se resetean los umbrales (objeto vacío)\n        } catch (e) {\n            // Si hay error al parsear, se resetea\n            umbrales_mostrados_hoy = {};\n        }\n    }\n\n    // Verificar si ya se mostró el modal para este umbral hoy\n    if (umbrales_mostrados_hoy[umbral_actual]) {\n        return;\n    }\n\n    // Marcar este umbral como mostrado hoy\n    umbrales_mostrados_hoy[umbral_actual] = true;\n\n    // Guardar en localStorage\n    localStorage.setItem(llave_storage, JSON.stringify({\n        fecha: fecha_hoy,\n        umbrales: umbrales_mostrados_hoy\n    }));\n\n    // Mostrar el modal\n    mostrarModalAdvertenciaCreditosDisponibles(umbral_actual, empresa_id);\n}\n\n/**\n * Mostrar el modal de advertencia de créditos disponibles.\n *\n * @param {number} umbral Umbral de porcentaje alcanzado (20, 10, 5 o 0)\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction mostrarModalAdvertenciaCreditosDisponibles(umbral, empresa_id) {\n    let mensaje_descripcion = umbral === 0\n        ? 'Tu saldo de créditos se ha agotado. Solicita más créditos ahora para evitar interrupciones en tus acciones.'\n        : `Tu saldo está por debajo del ${umbral}% de créditos disponibles. Solicita más créditos ahora para evitar interrupciones en tus acciones.`;\n\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,\n        showCancelButton: false,\n        html: `\n            <div class=\"row w-100 mx-0 mt-2\">\n                <div class=\"col-12 fw-semibold text-start text-gray-10 text-headline-4\">Solicita más créditos</div>\n                <div class=\"col-12 mt-4 text-start text-body-2 fw-normal text-gray-30\">${mensaje_descripcion}</div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-outline-primary w-100 justify-content-center',\n                        texto: 'Cancelar',\n                        onclick: `Swal.close();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({","numLines":120,"startLine":1465,"totalLines":1703}},"sourceToolAssistantUUID":"8d23a56b-0f3d-4a22-acb6-b1cc8e654fc3"}
{"parentUuid":"d38990c9-0982-4d0f-abb1-e5dd7d27dcdb","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_01C5kLfhK3XhpeG7Foz6QsDY","toolUseID":"toolu_01C5kLfhK3XhpeG7Foz6QsDY","timestamp":"2026-01-29T14:29:12.455Z","uuid":"b54e26cb-8493-4fa6-89c0-71a6148e0b1c"}
{"parentUuid":"b54e26cb-8493-4fa6-89c0-71a6148e0b1c","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012xqKYqn3xtf69aGaqcKruj","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"Veo que el código está bien. Quiero ver la parte final del archivo para verificar que está completa la función `solicitarMasCreditosDesdeModal`.","signature":"Er0CCkYICxgCKkCZArUAwrDepvDgHXS62uzDNWcPAf5Qiwjuh1E5G6IChsYuqm7bvEZuV0I+3pe2Q6RuCs4M47r84oZaroMO3IxxEgzQnDPAmuFhj8reT9gaDIcFmVqtWDqe49vnnCIwqudiR/DoKWSZ9ZdtQp6qX8EV/aXhBgzjft6uC1eWbpkJR+swMnGTLNnhBUEZEGmpKqQB1PIhqrmc1TT62CfmEAny8cq7AzvtKex/n89w+OEs6xPYbFo+F7LxRxxAfJUJKNgLk6iOKbN63xsuA2dlNy55MT3rX3fRLaeemB7XeMG7pyODzoprQIwHmXeRQqR3ZOnWcV7EEcNTAO6TkygUnkLiG8amGGIjqz+0AFNyFJAM5JjmNbpbdGLc37ztorm94qxXEtOju45/O8v6ftYXdBa/GlC7YLUYAQ=="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":2490,"cache_read_input_tokens":89922,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2490},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpz9ggz9Zp3AXWb16tR","type":"assistant","uuid":"47477c46-1a53-4804-9ed7-d42bcaf32377","timestamp":"2026-01-29T14:29:16.097Z"}
{"parentUuid":"47477c46-1a53-4804-9ed7-d42bcaf32377","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_012xqKYqn3xtf69aGaqcKruj","type":"message","role":"assistant","content":[{"type":"tool_use","id":"toolu_018qCuEXo7nfYkPBMPah337T","name":"Read","input":{"file_path":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","offset":1580,"limit":80}}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":2490,"cache_read_input_tokens":89922,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":2490},"output_tokens":2,"service_tier":"standard"}},"requestId":"req_011CXbpz9ggz9Zp3AXWb16tR","type":"assistant","uuid":"849c08cd-e19a-4a10-88d6-54f19019bbd4","timestamp":"2026-01-29T14:29:16.780Z"}
{"parentUuid":"849c08cd-e19a-4a10-88d6-54f19019bbd4","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":[{"tool_use_id":"toolu_018qCuEXo7nfYkPBMPah337T","type":"tool_result","content":"  1580→                        onclick: `Swal.close();`\n  1581→                    })}\n  1582→                </div>\n  1583→                <div class=\"col-6 mt-5 mb-2\">\n  1584→                    ${crearBoton({\n  1585→                        clases: 'btn-primary w-100 justify-content-center',\n  1586→                        texto: 'Solicitar más créditos',\n  1587→                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`\n  1588→                    })}\n  1589→                </div>\n  1590→            </div>\n  1591→        `,\n  1592→    });\n  1593→}\n  1594→\n  1595→/**\n  1596→ * Solicitar más créditos desde el modal de advertencia.\n  1597→ * Contacta al ejecutivo de la empresa via WhatsApp.\n  1598→ *\n  1599→ * @param {number} empresa_id ID de la empresa\n  1600→ * @returns {void}\n  1601→ * @author Sergio Vargas\n  1602→ */\n  1603→function solicitarMasCreditosDesdeModal(empresa_id) {\n  1604→    $.ajax({\n  1605→        url: `/empresas/${empresa_id}`,\n  1606→        method: 'GET',\n  1607→        dataType: 'json',\n  1608→        success: function(respuesta) {\n  1609→            if (respuesta?.data?.ejecutivo?.telefono) {\n  1610→                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n  1611→            } else {\n  1612→                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n  1613→            }\n  1614→            Swal.close();\n  1615→        },\n  1616→        error: function() {\n  1617→            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');\n  1618→            Swal.close();\n  1619→        }\n  1620→    });\n  1621→}\n  1622→\n  1623→/**\n  1624→ * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n  1625→ *\n  1626→ * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n  1627→ * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n  1628→ * @author Andres Gonzalez\n  1629→ */\n  1630→function obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n  1631→    let parametros = {};\n  1632→\n  1633→    if (tipo_prueba_id !== null) {\n  1634→        parametros.tipo_prueba_id = tipo_prueba_id;\n  1635→    }\n  1636→\n  1637→    return $.ajax({\n  1638→        url: '/funcionalidades-activas-plan',\n  1639→        method: 'GET',\n  1640→        dataType: 'json',\n  1641→        data: parametros,\n  1642→        success: function(respuesta) {\n  1643→            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n  1644→        }\n  1645→    });\n  1646→}\n  1647→\n  1648→/**\n  1649→ * Muestra Modal para informar que no cuenta con la funcionalidad\n  1650→ *.\n  1651→ * @returns {void}\n  1652→ * @author Andres Gonzalez\n  1653→ */\n  1654→function modalFuncionalidadInactiva() {\n  1655→    Swal.fire({\n  1656→        showCloseButton: true,\n  1657→        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n  1658→        showConfirmButton: false,\n  1659→        showDenyButton: false,\n\n<system-reminder>\nWhenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.\n</system-reminder>\n"}]},"uuid":"bc11682f-ba3d-4de8-ae5f-ec909f351c7f","timestamp":"2026-01-29T14:29:17.897Z","toolUseResult":{"type":"text","file":{"filePath":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2\\public\\js\\globales.js","content":"                        onclick: `Swal.close();`\n                    })}\n                </div>\n                <div class=\"col-6 mt-5 mb-2\">\n                    ${crearBoton({\n                        clases: 'btn-primary w-100 justify-content-center',\n                        texto: 'Solicitar más créditos',\n                        onclick: `solicitarMasCreditosDesdeModal(${empresa_id});`\n                    })}\n                </div>\n            </div>\n        `,\n    });\n}\n\n/**\n * Solicitar más créditos desde el modal de advertencia.\n * Contacta al ejecutivo de la empresa via WhatsApp.\n *\n * @param {number} empresa_id ID de la empresa\n * @returns {void}\n * @author Sergio Vargas\n */\nfunction solicitarMasCreditosDesdeModal(empresa_id) {\n    $.ajax({\n        url: `/empresas/${empresa_id}`,\n        method: 'GET',\n        dataType: 'json',\n        success: function(respuesta) {\n            if (respuesta?.data?.ejecutivo?.telefono) {\n                window.open(`https://wa.me/${respuesta.data.ejecutivo.telefono.replace(/\\D/g, '')}?text=Hola,%20me%20gustar%C3%ADa%20solicitar%20cr%C3%A9ditos%20adicionales%20para%20mi%20empresa.`, '_blank');\n            } else {\n                mostrarToast('danger', 'No se encontró un ejecutivo asignado a la empresa. Por favor, comunícate con soporte para recargar créditos.');\n            }\n            Swal.close();\n        },\n        error: function() {\n            mostrarToast('danger', 'Ocurrió un error al obtener la información del ejecutivo.');\n            Swal.close();\n        }\n    });\n}\n\n/**\n * Obtiene las funcionalidades activas del plan vigente de la empresa del usuario actual.\n *\n * @param {number|null} tipo_prueba_id ID del tipo de prueba (opcional).\n * @returns {Promise} Promesa que se resuelve con las funcionalidades activas.\n * @author Andres Gonzalez\n */\nfunction obtenerFuncionalidadesActivasPlan(tipo_prueba_id = null) {\n    let parametros = {};\n\n    if (tipo_prueba_id !== null) {\n        parametros.tipo_prueba_id = tipo_prueba_id;\n    }\n\n    return $.ajax({\n        url: '/funcionalidades-activas-plan',\n        method: 'GET',\n        dataType: 'json',\n        data: parametros,\n        success: function(respuesta) {\n            funcionalidades_disponibles_empresa = respuesta?.data ?? [];\n        }\n    });\n}\n\n/**\n * Muestra Modal para informar que no cuenta con la funcionalidad\n *.\n * @returns {void}\n * @author Andres Gonzalez\n */\nfunction modalFuncionalidadInactiva() {\n    Swal.fire({\n        showCloseButton: true,\n        closeButtonHtml: '<i class=\"bi bi-x text-headline-4 text-gray-20\"></i>',\n        showConfirmButton: false,\n        showDenyButton: false,","numLines":80,"startLine":1580,"totalLines":1703}},"sourceToolAssistantUUID":"849c08cd-e19a-4a10-88d6-54f19019bbd4"}
{"parentUuid":"bc11682f-ba3d-4de8-ae5f-ec909f351c7f","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"progress","data":{"type":"hook_progress","hookEvent":"PostToolUse","hookName":"PostToolUse:Read","command":"callback"},"parentToolUseID":"toolu_018qCuEXo7nfYkPBMPah337T","toolUseID":"toolu_018qCuEXo7nfYkPBMPah337T","timestamp":"2026-01-29T14:29:17.901Z","uuid":"6422ccad-f23c-4126-b310-31a5143c4d6d"}
{"parentUuid":"6422ccad-f23c-4126-b310-31a5143c4d6d","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01BWrLm39GH4y92aQ9FKKWuk","type":"message","role":"assistant","content":[{"type":"thinking","thinking":"El código está completo y correcto. Ahora voy a resumir lo que hice para el usuario.","signature":"Ev4BCkYICxgCKkCI2fRCZqG3t7IkwrWzLsGHtmaor4X1DQej/T1pRrQyutTU+67Ujcs9Nkzk0OYsnA4iZtwOlHpKx9IqkRPjE/bfEgwmqhtehfZmEx1HSRYaDFyoRD1qqxLBhkUMSSIw/fnvShkGX2MP60AhNZTdfqfgR4fB2QjKCxd4Iik9Qlsk30Cml7sWIDLXPcBXG4AsKmYKpbe/exdsOFApoOAWOfivjoD0m5ZZenCkJRDS+VOnzkp/J16wzSYcQ0/AUQelvCXzKV9J99+ZH5YwGq3foKfMlkZa96tIhODsZn0cKxigDUe40H3ui8kBIfr6w2jCmMxTgMGsr9wYAQ=="}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1432,"cache_read_input_tokens":92412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1432},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXbpzZUB5qShKwCgShJXE","type":"assistant","uuid":"ba7ae613-db8a-4fca-abee-d66f36e76ed3","timestamp":"2026-01-29T14:29:21.110Z"}
{"parentUuid":"ba7ae613-db8a-4fca-abee-d66f36e76ed3","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","message":{"model":"claude-opus-4-5-20251101","id":"msg_01BWrLm39GH4y92aQ9FKKWuk","type":"message","role":"assistant","content":[{"type":"text","text":"La implementación está completa. Aquí está el resumen de los cambios realizados en `public/js/globales.js`:\n\n## Cambios realizados\n\n1. **Nueva constante** `UMBRALES_ADVERTENCIA_CREDITOS = [20, 10, 5, 0]` - Define los umbrales en los que se mostrará el modal.\n\n2. **Modificación de** `obtenerCreditosDisponiblesEmpresa()` - Ahora acepta un tercer parámetro `verificar_modal` que activa la verificación del modal de advertencia.\n\n3. **Nueva función** `verificarYMostrarModalAdvertenciaCreditosDisponibles()`:\n   - Determina el umbral actual alcanzado (el más bajo que aplica)\n   - Usa `localStorage` con fecha para mostrar el modal solo 1 vez por día por umbral\n   - Si baja a un umbral más bajo, muestra el nuevo modal ese mismo día\n   - Estructura de localStorage: `{ fecha: \"YYYY-MM-DD\", umbrales: { 20: true, 10: true, ... } }`\n\n4. **Nueva función** `mostrarModalAdvertenciaCreditosDisponibles()`:\n   - Muestra el modal con SweetAlert2 siguiendo el diseño de Figma\n   - Título: \"Solicita más créditos\"\n   - Descripción dinámica según el umbral\n   - Botones: \"Cancelar\" y \"Solicitar más créditos\"\n\n5. **Nueva función** `solicitarMasCreditosDesdeModal()`:\n   - Contacta al ejecutivo de la empresa vía WhatsApp\n\n6. **Modificación del** `$(document).ready()` - Detecta si estamos en `/procesos` y activa la verificación del modal automáticamente.\n\n## Comportamiento\n- Al ingresar a `/procesos`, si los créditos están en 20%, 10%, 5% o 0%, se muestra el modal **una vez por día** para ese umbral.\n- Si durante el día baja a un umbral más bajo (ej: de 20% a 10%), se muestra el nuevo modal aunque ya se haya mostrado otro umbral ese día.\n- Al día siguiente, todos los umbrales se resetean."}],"stop_reason":null,"stop_sequence":null,"usage":{"input_tokens":8,"cache_creation_input_tokens":1432,"cache_read_input_tokens":92412,"cache_creation":{"ephemeral_5m_input_tokens":0,"ephemeral_1h_input_tokens":1432},"output_tokens":1,"service_tier":"standard"}},"requestId":"req_011CXbpzZUB5qShKwCgShJXE","type":"assistant","uuid":"bc9f5fda-43ae-4cec-acbe-ecab251cbe9c","timestamp":"2026-01-29T14:29:27.363Z"}
{"parentUuid":"bc9f5fda-43ae-4cec-acbe-ecab251cbe9c","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"pre-main","slug":"kind-jumping-panda","type":"system","subtype":"turn_duration","durationMs":171643,"timestamp":"2026-01-29T14:29:27.448Z","uuid":"275055b7-50e1-4f71-a954-1222799750da","isMeta":false}
{"type":"file-history-snapshot","messageId":"dde10305-6af9-416b-b273-6cdb5b3f9327","snapshot":{"messageId":"dde10305-6af9-416b-b273-6cdb5b3f9327","trackedFileBackups":{"public\\js\\globales.js":{"backupFileName":"f7aa1ebeb3700bae@v2","version":2,"backupTime":"2026-01-29T16:14:59.297Z"}},"timestamp":"2026-01-29T16:14:59.254Z"},"isSnapshotUpdate":false}
{"parentUuid":"275055b7-50e1-4f71-a954-1222799750da","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":"<local-command-caveat>Caveat: The messages below were generated by the user while running local commands. DO NOT respond to these messages or otherwise consider them in your response unless the user explicitly asks you to.</local-command-caveat>"},"isMeta":true,"uuid":"2c51868f-241d-4230-92dd-cf5c9122a7a2","timestamp":"2026-01-29T16:14:59.254Z"}
{"parentUuid":"2c51868f-241d-4230-92dd-cf5c9122a7a2","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":"<command-name>/context</command-name>\n            <command-message>context</command-message>\n            <command-args></command-args>"},"uuid":"dde10305-6af9-416b-b273-6cdb5b3f9327","timestamp":"2026-01-29T16:14:59.253Z"}
{"parentUuid":"dde10305-6af9-416b-b273-6cdb5b3f9327","isSidechain":false,"userType":"external","cwd":"C:\\Users\\sergio\\proyectos\\Psicoalianza-2","sessionId":"c9beaf5a-a334-48b0-96a6-29b3a63f0d8b","version":"2.1.23","gitBranch":"main","slug":"kind-jumping-panda","type":"user","message":{"role":"user","content":"<local-command-stdout> Context Usage\n⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁   claude-opus-4-5-20251101 · 94k/200k tokens (47%)\n⛁ ⛁ ⛁ ⛀ ⛁ ⛁ ⛀ ⛁ ⛁ ⛁ \n⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁   Estimated usage by category\n⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁   ⛁ System prompt: 2.8k tokens (1.4%)\n⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛁ ⛶   ⛁ System tools: 18.3k tokens (9.1%)\n⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶   ⛁ MCP tools: 5.5k tokens (2.8%)\n⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶   ⛁ Custom agents: 1.2k tokens (0.6%)\n⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶ ⛶   ⛁ Memory files: 4.0k tokens (2.0%)\n⛶ ⛶ ⛶ ⛝ ⛝ ⛝ ⛝ ⛝ ⛝ ⛝   ⛁ Skills: 121 tokens (0.1%)\n⛝ ⛝ ⛝ ⛝ ⛝ ⛝ ⛝ ⛝ ⛝ ⛝   ⛁ Messages: 64.5k tokens (32.3%)\n                      ⛶ Free space: 71k (35.3%)\n                      ⛝ Autocompact buffer: 33.0k tokens (16.5%)\n\nMCP tools · /mcp\n└ mcp__figma__get_screenshot: 596 tokens\n└ mcp__figma__create_design_system_rules: 272 tokens\n└ mcp__figma__get_design_context: 682 tokens\n└ mcp__figma__get_metadata: 621 tokens\n└ mcp__figma__get_variable_defs: 582 tokens\n└ mcp__figma__get_figjam: 591 tokens\n└ mcp__figma__generate_diagram: 584 tokens\n└ mcp__figma__get_code_connect_map: 469 tokens\n└ mcp__figma__whoami: 100 tokens\n└ mcp__figma__add_code_connect_map: 750 tokens\n└ mcp__ide__getDiagnostics: 111 tokens\n└ mcp__ide__executeCode: 182 tokens\n\nCustom agents · /agents\n\nProject\n└ revisor-codigo-psicoalianza: 643 tokens\n└ architecture-validator: 356 tokens\n└ frontend-agent: 215 tokens\n\nMemory files · /memory\n└ CLAUDE.md: 4.0k tokens\n\nSkills · /skills\n\nProject\n└ skill-creator: 60 tokens</local-command-stdout>"},"uuid":"e4cf9a14-5977-437e-be56-26c03df71cc0","timestamp":"2026-01-29T16:14:59.253Z"}
{"type":"summary","summary":"Credit threshold modal alerts on /procesos route","leafUuid":"e4cf9a14-5977-437e-be56-26c03df71cc0"}
